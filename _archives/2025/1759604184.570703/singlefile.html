<html style><!--
 Page saved with SingleFile 
 url: https://static.parastorage.com/services/wix-thunderbolt/dist/custom-element-utils.inline.99b3e2dc.bundle.min.js.map 
 saved date: Sat Oct 04 2025 19:33:09 GMT+0000 (Coordinated Universal Time)
--><head><meta charset="utf-8"><meta name="color-scheme" content="light dark"><meta name="referrer" content="no-referrer"><link type="image/x-icon" rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEACABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD9jAAA+Y8AAPmQAAD/kAAA+JEAAPqRAAD8kQAA/pEAAPaSBQD7kwAA9ZMDAPuTAQD/kwAA7pIKAPqUAADpkwoA/5QAAPmVAQDgkhQA/5UAAOuUDADhkxMA95UFAP+WAADplBAA/5cAAP+YAAD/mQAA/pkBAP+ZAQD0lhAA/5oAAOuWFwD3mQwA/5sDAP+cBwCslTsA7JgeANGXKwD/nQgA3ZglAPOcGQD9nhAA/6APAMmcNgD/ohcA9KAjAP+jGQDOnjsA4Z08AOigNAD/pSAAxahbAICmhwC1q2sATKqhAFWjtgB7rJYA67NfAKiyhgBPqsEApLSJAOe2bADvumsA4bh5AO67bwCfupUA7r10AO++cwC1vJAA7793APC/dwB9u68A5MCIAHK7wACcwaIAn8ClACm95QC1w6sAK8LhAEbD2QDjxpoAbsfJAN3JogCAx8wAGMn1ABDK/ACuzr0At9C1ABjN+AAczfkAC83/ABvN+gDq0KoACc//AAvP/wAW0P4AFND/AA7R/wAK0v8AytS4ABXT/wAH1f8A9taxADfY/wDo2cMAO9n/AHDX9QBA2f8Ac9n1AETe/wA73/8A7d/IAGDi/wBv4v8A8eTRAHnk/wB+6v8Ad+3/APbs3QDP6+8AivH/ALHv/wCF9P8A8vDsAIr1/wD28eoA8vHuALT1/wD08/EAuPf/APf4+QDh+f8A+P7/APz//wD9//8A/v//AP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGyFDR0EpGRsZLkRGOhEbGxsIaYmJcAoaFnOJiVEFGxsbFzKDiYY+AD+HiX8lGhsbGxsCU4mJfjF3iYhJBhsbGxsbGih4iYmBiYl8IBobGxsbGx8DO4CFiYmJQAcbGxsbGxsZJlJxdHqEiWceGhsbGxsbElBvbGpobHKCXQwbGxsfCTdmYWBaVVxfXm40ExsbGSRbZWNNPFk4VmJjTxUbIg1UfXU1Sm12azlIeXs9CycwV1g2ASxLTEIUD0VkThgvKg4FEx8aDAwQGxsMBAkcMy0rIx0bGxsbGxsbGxsbGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="><link rel="canonical" href="https://static.parastorage.com/services/wix-thunderbolt/dist/custom-element-utils.inline.99b3e2dc.bundle.min.js.map"><meta http-equiv="content-security-policy" content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head><body><pre>{"version":3,"file":"custom-element-utils.inline.99b3e2dc.bundle.min.js","mappings":"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","sources":["webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/imageServiceConstants.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/utils.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/imageServiceUtils.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/imageServiceFeatureSupportObject.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/populateFeatureSupport.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/engines/attributes/backgroundAttributes.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/engines/attributes/imgAttributes.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/engines/attributes/SVGAttributes.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/imageTransformParts.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/imageTransformOptions.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/api/transform.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/browserFeatureSupport.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/engines/transforms.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/api/uri.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/imagePlaceholderUtils.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/api/max/api.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/api/srcset.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/engines/attributes.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/api/uri/index.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/sdk/api.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/sdk/index.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/helpers/responsiveImageUtils.js","webpack:///../../../node_modules/@wix/image-kit/dist/esm/api/max/index.js","webpack:///../../custom-elements-registry/src/dropdownWrapper.ts","webpack:///../../custom-elements-registry/src/wixLazyCustomElementRegistry.ts","webpack:///../../custom-elements-registry/src/lazyCustomElementWrapper.ts","webpack:///../../custom-elements/src/multiColumnLayouter/utils.ts","webpack:///../../custom-elements/src/multiColumnLayouter/multiColumnLayouter.ts","webpack:///../../custom-elements/src/multiColumnLayouter/initMultiColumnLayouter.ts","webpack:///../../custom-elements/src/utils/initResizeService.ts","webpack:///../../custom-elements/src/utils/utils.ts","webpack:///../../custom-elements/src/utils/imageUtils.ts","webpack:///../../custom-elements/src/utils/domUtils.ts","webpack:///../../custom-elements/src/wixBgImage/bgImageLayout.ts","webpack:///../../custom-elements/src/commons.ts","webpack:///../../custom-elements/src/wixElements/wixElement.ts","webpack:///../../custom-elements/src/wixElements/initWixElement.ts","webpack:///../../custom-elements/src/wixBgImage/initWixBgImageCustomElement.ts","webpack:///../../custom-elements/src/wixBgImage/wixBgImage.ts","webpack:///../../custom-elements/src/wixBgMedia/wixBgMedia.ts","webpack:///../../custom-elements/src/wixBgMedia/initWixBgMediaCustomElement.ts","webpack:///../../custom-elements/src/wixDropdownMenu/dropdownMenuLayout.ts","webpack:///../../custom-elements/src/wixDropdownMenu/initCustomElementsDropdownMenu.ts","webpack:///../../custom-elements/src/wixDropdownMenu/wixDropdownMenu.ts","webpack:///../../custom-elements/src/wixIframe/initIframeCustomElements.ts","webpack:///../../custom-elements/src/wixIframe/wixIframe.ts","webpack:///../../custom-elements/src/wixVideo/videoLayout.ts","webpack:///../../custom-elements/src/wixVideo/initWixVideoCustomElement.ts","webpack:///../../custom-elements/src/wixVideo/wixVideo.ts","webpack:///../../custom-elements-registry/src/wixCustomElementsRegistry.ts","webpack:///../../custom-elements-registry/src/index.ts","webpack:///../../custom-elements-registry/src/shims/native-shim.ts","webpack:///../../thunderbolt-custom-elements/src/index.ts","webpack:///./custom-elements/initCustomElementsWrapper.ts"],"sourcesContent":["/**\n * image service api version\n */\nconst API_VERSION = 'v1';\n/**\nthe maximum retina factor\n */\nconst MAX_DEVICE_PIXEL_RATIO = 2;\n/**\n site BG legacy max width x height\n */\nconst DSKTP_MAX_BG_SITE_LEGACY_WIDTH = 1920;\nconst DSKTP_MAX_BG_SITE_LEGACY_HEIGHT = 1920;\nconst MOBILE_MAX_BG_SITE_LEGACY_WIDTH = 1000;\nconst MOBILE_MAX_BG_SITE_LEGACY_HEIGHT = 1000;\n/**\n * Enum string values of requested image fitting types\n * Note: TILE_HORIZONTAL, TILE_VERTICAL, FIT_AND_TILE are supported for legacy purposes but are not exposed\n * in the documentation because they should not be exposed for new features\n */\nconst fittingTypes = {\n    SCALE_TO_FILL: 'fill',\n    SCALE_TO_FIT: 'fit',\n    STRETCH: 'stretch',\n    ORIGINAL_SIZE: 'original_size',\n    TILE: 'tile',\n    TILE_HORIZONTAL: 'tile_horizontal',\n    TILE_VERTICAL: 'tile_vertical',\n    FIT_AND_TILE: 'fit_and_tile',\n    LEGACY_STRIP_TILE: 'legacy_strip_tile',\n    LEGACY_STRIP_TILE_HORIZONTAL: 'legacy_strip_tile_horizontal',\n    LEGACY_STRIP_TILE_VERTICAL: 'legacy_strip_tile_vertical',\n    LEGACY_STRIP_SCALE_TO_FILL: 'legacy_strip_fill',\n    LEGACY_STRIP_SCALE_TO_FIT: 'legacy_strip_fit',\n    LEGACY_STRIP_FIT_AND_TILE: 'legacy_strip_fit_and_tile',\n    LEGACY_STRIP_ORIGINAL_SIZE: 'legacy_strip_original_size',\n    LEGACY_ORIGINAL_SIZE: 'actual_size',\n    LEGACY_FIT_WIDTH: 'fitWidth',\n    LEGACY_FIT_HEIGHT: 'fitHeight',\n    LEGACY_FULL: 'full',\n    LEGACY_BG_FIT_AND_TILE: 'legacy_tile',\n    LEGACY_BG_FIT_AND_TILE_HORIZONTAL: 'legacy_tile_horizontal',\n    LEGACY_BG_FIT_AND_TILE_VERTICAL: 'legacy_tile_vertical',\n    LEGACY_BG_NORMAL: 'legacy_normal',\n};\n/**\n * Enum string values of image transform types as passed to the image service api\n */\nconst transformTypes = {\n    FIT: 'fit',\n    FILL: 'fill',\n    FILL_FOCAL: 'fill_focal',\n    CROP: 'crop',\n    LEGACY_CROP: 'legacy_crop',\n    LEGACY_FILL: 'legacy_fill',\n};\n/**\n * Enum string values of requested image align types\n * @type {{CENTER: string, RIGHT: string, LEFT: string, TOP: string, BOTTOM: string, TOP_RIGHT: string, TOP_LEFT: string, BOTTOM_RIGHT: string, BOTTOM_LEFT: string}}\n */\nconst alignTypes = {\n    CENTER: 'center',\n    TOP: 'top',\n    TOP_LEFT: 'top_left',\n    TOP_RIGHT: 'top_right',\n    BOTTOM: 'bottom',\n    BOTTOM_LEFT: 'bottom_left',\n    BOTTOM_RIGHT: 'bottom_right',\n    LEFT: 'left',\n    RIGHT: 'right',\n};\n/**\n * Enum 9Grid alignment to focal point\n */\nconst ALIGN_TYPE_TO_FOCAL_POINT = {\n    [alignTypes.CENTER]: { x: 0.5, y: 0.5 },\n    [alignTypes.TOP_LEFT]: { x: 0, y: 0 },\n    [alignTypes.TOP_RIGHT]: { x: 1.0, y: 0 },\n    [alignTypes.TOP]: { x: 0.5, y: 0 },\n    [alignTypes.BOTTOM_LEFT]: { x: 0, y: 1.0 },\n    [alignTypes.BOTTOM_RIGHT]: { x: 1.0, y: 1.0 },\n    [alignTypes.BOTTOM]: { x: 0.5, y: 1.0 },\n    [alignTypes.RIGHT]: { x: 1.0, y: 0.5 },\n    [alignTypes.LEFT]: { x: 0, y: 0.5 },\n};\n/**\n * Enum string values of image align types as passed to the image service\n */\nconst alignTypesMap = {\n    center: 'c',\n    top: 't',\n    top_left: 'tl',\n    top_right: 'tr',\n    bottom: 'b',\n    bottom_left: 'bl',\n    bottom_right: 'br',\n    left: 'l',\n    right: 'r',\n};\n/**\n * Enum string values of html tag used to construct the css or svg attributes\n *  @type {{BG: string, IMG: string, SVG: string}}\n */\nconst htmlTag = {\n    BG: 'bg',\n    IMG: 'img',\n    SVG: 'svg',\n};\n/**\n * Enum string values of upscale method\n *  @type {{DEFAULT: string, SUPER: string}}\n */\nconst upscaleMethods = {\n    AUTO: 'auto',\n    CLASSIC: 'classic',\n    SUPER: 'super',\n};\n/**\n *  api values of upscale method\n *  @type {{default: number, super: number}}\n */\nconst upscaleMethodsValues = {\n    classic: 1,\n    super: 2,\n};\n/**\n * default unsharp mask values\n *  @type {{radius: number, amount: number, threshold: number}}\n */\nconst defaultUSM = {\n    radius: '0.66',\n    amount: '1.00',\n    threshold: '0.01',\n};\n/**\n * default empty data\n */\nconst emptyData = {\n    uri: '',\n    css: {\n        img: {},\n        container: {},\n    },\n    attr: {\n        img: {},\n        container: {},\n    },\n    transformed: false,\n};\nconst MAX_TRANSFORMED_IMAGE_WIDTH = 5000;\nconst MAX_TRANSFORMED_IMAGE_HEIGHT = 5000;\nconst SAFE_TRANSFORMED_AREA = MAX_TRANSFORMED_IMAGE_WIDTH * MAX_TRANSFORMED_IMAGE_HEIGHT;\n/**\n * super res machine learning upscale factor models -\n * @type {number[]}\n */\nconst SUPER_UPSCALE_MODELS = [1.5, 2, 4];\n/**\n * image qualities\n */\nconst imageScaleDefaults = {\n    HIGH: {\n        size: 1400 * 1400,\n        quality: 90,\n        maxUpscale: 1,\n    },\n    MEDIUM: {\n        size: 600 * 600,\n        quality: 85,\n        maxUpscale: 1,\n    },\n    LOW: {\n        size: 400 * 400,\n        quality: 80,\n        maxUpscale: 1.2,\n    },\n    TINY: {\n        size: 0,\n        quality: 80,\n        maxUpscale: 1.4,\n    },\n};\n/**\n * image quality\n * @type {{HIGH: string, MEDIUM: string, LOW: string, TINY: string}}\n */\nconst imageQuality = {\n    HIGH: 'HIGH',\n    MEDIUM: 'MEDIUM',\n    LOW: 'LOW',\n    TINY: 'TINY',\n};\n/**\n * image filters\n * @type {{CONTRAST: string, BRIGHTNESS: string, SATURATION: string, HUE: string, BLUR: string}}\n */\nconst imageFilters = {\n    CONTRAST: 'contrast',\n    BRIGHTNESS: 'brightness',\n    SATURATION: 'saturation',\n    HUE: 'hue',\n    BLUR: 'blur',\n};\nconst fileType = {\n    JPG: 'jpg',\n    JPEG: 'jpeg',\n    JPE: 'jpe',\n    PNG: 'png',\n    WEBP: 'webp',\n    WIX_ICO_MP: 'wix_ico_mp',\n    WIX_MP: 'wix_mp',\n    GIF: 'gif',\n    SVG: 'svg',\n    AVIF: 'avif',\n    UNRECOGNIZED: 'unrecognized',\n};\nconst encodingTypes = {\n    AVIF: 'AVIF',\n    PAVIF: 'PAVIF',\n};\nconst supportedExtensions = [\n    fileType.JPG,\n    fileType.JPEG,\n    fileType.JPE,\n    fileType.PNG,\n    fileType.GIF,\n    fileType.WEBP,\n];\nexport { alignTypes, alignTypesMap, transformTypes, encodingTypes, fittingTypes, htmlTag, upscaleMethods, upscaleMethodsValues, defaultUSM, emptyData, imageQuality, imageFilters, imageScaleDefaults, fileType, supportedExtensions, DSKTP_MAX_BG_SITE_LEGACY_WIDTH, MOBILE_MAX_BG_SITE_LEGACY_WIDTH, DSKTP_MAX_BG_SITE_LEGACY_HEIGHT, MOBILE_MAX_BG_SITE_LEGACY_HEIGHT, SAFE_TRANSFORMED_AREA, SUPER_UPSCALE_MODELS, MAX_DEVICE_PIXEL_RATIO, ALIGN_TYPE_TO_FOCAL_POINT, API_VERSION, };\n//# sourceMappingURL=imageServiceConstants.js.map","/**\n * Simple templates.\n * Receives a string with es6 ${...} style template arguments and returns a transformed string.\n * @param string\n * @returns {Function}\n */\nfunction template(strings, ...keys) {\n    return function (...values) {\n        const dict = values[values.length - 1] || {};\n        const result = [strings[0]];\n        keys.forEach(function (key, i) {\n            const value = Number.isInteger(key) ? values[key] : dict[key];\n            result.push(value, strings[i + 1]);\n        });\n        return result.join('');\n    };\n}\n/**\n * Get the last element in an array\n * @param array\n * @returns {*}\n */\nfunction last(array) {\n    return array[array.length - 1];\n}\nexport { last, template };\n//# sourceMappingURL=utils.js.map","import { alignTypes, alignTypesMap, fileType, fittingTypes, imageQuality, imageScaleDefaults, transformTypes, upscaleMethods, upscaleMethodsValues, ALIGN_TYPE_TO_FOCAL_POINT, MAX_DEVICE_PIXEL_RATIO, SUPER_UPSCALE_MODELS, SAFE_TRANSFORMED_AREA, } from './imageServiceConstants';\nimport { last } from './utils';\nconst SUPPORTED_IMAGE_EXTENSIONS = [\n    fileType.PNG,\n    fileType.JPEG,\n    fileType.JPG,\n    fileType.JPE,\n    fileType.WIX_ICO_MP,\n    fileType.WIX_MP,\n    fileType.WEBP,\n    fileType.AVIF,\n];\nconst JPG_EXTENSIONS = [\n    fileType.JPEG,\n    fileType.JPG,\n    fileType.JPE,\n];\n/**\n * checks if image type is supported\n * @param {string}     uri      image source uri\n *\n * @returns {boolean}\n */\nfunction isImageTypeSupported(uri) {\n    return SUPPORTED_IMAGE_EXTENSIONS.includes(getFileExtension(uri));\n}\n/**\n * check request integrity\n * @param {FittingType}             fittingType         imageService.fittingTypes\n * @param {ImageTransformSource}    src\n * @param {ImageTransformTarget}    target\n *\n * @returns {boolean}\n */\nfunction isValidRequest(fittingType, src, target) {\n    return (target &amp;&amp;\n        src &amp;&amp;\n        !isUrlEmptyOrNone(src.id) &amp;&amp;\n        Object.values(fittingTypes).includes(fittingType));\n}\n/**\n * returns true unless image is animated webp and allowAnimatedTransform is false\n */\nfunction canTransformIfAnimatedImage(uri, hasAnimation, allowAnimatedTransform = false) {\n    const isAvifWebpFormat = isWEBP(uri) || isAVIF(uri);\n    return !(isAvifWebpFormat &amp;&amp; hasAnimation &amp;&amp; !allowAnimatedTransform);\n}\n/**\n * returns true if image is a gif and allowAnimatedTransform is true\n */\nfunction isTransformableGIF(uri, allowAnimatedTransform = false) {\n    return isGIF(uri) &amp;&amp; allowAnimatedTransform;\n}\n/**\n * check if image transform is supported for source image\n */\nfunction isImageTransformApplicable(uri, hasAnimation, allowAnimatedTransform) {\n    return (canTransformIfAnimatedImage(uri, hasAnimation, allowAnimatedTransform) &amp;&amp;\n        (isImageTypeSupported(uri) ||\n            isTransformableGIF(uri, allowAnimatedTransform)) &amp;&amp;\n        !isExternalUrl(uri));\n}\n/**\n * returns true if image is of JPG type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isJPG(uri) {\n    return JPG_EXTENSIONS.includes(getFileExtension(uri));\n}\n/**\n * returns true if image is of PNG type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isPNG(uri) {\n    return getFileExtension(uri) === fileType.PNG;\n}\n/**\n * returns true if image is of webP type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isWEBP(uri) {\n    return getFileExtension(uri) === fileType.WEBP;\n}\n/**\n * returns true if image is of GIF type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isGIF(uri) {\n    return getFileExtension(uri) === fileType.GIF;\n}\n/**\n * returns true if image is of webP type\n * @param {string}  uri\n *\n * @returns {boolean}\n */\nfunction isAVIF(uri) {\n    return getFileExtension(uri) === fileType.AVIF;\n}\n/**\n * returns true if the url starts with http, https, // or data\n * @param {string}  url\n *\n * @returns {boolean}\n */\nfunction isExternalUrl(url) {\n    return /(^https?)|(^data)|(^\\/\\/)/.test(url);\n}\n/**\n * returns true if the url empty or none string\n * @param {string}  url\n *\n * @returns {boolean}\n */\nfunction isUrlEmptyOrNone(url) {\n    return !url || !url.trim() || url.toLowerCase() === 'none';\n}\n/**\n * returns search bot true or false as indicated in options\n * @param {ImageTransformOptions}   options\n *\n * @returns {boolean}\n */\nfunction isSEOBot(options) {\n    return options?.isSEOBot ?? false;\n}\n// https://jira.wixpress.com/browse/WEED-12667\n// const illegalChars = ['/', '\\\\', '#', '^', '?', '{', '}', '&lt;', '&gt;', '|', '`', '', ':', '\"'].map(encodeURIComponent)\nconst ILLEGAL_CHARS = ['/', '\\\\', '?', '&lt;', '&gt;', '|', '', ':', '\"'].map(encodeURIComponent);\nconst URL_SAFE_ILLEGAL_CHARS = ['\\\\.', '\\\\*'];\nconst ILLEGAL_CHARS_REPLACEMENT = '_';\n/**\n * returns source image file name (no extension)\n * @param {string}     uri      image source uri\n * @param {string}     [name]   optional image source name\n *\n * @returns {string}\n */\nfunction getFileName(uri, name) {\n    const beforeLeadingSlashRegexp = /\\/(.*?)$/;\n    const fileExtensionRegexp = /\\.([^.]*)$/;\n    const illegalCharsRegex = new RegExp(`(${ILLEGAL_CHARS.concat(URL_SAFE_ILLEGAL_CHARS).join('|')})`, 'g');\n    // if name is a non empty string, remove only supported extension if exists and url encode the string\n    if (name &amp;&amp; name.length) {\n        let fileName = name;\n        const extension = name.match(fileExtensionRegexp);\n        if (extension &amp;&amp;\n            SUPPORTED_IMAGE_EXTENSIONS.includes(extension[1])) {\n            fileName = name.replace(fileExtensionRegexp, '');\n        }\n        return encodeURIComponent(fileName).replace(illegalCharsRegex, ILLEGAL_CHARS_REPLACEMENT);\n    }\n    // else, trim any preceding media structure from the uri string (like \"media/\" etc.) and remove extension\n    const trimmed = uri.match(beforeLeadingSlashRegexp);\n    const fileName = trimmed ? trimmed[1] : uri;\n    return fileName.replace(fileExtensionRegexp, '');\n}\n/**\n * returns source image file name (no extension)\n * @param {string}     uri      image source uri\n *\n * @returns {FileType}\n */\nfunction getFileType(uri) {\n    if (isJPG(uri)) {\n        return fileType.JPG;\n    }\n    else if (isPNG(uri)) {\n        return fileType.PNG;\n    }\n    else if (isWEBP(uri)) {\n        return fileType.WEBP;\n    }\n    else if (isGIF(uri)) {\n        return fileType.GIF;\n    }\n    else if (isAVIF(uri)) {\n        return fileType.AVIF;\n    }\n    return fileType.UNRECOGNIZED;\n}\n/**\n * returns source image file extension\n * @param {string}     uri      image source uri\n *\n * @returns {string}\n */\nfunction getFileExtension(uri) {\n    const splitURI = /[.]([^.]+)$/.exec(uri);\n    return ((splitURI &amp;&amp; /[.]([^.]+)$/.exec(uri)[1]) || '').toLowerCase();\n}\n/**\n * returns scale factor needed if FIT fitting\n * @param {number}  sWidth\n * @param {number}  sHeight\n * @param {number}  dWidth\n * @param {number}  dHeight\n *\n * @returns {number}\n */\nfunction getFitScaleFactor(sWidth, sHeight, dWidth, dHeight) {\n    return Math.min(dWidth / sWidth, dHeight / sHeight);\n}\n/**\n * returns scale factor needed if FILL fitting\n * @param {number}  sWidth\n * @param {number}  sHeight\n * @param {number}  dWidth\n * @param {number}  dHeight\n *\n * @returns {number}\n */\nfunction getFillScaleFactor(sWidth, sHeight, dWidth, dHeight) {\n    return Math.max(dWidth / sWidth, dHeight / sHeight);\n}\n/**\n * returns scale factor source target\n * @param {number}  sWidth\n * @param {number}  sHeight\n * @param {number}  dWidth\n * @param {number}  dHeight\n * @param {string}  transformType\n *\n * @returns {number}\n */\nfunction getScaleFactor(sWidth, sHeight, dWidth, dHeight, transformType) {\n    let scaleFactor;\n    if (transformType === transformTypes.FILL) {\n        scaleFactor = getFillScaleFactor(sWidth, sHeight, dWidth, dHeight);\n    }\n    else if (transformType === transformTypes.FIT) {\n        scaleFactor = getFitScaleFactor(sWidth, sHeight, dWidth, dHeight);\n    }\n    else {\n        scaleFactor = 1;\n    }\n    return scaleFactor;\n}\n/**\n * get calculated scale factor , width and height while considering wixmp image transform dimension limits\n * @param sWidth\n * @param sHeight\n * @param dWidth\n * @param dHeight\n * @param transformType\n * @returns {{scaleFactor: *, width: *, height: *}}\n */\nfunction getSafeTransformData(sWidth, sHeight, dWidth, dHeight, transformType) {\n    let scaleFactor;\n    // defaults for FILL transform type\n    let width = dWidth;\n    let height = dHeight;\n    // calculate safe image transformed area\n    scaleFactor = getScaleFactor(sWidth, sHeight, dWidth, dHeight, transformType);\n    if (transformType === transformTypes.FIT) {\n        width = sWidth * scaleFactor;\n        height = sHeight * scaleFactor;\n    }\n    // adjust target width &amp; height &amp; scaleFactor\n    if (width &amp;&amp; height &amp;&amp; width * height &gt; SAFE_TRANSFORMED_AREA) {\n        const dimensionScaleFactor = Math.sqrt(SAFE_TRANSFORMED_AREA / (width * height));\n        width *= dimensionScaleFactor;\n        height *= dimensionScaleFactor;\n        // get the new scale factor\n        scaleFactor = getScaleFactor(sWidth, sHeight, width, height, transformType);\n    }\n    return {\n        scaleFactor,\n        width,\n        height,\n    };\n}\n/**\n * returns the destination rectangle\n * @param {number}                  sWidth\n * @param {number}                  sHeight\n * @param {TransformType}           transformType\n * @param {ImageTransformTarget}    target\n * @param {number}                  dpr - device pixel ratio\n * @param {UpscaleMethod}           upscaleMethod\n *\n * @returns {ImageTransformData &amp; {upscaleMethodValue: number}}\n */\nfunction getTransformData(sWidth, sHeight, transformType, target, dpr, upscaleMethod) {\n    // use target dimension is src not provided\n    sWidth = sWidth || target.width;\n    sHeight = sHeight || target.height;\n    // adjust image transform values considering server side transform limitations and performance\n    const { scaleFactor, width, height } = getSafeTransformData(sWidth, sHeight, target.width * dpr, target.height * dpr, transformType);\n    // adjust image transform values to optimizing upsacle quality and payload\n    return getOptimizedTransformData(sWidth, sHeight, width, height, upscaleMethod, scaleFactor, transformType);\n}\n/**\n * converts 9 grid alignment to Focal point position\n * @param {string}  [alignment]\n *\n * @returns {x:number,y:number}\n */\nfunction getFocalPointFrom9GridAlignment(alignment = alignTypes.CENTER) {\n    return ALIGN_TYPE_TO_FOCAL_POINT[alignment];\n}\n/**\n * returns overlapping rectangle where sRect\n * id aligned (according to alignment) within dRect\n * @param {{ width: number; height: number }} sRect rect 1\n * @param {{ width: number, height: number }} dRect rect 2\n * @param {{x: number, y: number}|undefined}  sFP   source image focal point\n * @param {string}                            alignment\n *\n * @returns {{x: number, y: number, width: number, height: number}}\n */\nfunction getAlignedRect(sRect, dRect, sFP, alignment) {\n    const fp = getFocalPoint(sFP) ||\n        getFocalPointFrom9GridAlignment(alignment);\n    const x = Math.max(0, Math.min(sRect.width - dRect.width, fp.x * sRect.width - dRect.width / 2));\n    const y = Math.max(0, Math.min(sRect.height - dRect.height, fp.y * sRect.height - dRect.height / 2));\n    // rect\n    return {\n        x,\n        y,\n        width: Math.min(sRect.width, dRect.width),\n        height: Math.min(sRect.height, dRect.height),\n    };\n}\n/**\n * returns overlapping rectangle between sRect and dRect\n * @param {object}      sRect         rect 1\n * @param {object}      dRect         rect 2\n *\n * @returns {{x:number,y:number,width:number, height:number} || null}\n */\nfunction getOverlappingRect(sRect, dRect) {\n    const width = Math.max(0, Math.min(sRect.width, dRect.x + dRect.width) - Math.max(0, dRect.x));\n    const height = Math.max(0, Math.min(sRect.height, dRect.y + dRect.height) - Math.max(0, dRect.y));\n    const isValidRect = width &amp;&amp; height &amp;&amp; (sRect.width !== width || sRect.height !== height);\n    // return overlapping sRect/dRect rectangle(x, y, width, height)\n    return isValidRect\n        ? {\n            x: Math.max(0, dRect.x),\n            y: Math.max(0, dRect.y),\n            width,\n            height,\n        }\n        : null;\n}\n/**\n * returns pixel aspect ratio value\n * @param {ImageTransformTarget}    target\n *\n * @returns {number}\n */\nfunction getDevicePixelRatio(target) {\n    return Math.min(target.pixelAspectRatio || 1, MAX_DEVICE_PIXEL_RATIO);\n}\n/**\n * returns target alignment value\n * @param {ImageTransformTarget}    target\n *\n * @returns {string}\n */\nfunction getAlignment(target) {\n    return ((target.alignment &amp;&amp; alignTypesMap[target.alignment]) ||\n        alignTypesMap[alignTypes.CENTER]);\n}\n/**\n * returns the focal point value, if no focal point passed use alignment\n * @param {{x: number, y: number}|undefined} focalPoint\n */\nfunction getFocalPoint(focalPoint) {\n    let fp;\n    if (focalPoint &amp;&amp;\n        typeof focalPoint.x === 'number' &amp;&amp;\n        !isNaN(focalPoint.x) &amp;&amp;\n        typeof focalPoint.y === 'number' &amp;&amp;\n        !isNaN(focalPoint.y)) {\n        fp = {\n            x: roundToFixed(Math.max(0, Math.min(100, focalPoint.x)) / 100, 2),\n            y: roundToFixed(Math.max(0, Math.min(100, focalPoint.y)) / 100, 2),\n        };\n    }\n    return fp;\n}\n/**\n * returns preferred image quality value\n * @param {number}    imageWidth\n * @param {number}    imageHeight\n *\n * @returns {number}\n */\nfunction getPreferredImageQuality(imageWidth, imageHeight) {\n    return imageScaleDefaults[getImageQualityKey(imageWidth, imageHeight)]\n        .quality;\n}\n/**\n * returns the scale descriptor of CLASSIC upscale method\n * @param sWidth\n * @param sHeight\n * @returns {{optimizedScaleFactor: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getClassicScaleData(sWidth, sHeight) {\n    const imageKey = getImageQualityKey(sWidth, sHeight);\n    return {\n        optimizedScaleFactor: imageScaleDefaults[imageKey].maxUpscale,\n        upscaleMethodValue: upscaleMethodsValues.classic,\n        forceUSM: false,\n    };\n}\n/**\n * returns the scale descriptor of AUTO upscale method\n * @param sWidth\n * @param sHeight\n * @returns {{optimizedScaleFactor: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getAutoScaleData(sWidth, sHeight) {\n    const imageKey = getImageQualityKey(sWidth, sHeight);\n    return {\n        optimizedScaleFactor: imageScaleDefaults[imageKey].maxUpscale,\n        upscaleMethodValue: upscaleMethodsValues.classic,\n        forceUSM: false,\n    };\n}\n/**\n * returns the scale descriptor of SUPER upscale method\n * @param scaleFactor\n * @returns {{optimizedScaleFactor: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getSuperScaleData(scaleFactor) {\n    return {\n        optimizedScaleFactor: last(SUPER_UPSCALE_MODELS),\n        upscaleMethodValue: upscaleMethodsValues.super,\n        forceUSM: !(SUPER_UPSCALE_MODELS.includes(scaleFactor) ||\n            scaleFactor &gt; last(SUPER_UPSCALE_MODELS)),\n    };\n}\n/**\n * returns upscale descriptor object\n * @param {number}    sWidth\n * @param {number}    sHeight\n * @param {string}    upscaleMethod\n * @param {number}    scaleFactor\n *\n * @returns  {{maxScale: number, upscaleMethodValue: number, forceUSM: boolean}}\n */\nfunction getOptimizedScaleData(sWidth, sHeight, scaleFactor, upscaleMethod) {\n    if (upscaleMethod === 'auto') {\n        return getAutoScaleData(sWidth, sHeight);\n    }\n    else if (upscaleMethod === 'super') {\n        return getSuperScaleData(scaleFactor);\n    }\n    // assuming 'classic' method\n    return getClassicScaleData(sWidth, sHeight);\n}\n/**\n * returns optimized upscale data, considering requested upscale method , optimize upscale for best quality and bandwidth\n * @param {number}    sWidth\n * @param {number}    sHeight\n * @param {number}    tWidth\n * @param {number}    tHeight\n * @param {UpscaleMethod}    upscaleMethod\n * @param {number}    scaleFactor\n * @param {TransformType}    transformType\n *\n * @returns  {ImageTransformData}\n */\nfunction getOptimizedTransformData(sWidth, sHeight, tWidth, tHeight, upscaleMethod, scaleFactor, transformType) {\n    const { optimizedScaleFactor, upscaleMethodValue, forceUSM } = getOptimizedScaleData(sWidth, sHeight, scaleFactor, upscaleMethod);\n    let width = tWidth;\n    let height = tHeight;\n    if (scaleFactor &lt;= optimizedScaleFactor) {\n        // target upscale within limits or downscale\n        return {\n            width,\n            height,\n            scaleFactor,\n            upscaleMethodValue,\n            forceUSM,\n            cssUpscaleNeeded: false,\n        };\n    }\n    // limited upscale\n    switch (transformType) {\n        case transformTypes.FILL:\n            width = tWidth * (optimizedScaleFactor / scaleFactor);\n            height = tHeight * (optimizedScaleFactor / scaleFactor);\n            break;\n        case transformTypes.FIT:\n            width = sWidth * optimizedScaleFactor;\n            height = sHeight * optimizedScaleFactor;\n            break;\n        default:\n            break;\n    }\n    // adjust transform values\n    return {\n        width,\n        height,\n        scaleFactor: optimizedScaleFactor,\n        upscaleMethodValue,\n        forceUSM,\n        cssUpscaleNeeded: true,\n    };\n}\n/**\n * returns image quality key\n * @param {number}    imageWidth\n * @param {number}    imageHeight\n *\n * @returns {ImageQuality}\n */\nfunction getImageQualityKey(imageWidth, imageHeight) {\n    const size = imageWidth * imageHeight;\n    if (size &gt; imageScaleDefaults[imageQuality.HIGH].size) {\n        return imageQuality.HIGH;\n    }\n    else if (size &gt; imageScaleDefaults[imageQuality.MEDIUM].size) {\n        return imageQuality.MEDIUM;\n    }\n    else if (size &gt; imageScaleDefaults[imageQuality.LOW].size) {\n        return imageQuality.LOW;\n    }\n    return imageQuality.TINY;\n}\n/**\n * return the actual rounded dimension of a scaled rectangle\n * @param sWidth\n * @param sHeight\n * @param tWidth\n * @param tHeight\n * @param transformType\n * @returns {{width: number, height: number}}\n */\nfunction getDimension(sWidth, sHeight, tWidth, tHeight, transformType) {\n    const scaleFactor = getScaleFactor(sWidth, sHeight, tWidth, tHeight, transformType);\n    return {\n        width: Math.round(sWidth * scaleFactor),\n        height: Math.round(sHeight * scaleFactor),\n    };\n}\n/**\n * rounds number n digit precision and converts to string\n * @param {number}      value\n * @param {number}      precision\n *\n * @returns {string}\n */\nfunction roundToFixed(value, precision) {\n    const truncatePrecision = Math.pow(10, precision || 0);\n    return ((value * truncatePrecision) / truncatePrecision).toFixed(precision);\n}\n/**\n * get normalize scale method\n * @param {ImageTransformOptions} [options]\n * @returns {UpscaleMethod}\n */\nfunction getUpscaleString(options) {\n    if (!options || !options.upscaleMethod) {\n        return upscaleMethods.AUTO;\n    }\n    return (upscaleMethods[options.upscaleMethod.toUpperCase()] || upscaleMethods.AUTO);\n}\nfunction imageIsAnimated(uri, hasAnimation) {\n    const isAvifWebpFormat = isWEBP(uri) || isAVIF(uri);\n    return (getFileExtension(uri) === fileType.GIF || (isAvifWebpFormat &amp;&amp; hasAnimation));\n}\nexport { getAlignedRect, getAlignment, getDevicePixelRatio, getDimension, getFileExtension, getFileName, getFileType, getFocalPoint, getOverlappingRect, getPreferredImageQuality, getScaleFactor, getTransformData, getUpscaleString, imageIsAnimated, isExternalUrl, isImageTransformApplicable, isImageTypeSupported, isSEOBot, isValidRequest, isPNG, isWEBP, isGIF, isAVIF, roundToFixed, };\n//# sourceMappingURL=imageServiceUtils.js.map","const globalFeaturesSupportObj = {\n    /**\n     * @type {object&lt;boolean&gt;}\n     */\n    isMobile: false,\n};\nconst getFeature = function (feature) {\n    return globalFeaturesSupportObj[feature];\n};\nconst setFeature = function (feature, value) {\n    globalFeaturesSupportObj[feature] = value;\n};\nexport { getFeature, setFeature };\n//# sourceMappingURL=imageServiceFeatureSupportObject.js.map","import { setFeature } from './imageServiceFeatureSupportObject';\n/**\n * Populate the global feature support object with browser specific values\n */\nfunction populateGlobalFeatureSupport() {\n    if (typeof window !== 'undefined' &amp;&amp; typeof navigator !== 'undefined') {\n        const isSmallScreen = window.matchMedia &amp;&amp; window.matchMedia('(max-width: 767px)').matches;\n        const isMobileAgent = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        // set is mobile\n        setFeature('isMobile', isSmallScreen &amp;&amp; isMobileAgent);\n    }\n}\nexport { populateGlobalFeatureSupport };\n//# sourceMappingURL=populateFeatureSupport.js.map","import { alignTypes, fittingTypes } from '../../helpers/imageServiceConstants';\n/**\n * returns BG tag CSS data\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformTarget}    target\n *\n * @returns {BackgroundImageAttributes}\n */\nfunction getCSS(transformsObj, target) {\n    const attributes = {\n        css: {\n            container: {},\n        },\n    };\n    const { css } = attributes;\n    const { fittingType } = transformsObj;\n    // set fitting\n    switch (fittingType) {\n        case fittingTypes.ORIGINAL_SIZE:\n        case fittingTypes.LEGACY_ORIGINAL_SIZE:\n        case fittingTypes.LEGACY_STRIP_ORIGINAL_SIZE:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'no-repeat';\n            break;\n        case fittingTypes.SCALE_TO_FIT:\n        case fittingTypes.LEGACY_STRIP_SCALE_TO_FIT:\n            css.container.backgroundSize = 'contain';\n            css.container.backgroundRepeat = 'no-repeat';\n            break;\n        case fittingTypes.STRETCH:\n            css.container.backgroundSize = '100% 100%';\n            css.container.backgroundRepeat = 'no-repeat';\n            break;\n        case fittingTypes.SCALE_TO_FILL:\n        case fittingTypes.LEGACY_STRIP_SCALE_TO_FILL:\n            css.container.backgroundSize = 'cover';\n            css.container.backgroundRepeat = 'no-repeat';\n            break;\n        case fittingTypes.TILE_HORIZONTAL:\n        case fittingTypes.LEGACY_STRIP_TILE_HORIZONTAL:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'repeat-x';\n            break;\n        case fittingTypes.TILE_VERTICAL:\n        case fittingTypes.LEGACY_STRIP_TILE_VERTICAL:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'repeat-y';\n            break;\n        case fittingTypes.TILE:\n        case fittingTypes.LEGACY_STRIP_TILE:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'repeat';\n            break;\n        case fittingTypes.LEGACY_STRIP_FIT_AND_TILE:\n            css.container.backgroundSize = 'contain';\n            css.container.backgroundRepeat = 'repeat';\n            break;\n        case fittingTypes.FIT_AND_TILE:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'repeat';\n            break;\n        // Legacy old editor bg types.\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'repeat';\n            break;\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'repeat-x';\n            break;\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'repeat-y';\n            break;\n        case fittingTypes.LEGACY_BG_NORMAL:\n            css.container.backgroundSize = 'auto';\n            css.container.backgroundRepeat = 'no-repeat';\n            break;\n    }\n    // set alignment\n    switch (target.alignment) {\n        case alignTypes.CENTER:\n            css.container.backgroundPosition = 'center center'; // 50% 50%\n            break;\n        case alignTypes.LEFT:\n            css.container.backgroundPosition = 'left center'; // 0% 50%\n            break;\n        case alignTypes.RIGHT:\n            css.container.backgroundPosition = 'right center'; // 100% 50%\n            break;\n        case alignTypes.TOP:\n            css.container.backgroundPosition = 'center top'; // 50% 0%\n            break;\n        case alignTypes.BOTTOM:\n            css.container.backgroundPosition = 'center bottom'; // 50% 100%\n            break;\n        case alignTypes.TOP_RIGHT:\n            css.container.backgroundPosition = 'right top'; // 100% 0%\n            break;\n        case alignTypes.TOP_LEFT:\n            css.container.backgroundPosition = 'left top'; // 0% 0%\n            break;\n        case alignTypes.BOTTOM_RIGHT:\n            css.container.backgroundPosition = 'right bottom'; // 100% 100%\n            break;\n        case alignTypes.BOTTOM_LEFT:\n            css.container.backgroundPosition = 'left bottom'; // 0% 100%\n            break;\n    }\n    // return background CSS\n    return attributes;\n}\nexport { getCSS as get };\n//# sourceMappingURL=backgroundAttributes.js.map","import { alignTypes, fittingTypes } from '../../helpers/imageServiceConstants';\n/**\n * align type to position\n * @param verticalMiddle\n * @param horizontalMiddle\n * @param target\n * @returns {{}}\n */\nfunction alignTypeToPosition(verticalMiddle, horizontalMiddle, target) {\n    return {\n        [alignTypes.TOP_LEFT]: { top: 0, left: 0 },\n        [alignTypes.TOP_RIGHT]: { top: 0, right: 0 },\n        [alignTypes.TOP]: { top: 0, left: horizontalMiddle },\n        [alignTypes.BOTTOM_LEFT]: { bottom: 0, left: 0 },\n        [alignTypes.BOTTOM_RIGHT]: { bottom: 0, right: 0 },\n        [alignTypes.BOTTOM]: { bottom: 0, left: horizontalMiddle },\n        [alignTypes.RIGHT]: { top: verticalMiddle, right: 0 },\n        [alignTypes.LEFT]: { top: verticalMiddle, left: 0 },\n        [alignTypes.CENTER]: {\n            width: target.width,\n            height: target.height,\n            objectFit: 'none',\n        },\n    };\n}\nconst alignTypeToPositionStr = {\n    [alignTypes.CENTER]: 'center',\n    [alignTypes.TOP]: 'top',\n    [alignTypes.TOP_LEFT]: 'top left',\n    [alignTypes.TOP_RIGHT]: 'top right',\n    [alignTypes.BOTTOM]: 'bottom',\n    [alignTypes.BOTTOM_LEFT]: 'bottom left',\n    [alignTypes.BOTTOM_RIGHT]: 'bottom right',\n    [alignTypes.LEFT]: 'left',\n    [alignTypes.RIGHT]: 'right',\n};\nconst aligmentDefaults = {\n    position: 'absolute',\n    top: 'auto',\n    right: 'auto',\n    bottom: 'auto',\n    left: 'auto',\n};\n/**\n * returns image tag CSS data\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformTarget}    target\n *\n * @returns {ImageAttributes}\n */\nfunction getCSS(transformsObj, target) {\n    const attributes = {\n        css: {\n            container: {},\n            img: {},\n        },\n    };\n    const { css } = attributes;\n    const { fittingType } = transformsObj;\n    const alignType = target.alignment;\n    css.container.position = 'relative';\n    switch (fittingType) {\n        case fittingTypes.ORIGINAL_SIZE:\n        case fittingTypes.LEGACY_ORIGINAL_SIZE:\n            if (transformsObj.parts &amp;&amp; transformsObj.parts.length) {\n                css.img.width = transformsObj.parts[0].width;\n                css.img.height = transformsObj.parts[0].height;\n            }\n            else {\n                css.img.width = transformsObj.src.width;\n                css.img.height = transformsObj.src.height;\n            }\n            break;\n        case fittingTypes.SCALE_TO_FIT:\n        case fittingTypes.LEGACY_FIT_WIDTH:\n        case fittingTypes.LEGACY_FIT_HEIGHT:\n        case fittingTypes.LEGACY_FULL:\n            css.img.width = target.width;\n            css.img.height = target.height;\n            css.img.objectFit = 'contain';\n            css.img.objectPosition =\n                alignTypeToPositionStr[alignType] || 'unset';\n            break;\n        // BG_NORMAL is a sitebackground legacy for original size fitting type.\n        // target width and height were modified in transform.js\n        case fittingTypes.LEGACY_BG_NORMAL:\n            css.img.width = '100%';\n            css.img.height = '100%';\n            css.img.objectFit = 'none';\n            css.img.objectPosition =\n                alignTypeToPositionStr[alignType] || 'unset';\n            break;\n        case fittingTypes.STRETCH:\n            css.img.width = target.width;\n            css.img.height = target.height;\n            css.img.objectFit = 'fill';\n            break;\n        case fittingTypes.SCALE_TO_FILL:\n            css.img.width = target.width;\n            css.img.height = target.height;\n            css.img.objectFit = 'cover';\n            break;\n    }\n    // set alignment in a private case where the image src is smaller than the image container,\n    if (typeof css.img.width === 'number' &amp;&amp;\n        typeof css.img.height === 'number' &amp;&amp;\n        (css.img.width !== target.width || css.img.height !== target.height)) {\n        const verticalMiddle = Math.round((target.height - css.img.height) / 2);\n        const horizontalMiddle = Math.round((target.width - css.img.width) / 2);\n        Object.assign(css.img, aligmentDefaults, alignTypeToPosition(verticalMiddle, horizontalMiddle, target)[alignType]);\n    }\n    return attributes;\n}\nexport { getCSS as get };\n//# sourceMappingURL=imgAttributes.js.map","import { fittingTypes, alignTypes, transformTypes, } from '../../helpers/imageServiceConstants';\nimport { getDimension, isImageTransformApplicable, } from '../../helpers/imageServiceUtils';\n/* eslint-disable indent */\n/**\n * get CSS or SVG attributes to be used in the browser\n * @param {ImageTransformObject}  transformsObj  transform parts object\n * @param {ImageTransformTarget}  target\n *\n * @returns {SVGImageAttributes}\n */\nfunction getSvgAttr(transformsObj, target) {\n    const attributes = {\n        css: {\n            container: {},\n        },\n        attr: {\n            container: {},\n            img: {},\n        },\n    };\n    const { css, attr } = attributes;\n    const { fittingType } = transformsObj;\n    const alignType = target.alignment;\n    const { width: sourceWidth, height: sourceHeight } = transformsObj.src;\n    let imageScale;\n    css.container.position = 'relative';\n    // populate SVG attributes object\n    // eslint-disable-line indent\n    switch (fittingType) {\n        case fittingTypes.ORIGINAL_SIZE:\n        case fittingTypes.LEGACY_ORIGINAL_SIZE:\n        case fittingTypes.TILE:\n            if (transformsObj.parts &amp;&amp; transformsObj.parts.length) {\n                attr.img.width = transformsObj.parts[0].width;\n                attr.img.height = transformsObj.parts[0].height;\n            }\n            else {\n                attr.img.width = sourceWidth;\n                attr.img.height = sourceHeight;\n            }\n            attr.img.preserveAspectRatio = 'xMidYMid slice';\n            break;\n        case fittingTypes.SCALE_TO_FIT:\n        case fittingTypes.LEGACY_FIT_WIDTH:\n        case fittingTypes.LEGACY_FIT_HEIGHT:\n        case fittingTypes.LEGACY_FULL:\n            attr.img.width = '100%';\n            attr.img.height = '100%';\n            attr.img.transform = '';\n            attr.img.preserveAspectRatio = '';\n            break;\n        case fittingTypes.STRETCH:\n            attr.img.width = target.width;\n            attr.img.height = target.height;\n            attr.img.x = 0;\n            attr.img.y = 0;\n            attr.img.transform = '';\n            attr.img.preserveAspectRatio = 'none';\n            break;\n        case fittingTypes.SCALE_TO_FILL:\n            if (!isImageTransformApplicable(transformsObj.src.id)) {\n                imageScale = getDimension(sourceWidth, sourceHeight, target.width, target.height, transformTypes.FILL);\n                attr.img.width = imageScale.width;\n                attr.img.height = imageScale.height;\n            }\n            else {\n                attr.img.width = target.width;\n                attr.img.height = target.height;\n            }\n            attr.img.x = 0;\n            attr.img.y = 0;\n            attr.img.transform = '';\n            attr.img.preserveAspectRatio = 'xMidYMid slice';\n            break;\n    }\n    // set alignment for cases where the requested src is smaller or bigger than the target element,\n    if (typeof attr.img.width === 'number' &amp;&amp;\n        typeof attr.img.height === 'number' &amp;&amp;\n        (attr.img.width !== target.width || attr.img.height !== target.height)) {\n        // x and y to use in svg &lt;pattern&gt; element\n        let x = 0;\n        let y = 0;\n        let right;\n        let bottom;\n        if (fittingType === fittingTypes.TILE) {\n            right = target.width % attr.img.width;\n            bottom = target.height % attr.img.height;\n        }\n        else {\n            right = target.width - attr.img.width;\n            bottom = target.height - attr.img.height;\n        }\n        const center = Math.round(right / 2);\n        const middle = Math.round(bottom / 2);\n        switch (alignType) {\n            case alignTypes.TOP_LEFT:\n                x = 0;\n                y = 0;\n                break;\n            case alignTypes.TOP:\n                x = center;\n                y = 0;\n                break;\n            case alignTypes.TOP_RIGHT:\n                x = right;\n                y = 0;\n                break;\n            case alignTypes.LEFT:\n                x = 0;\n                y = middle;\n                break;\n            case alignTypes.CENTER:\n                x = center;\n                y = middle;\n                break;\n            case alignTypes.RIGHT:\n                x = right;\n                y = middle;\n                break;\n            case alignTypes.BOTTOM_LEFT:\n                x = 0;\n                y = bottom;\n                break;\n            case alignTypes.BOTTOM:\n                x = center;\n                y = bottom;\n                break;\n            case alignTypes.BOTTOM_RIGHT:\n                x = right;\n                y = bottom;\n                break;\n        }\n        attr.img.x = x;\n        attr.img.y = y;\n    }\n    attr.container.width = target.width;\n    attr.container.height = target.height;\n    attr.container.viewBox = [0, 0, target.width, target.height].join(' ');\n    // return attributes object\n    return attributes;\n}\n/* eslint-enable indent */\nexport { getSvgAttr as get };\n//# sourceMappingURL=SVGAttributes.js.map","import { fittingTypes, transformTypes, alignTypesMap, } from './imageServiceConstants';\nimport { getAlignment, getScaleFactor, getOverlappingRect, getAlignedRect, getTransformData, getFocalPoint, } from './imageServiceUtils';\n/**\n * request analysis, returns parsed transforms object\n * @param {object}                  transformsObj\n * @param {ImageTransformSource}    src\n * @param {ImageTransformTarget}    target\n */\nfunction setTransformParts(transformsObj, src, target) {\n    let rect;\n    // crop source image if needed\n    // set crop part and adjust source dimensions\n    if (src.crop) {\n        rect = getOverlappingRect(src, src.crop);\n        if (rect) {\n            transformsObj.src.width = rect.width;\n            transformsObj.src.height = rect.height;\n            transformsObj.src.isCropped = true;\n            transformsObj.parts.push(getCropPart(rect));\n        }\n    }\n    // set additional transform part\n    switch (transformsObj.fittingType) {\n        case fittingTypes.SCALE_TO_FIT:\n        case fittingTypes.LEGACY_FIT_WIDTH:\n        case fittingTypes.LEGACY_FIT_HEIGHT:\n        case fittingTypes.LEGACY_FULL:\n        case fittingTypes.FIT_AND_TILE:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL:\n        case fittingTypes.LEGACY_BG_NORMAL:\n            // fit\n            transformsObj.parts.push(getFitPart(transformsObj, target));\n            break;\n        case fittingTypes.SCALE_TO_FILL:\n            // fill\n            transformsObj.parts.push(getFillPart(transformsObj, target));\n            break;\n        case fittingTypes.STRETCH:\n            // stretch\n            transformsObj.parts.push(getStretchPart(transformsObj, target));\n            break;\n        case fittingTypes.TILE_HORIZONTAL:\n        case fittingTypes.TILE_VERTICAL:\n        case fittingTypes.TILE:\n        case fittingTypes.LEGACY_ORIGINAL_SIZE:\n        case fittingTypes.ORIGINAL_SIZE:\n            // use crop transform\n            // if crop of source image was requested adjust cropping rectangle\n            rect = getAlignedRect(transformsObj.src, target, transformsObj.focalPoint, target.alignment);\n            if (transformsObj.src.isCropped) {\n                Object.assign(transformsObj.parts[0], rect);\n                // update source width &amp; height accordingly\n                transformsObj.src.width = rect.width;\n                transformsObj.src.height = rect.height;\n            }\n            else {\n                transformsObj.parts.push(getCropPart(rect));\n            }\n            break;\n        // ---------------------------------------------------------------------------------------\n        // handles a legacy bug on bgImageStrip, background html tag\n        // component Full Width Strip stored incorrect image source width and height\n        // ---------------------------------------------------------------------------------------\n        case fittingTypes.LEGACY_STRIP_TILE_HORIZONTAL:\n        case fittingTypes.LEGACY_STRIP_TILE_VERTICAL:\n        case fittingTypes.LEGACY_STRIP_TILE:\n        case fittingTypes.LEGACY_STRIP_ORIGINAL_SIZE:\n            // crop request of source image is not supported\n            // use legacy crop\n            transformsObj.parts.push(getLegacyCropPart(target));\n            break;\n        case fittingTypes.LEGACY_STRIP_SCALE_TO_FIT:\n        case fittingTypes.LEGACY_STRIP_FIT_AND_TILE:\n            // legacy fit\n            transformsObj.parts.push(getLegacyFitPart(target));\n            break;\n        case fittingTypes.LEGACY_STRIP_SCALE_TO_FILL:\n            // legacy fill\n            transformsObj.parts.push(getLegacyFillPart(target));\n            break;\n    }\n}\n/**\n * returns fit part of the image transform uri\n * @param {object}                  transformsObj\n * @param {ImageTransformTarget}    target\n *\n * @returns {TransformFitPart}\n */\nfunction getFitPart(transformsObj, target) {\n    // calculate the transformed image size needed\n    const transformedData = getTransformData(transformsObj.src.width, transformsObj.src.height, transformTypes.FIT, target, transformsObj.devicePixelRatio, transformsObj.upscaleMethod);\n    const isMissingSrcDimensions = !transformsObj.src.width || !transformsObj.src.height;\n    const transformType = isMissingSrcDimensions\n        ? transformTypes.FIT\n        : transformTypes.FILL;\n    // return fit transform data\n    return {\n        transformType,\n        width: Math.round(transformedData.width),\n        height: Math.round(transformedData.height),\n        alignment: alignTypesMap.center,\n        upscale: transformedData.scaleFactor &gt; 1,\n        forceUSM: transformedData.forceUSM,\n        scaleFactor: transformedData.scaleFactor,\n        cssUpscaleNeeded: transformedData.cssUpscaleNeeded,\n        upscaleMethodValue: transformedData.upscaleMethodValue,\n    };\n}\n/**\n * returns fill part of the image transform uri\n * @param {ImageTransformObject} transformsObj\n * @param {ImageTransformTarget} target\n *\n * @returns {TransformFillPart}\n */\nfunction getFillPart(transformsObj, target) {\n    // calculate the transformed image size needed\n    const transformedData = getTransformData(transformsObj.src.width, transformsObj.src.height, transformTypes.FILL, target, transformsObj.devicePixelRatio, transformsObj.upscaleMethod);\n    const focalPoint = getFocalPoint(transformsObj.focalPoint);\n    const transformType = focalPoint\n        ? transformTypes.FILL_FOCAL\n        : transformTypes.FILL;\n    return {\n        transformType,\n        width: Math.round(transformedData.width),\n        height: Math.round(transformedData.height),\n        alignment: getAlignment(target),\n        focalPointX: focalPoint &amp;&amp; focalPoint.x,\n        focalPointY: focalPoint &amp;&amp; focalPoint.y,\n        upscale: transformedData.scaleFactor &gt; 1,\n        forceUSM: transformedData.forceUSM,\n        scaleFactor: transformedData.scaleFactor,\n        cssUpscaleNeeded: transformedData.cssUpscaleNeeded,\n        upscaleMethodValue: transformedData.upscaleMethodValue,\n    };\n}\n/**\n * returns fill part of the image transform uri\n * @param {ImageTransformObject} transformsObj\n * @param {ImageTransformTarget} target\n *\n * @returns {TransformFitPart}\n */\nfunction getStretchPart(transformsObj, target) {\n    // stretch data\n    const scaleFactor = getScaleFactor(transformsObj.src.width, transformsObj.src.height, target.width, target.height, transformTypes.FILL);\n    const clonedTarget = { ...target };\n    clonedTarget.width = transformsObj.src.width * scaleFactor;\n    clonedTarget.height = transformsObj.src.height * scaleFactor;\n    // return stretch part\n    return getFitPart(transformsObj, clonedTarget);\n}\n/**\n * returns crop part of the image transform uri\n * @param {{x: number, y: number, width: number, height: number}}  rect     x, y, width, height\n *\n * @returns {TransformCropPart}\n */\nfunction getCropPart(rect) {\n    return {\n        transformType: transformTypes.CROP,\n        x: Math.round(rect.x),\n        y: Math.round(rect.y),\n        width: Math.round(rect.width),\n        height: Math.round(rect.height),\n        upscale: false,\n        forceUSM: false,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\n// ---------------------------------------------------------------------------------------\n// handles a legacy bug on bgImageStrip, background html tag\n// component Full Width Strip stored incorrect image source width and height\n// ---------------------------------------------------------------------------------------\n/**\n * returns fit part of the image transform uri\n * @param {ImageTransformTarget}    target\n *\n * @returns {TransformLegacyFitPart}\n */\nfunction getLegacyFitPart(target) {\n    return {\n        transformType: transformTypes.FIT,\n        width: Math.round(target.width),\n        height: Math.round(target.height),\n        upscale: false,\n        forceUSM: true,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\n/**\n * returns fill part of the image transform uri\n * @param {ImageTransformTarget}    target\n *\n * @returns {TransformLegacyFillPart}\n */\nfunction getLegacyFillPart(target) {\n    return {\n        transformType: transformTypes.LEGACY_FILL,\n        width: Math.round(target.width),\n        height: Math.round(target.height),\n        alignment: getAlignment(target),\n        upscale: false,\n        forceUSM: true,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\n/**\n * returns legacy crop part of the image transform uri\n * @param {ImageTransformTarget}     target\n *\n * @returns {TransformLegacyCropPart}\n */\nfunction getLegacyCropPart(target) {\n    return {\n        transformType: transformTypes.LEGACY_CROP,\n        width: Math.round(target.width),\n        height: Math.round(target.height),\n        alignment: getAlignment(target),\n        upscale: false,\n        forceUSM: false,\n        scaleFactor: 1,\n        cssUpscaleNeeded: false,\n    };\n}\nexport { setTransformParts };\n//# sourceMappingURL=imageTransformParts.js.map","import { last } from './utils';\nimport { getPreferredImageQuality, roundToFixed } from './imageServiceUtils';\nimport { defaultUSM, fileType, imageFilters, transformTypes, } from './imageServiceConstants';\n/**\n * returns image filters part of the image transform uri\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformOptions}   [options]\n */\nfunction setTransformOptions(transformsObj, options) {\n    options = options || {};\n    // options - general\n    transformsObj.quality = getQuality(transformsObj, options);\n    transformsObj.progressive = getProgressive(options);\n    transformsObj.watermark = getWatermark(options);\n    transformsObj.autoEncode = options.autoEncode ?? true;\n    transformsObj.encoding = options?.encoding;\n    // options - filters &amp; adjustments\n    transformsObj.unsharpMask = getUnsharpMask(transformsObj, options);\n    transformsObj.filters = getFilters(options);\n}\n/**\n *\n * @param {ImageTransformOptions}   options\n * @returns {string}\n */\nfunction getWatermark(options) {\n    return options.watermark;\n}\n/**\n * returns progressive if required\n * @param {ImageTransformOptions}   options\n *\n * @returns {boolean}\n */\nfunction getProgressive(options) {\n    return options.progressive !== false;\n}\n/**\n * returns image filters part of the image transform uri\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformOptions}   options\n *\n * @returns {number}\n */\nfunction getQuality(transformsObj, options) {\n    const isPNG = transformsObj.fileType === fileType.PNG;\n    const isJPG = transformsObj.fileType === fileType.JPG;\n    const isWEBP = transformsObj.fileType === fileType.WEBP;\n    const isAVIF = transformsObj.fileType === fileType.AVIF;\n    const isQualitySupported = isJPG || isPNG || isWEBP || isAVIF;\n    if (isQualitySupported) {\n        const transformData = last(transformsObj.parts);\n        const defaultQuality = getPreferredImageQuality(transformData.width, transformData.height);\n        let quality = options.quality &amp;&amp; options.quality &gt;= 5 &amp;&amp; options.quality &lt;= 90\n            ? options.quality\n            : defaultQuality;\n        // increase quality by 5 for webp images\n        quality = isPNG ? quality + 5 : quality;\n        return quality;\n    }\n    // quality not supported\n    return 0;\n}\n/**\n * returns the desired transformed image filters\n * @param {ImageTransformOptions}   options\n *\n * @returns {object}\n */\nfunction getFilters(options) {\n    const filterOptions = options.filters || {};\n    const filters = {};\n    // contrast\n    if (isValidImageFilter(filterOptions[imageFilters.CONTRAST], -100, 100)) {\n        filters[imageFilters.CONTRAST] = filterOptions[imageFilters.CONTRAST];\n    }\n    // brightness\n    if (isValidImageFilter(filterOptions[imageFilters.BRIGHTNESS], -100, 100)) {\n        filters[imageFilters.BRIGHTNESS] = filterOptions[imageFilters.BRIGHTNESS];\n    }\n    // saturation\n    if (isValidImageFilter(filterOptions[imageFilters.SATURATION], -100, 100)) {\n        filters[imageFilters.SATURATION] = filterOptions[imageFilters.SATURATION];\n    }\n    // hue\n    if (isValidImageFilter(filterOptions[imageFilters.HUE], -180, 180)) {\n        filters[imageFilters.HUE] = filterOptions[imageFilters.HUE];\n    }\n    // blur\n    if (isValidImageFilter(filterOptions[imageFilters.BLUR], 0, 100)) {\n        filters[imageFilters.BLUR] = filterOptions[imageFilters.BLUR];\n    }\n    return filters;\n}\n/**\n * indicates if requested filter value is valid\n * @param {number|undefined}  filterValue     filter's value\n * @param {number}  minValue        min range\n * @param {number}  maxValue        max range\n *\n * @returns {boolean}\n */\nfunction isValidImageFilter(filterValue, minValue, maxValue) {\n    // check if filter name and filter values range valid\n    return (typeof filterValue === 'number' &amp;&amp;\n        !isNaN(filterValue) &amp;&amp;\n        filterValue !== 0 &amp;&amp;\n        filterValue &gt;= minValue &amp;&amp;\n        filterValue &lt;= maxValue);\n}\n/**\n * returns the desired transformed image unSharpMask values\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformOptions}   options\n *\n * @returns {object}\n */\nfunction getUnsharpMask(transformsObj, options) {\n    // If options.unsharpMask is a valid value, use it\n    if (isUSMValid(options.unsharpMask)) {\n        // If we got usm, change values to have trailing zeros (.00), else return undefined\n        return {\n            radius: roundToFixed(options.unsharpMask?.radius, 2),\n            amount: roundToFixed(options.unsharpMask?.amount, 2),\n            threshold: roundToFixed(options.unsharpMask?.threshold, 2),\n        };\n        // if options.unsharpMask is not all zeros and not valid and usm should be used, use default\n    }\n    else if (!isZeroUSM(options.unsharpMask) &amp;&amp; isUSMNeeded(transformsObj)) {\n        return defaultUSM;\n    }\n    return;\n}\n/**\n * indicates if usm is needed\n * @param {ImageTransformObject}      transformsObj   transform parts object\n *\n * @returns {boolean}\n */\nfunction isUSMNeeded(transformsObj) {\n    // ---------------------------------------------------------------------------------------\n    // do not apply usm if transformed image width &amp; height is same as source image or larger\n    // and no force usm is desired\n    // and transform type is not fit\n    // ---------------------------------------------------------------------------------------\n    const transformPart = last(transformsObj.parts);\n    const upscale = transformPart.scaleFactor &gt;= 1;\n    // return if usm is needed\n    return (!upscale ||\n        transformPart.forceUSM ||\n        transformPart.transformType === transformTypes.FIT);\n}\n/**\n * indicates if all usm values are presented and in range\n * @param {OptionUnsharpMask|undefined}  usm     unsharp mask\n *\n * @returns {boolean}\n */\nfunction isUSMValid(usm) {\n    usm = usm || {};\n    const radius = typeof usm.radius === 'number' &amp;&amp;\n        !isNaN(usm.radius) &amp;&amp;\n        usm.radius &gt;= 0.1 &amp;&amp;\n        usm.radius &lt;= 500;\n    const amount = typeof usm.amount === 'number' &amp;&amp;\n        !isNaN(usm.amount) &amp;&amp;\n        usm.amount &gt;= 0 &amp;&amp;\n        usm.amount &lt;= 10;\n    const threshold = typeof usm.threshold === 'number' &amp;&amp;\n        !isNaN(usm.threshold) &amp;&amp;\n        usm.threshold &gt;= 0 &amp;&amp;\n        usm.threshold &lt;= 255;\n    // return is a valid USM data\n    return radius &amp;&amp; amount &amp;&amp; threshold;\n}\n/**\n * indicates if all usm values are presented and are zero. an explicit request to not apply usm\n * @param {OptionUnsharpMask|undefined}  usm     unsharp mask\n *\n * @returns {boolean}\n */\nfunction isZeroUSM(usm) {\n    usm = usm || {};\n    return (typeof usm.radius === 'number' &amp;&amp;\n        !isNaN(usm.radius) &amp;&amp;\n        usm.radius === 0 &amp;&amp;\n        typeof usm.amount === 'number' &amp;&amp;\n        !isNaN(usm.amount) &amp;&amp;\n        usm.amount === 0 &amp;&amp;\n        typeof usm.threshold === 'number' &amp;&amp;\n        !isNaN(usm.threshold) &amp;&amp;\n        usm.threshold === 0);\n}\nexport { setTransformOptions };\n//# sourceMappingURL=imageTransformOptions.js.map","import { isSEOBot, getFileType, getFileName, getFileExtension, getDevicePixelRatio, getUpscaleString, isImageTransformApplicable, imageIsAnimated, } from '../helpers/imageServiceUtils';\nimport { isMobile } from '../helpers/browserFeatureSupport';\nimport { setTransformParts } from '../helpers/imageTransformParts';\nimport { setTransformOptions } from '../helpers/imageTransformOptions';\nimport { MOBILE_MAX_BG_SITE_LEGACY_WIDTH, DSKTP_MAX_BG_SITE_LEGACY_WIDTH, MOBILE_MAX_BG_SITE_LEGACY_HEIGHT, DSKTP_MAX_BG_SITE_LEGACY_HEIGHT, fittingTypes, } from '../helpers/imageServiceConstants';\n/**\n * returns image transform data\n *\n * @param {FittingType}             fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   [options]           transform options\n *\n * @returns {ImageTransformObject}\n */\nfunction getTransform(fittingType, src, target, options) {\n    const _isSEOBot = isSEOBot(options);\n    const fileType = getFileType(src.id);\n    const fileName = getFileName(src.id, src.name);\n    const devicePixelRatio = _isSEOBot ? 1 : getDevicePixelRatio(target);\n    const fileExtension = getFileExtension(src.id);\n    const preferredExtension = fileExtension;\n    const canTransformImage = isImageTransformApplicable(src.id, options?.hasAnimation, options?.allowAnimatedTransform);\n    const transformsObj = {\n        fileName,\n        fileExtension,\n        fileType,\n        fittingType,\n        preferredExtension,\n        src: {\n            id: src.id,\n            width: src.width,\n            height: src.height,\n            isCropped: false,\n            isAnimated: imageIsAnimated(src.id, options?.hasAnimation),\n        },\n        focalPoint: {\n            x: src.focalPoint &amp;&amp; src.focalPoint.x,\n            y: src.focalPoint &amp;&amp; src.focalPoint.y,\n        },\n        parts: [],\n        // options - general\n        devicePixelRatio,\n        quality: 0,\n        upscaleMethod: getUpscaleString(options),\n        progressive: true,\n        watermark: '',\n        unsharpMask: {},\n        filters: {},\n        transformed: canTransformImage,\n    };\n    if (canTransformImage) {\n        setTransformParts(transformsObj, src, target);\n        setTransformOptions(transformsObj, options);\n    }\n    return transformsObj;\n}\n/**\n * returns target data\n * handle legacy BG site if needed\n *\n * @param {FittingType}             fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n *\n * @returns {Object}\n */\nfunction getTarget(fittingType, src, target) {\n    const targetObj = { ...target };\n    const _isMobile = isMobile();\n    // handle site BG legacy fitting types (desktop &amp; mobile)\n    switch (fittingType) {\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:\n        case fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL:\n        case fittingTypes.LEGACY_BG_NORMAL:\n            const maxBGSiteLegacyWidth = _isMobile\n                ? MOBILE_MAX_BG_SITE_LEGACY_WIDTH\n                : DSKTP_MAX_BG_SITE_LEGACY_WIDTH;\n            const maxBGSiteLegacyHeight = _isMobile\n                ? MOBILE_MAX_BG_SITE_LEGACY_HEIGHT\n                : DSKTP_MAX_BG_SITE_LEGACY_HEIGHT;\n            targetObj.width = Math.min(maxBGSiteLegacyWidth, src.width);\n            targetObj.height = Math.min(maxBGSiteLegacyHeight, Math.round(targetObj.width / (src.width / src.height)));\n            // for legacy types force htmlTag='bg' and devicePixelRatio=1\n            targetObj.pixelAspectRatio = 1;\n    }\n    return targetObj;\n}\nexport { getTransform, getTarget };\n//# sourceMappingURL=transform.js.map","import { getFeature } from './imageServiceFeatureSupportObject';\n/**\n * get a browser detection if running on mobile device\n *\n * @returns {boolean}\n */\nfunction isMobile() {\n    return getFeature('isMobile');\n}\nexport { isMobile };\n//# sourceMappingURL=browserFeatureSupport.js.map","import { template } from '../helpers/utils';\nimport { imageFilters, transformTypes, API_VERSION, fileType, encodingTypes, } from '../helpers/imageServiceConstants';\n// transform templates\nconst fitTemplate = template `fit/w_${'width'},h_${'height'}`;\nconst fillTemplate = template `fill/w_${'width'},h_${'height'},al_${'alignment'}`;\nconst fillFocalTemplate = template `fill/w_${'width'},h_${'height'},fp_${'focalPointX'}_${'focalPointY'}`;\nconst cropTemplate = template `crop/x_${'x'},y_${'y'},w_${'width'},h_${'height'}`;\n// legacy templates\nconst legacyCropTemplate = template `crop/w_${'width'},h_${'height'},al_${'alignment'}`;\nconst legacyFillTemplate = template `fill/w_${'width'},h_${'height'},al_${'alignment'}`;\n// upscale template\nconst upscaleTemplate = template `,lg_${'upscaleMethodValue'}`;\n// options templates\nconst qualityTemplate = template `,q_${'quality'}`;\nconst qualityAutoTemplate = template `,quality_auto`;\nconst unSharpMaskTemplate = template `,usm_${'radius'}_${'amount'}_${'threshold'}`;\nconst nonProgressiveTemplate = template `,bl`;\nconst watermarkTemplate = template `,wm_${'watermark'}`;\nconst filterTemplatesMap = {\n    [imageFilters.CONTRAST]: template `,con_${'contrast'}`,\n    [imageFilters.BRIGHTNESS]: template `,br_${'brightness'}`,\n    [imageFilters.SATURATION]: template `,sat_${'saturation'}`,\n    [imageFilters.HUE]: template `,hue_${'hue'}`,\n    [imageFilters.BLUR]: template `,blur_${'blur'}`,\n};\nconst autoEncodeTemplate = template `,enc_auto`;\nconst AVIFEncodeTemplate = template `,enc_avif`;\nconst pAVIFEncodeTemplate = template `,enc_pavif`;\nconst animatedTransformTemplate = template `,pstr`;\n/**\n * returns image transform uri\n * @param {object}  transformsObj\n *\n * @returns {string}\n */\nfunction getImageURI(transformsObj) {\n    // construct image transforms\n    const transformsObjStrArr = [];\n    // construct transform\n    transformsObj.parts.forEach((transformPart) =&gt; {\n        switch (transformPart.transformType) {\n            case transformTypes.CROP:\n                transformsObjStrArr.push(cropTemplate(transformPart));\n                break;\n            case transformTypes.LEGACY_CROP:\n                transformsObjStrArr.push(legacyCropTemplate(transformPart));\n                break;\n            case transformTypes.LEGACY_FILL:\n                let legacyFillStr = legacyFillTemplate(transformPart);\n                if (transformPart.upscale) {\n                    legacyFillStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(legacyFillStr);\n                break;\n            case transformTypes.FIT:\n                let fitStr = fitTemplate(transformPart);\n                if (transformPart.upscale) {\n                    fitStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(fitStr);\n                break;\n            case transformTypes.FILL:\n                let fillStr = fillTemplate(transformPart);\n                if (transformPart.upscale) {\n                    fillStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(fillStr);\n                break;\n            case transformTypes.FILL_FOCAL:\n                let fillFocalStr = fillFocalTemplate(transformPart);\n                if (transformPart.upscale) {\n                    fillFocalStr += upscaleTemplate(transformPart);\n                }\n                transformsObjStrArr.push(fillFocalStr);\n                break;\n        }\n    });\n    let transformsStr = transformsObjStrArr.join('/');\n    // construct transform options\n    // quality\n    if (transformsObj.quality) {\n        transformsStr += qualityTemplate(transformsObj);\n    }\n    // un-sharp mask\n    if (transformsObj.unsharpMask) {\n        transformsStr += unSharpMaskTemplate(transformsObj.unsharpMask);\n    }\n    // progressive\n    if (!transformsObj.progressive) {\n        transformsStr += nonProgressiveTemplate(transformsObj);\n    }\n    // watermark\n    if (transformsObj.watermark) {\n        transformsStr += watermarkTemplate(transformsObj);\n    }\n    // filters\n    if (transformsObj.filters) {\n        transformsStr += Object.keys(transformsObj.filters)\n            .map((filterName) =&gt; filterTemplatesMap[filterName](transformsObj.filters))\n            .join('');\n    }\n    // encoding\n    if (transformsObj.fileType !== fileType.GIF) {\n        if (transformsObj.encoding === encodingTypes.AVIF) {\n            transformsStr += AVIFEncodeTemplate(transformsObj);\n            transformsStr += qualityAutoTemplate(transformsObj);\n        }\n        else if (transformsObj.encoding === encodingTypes.PAVIF) {\n            transformsStr += pAVIFEncodeTemplate(transformsObj);\n            transformsStr += qualityAutoTemplate(transformsObj);\n        }\n        else if (transformsObj.autoEncode) {\n            transformsStr += autoEncodeTemplate(transformsObj);\n        }\n    }\n    // animated image poster transform\n    if (transformsObj.src?.isAnimated &amp;&amp; transformsObj.transformed) {\n        transformsStr += animatedTransformTemplate(transformsObj);\n    }\n    // image url string\n    return `${transformsObj.src.id}/${API_VERSION}/${transformsStr}/${transformsObj.fileName}.${transformsObj.preferredExtension}`;\n}\nexport { getImageURI };\n//# sourceMappingURL=transforms.js.map","import { isAVIF, isImageTransformApplicable, isWEBP, } from '../helpers/imageServiceUtils';\nimport { getImageURI } from '../engines/transforms';\nimport { getTransform } from './transform';\n/**\n * returns image transform uri\n *\n * @param {string}                  fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   options             transform options\n * @param {Object}                  [transformObj]      transform data object to use\n *\n * @returns {string}\n */\nfunction getURI(fittingType, src, target, options = {}, transformObj) {\n    // check if image transformation is applicable (e.g. .gif, .wix_mp)\n    if (isImageTransformApplicable(src.id, options?.hasAnimation, options?.allowAnimatedTransform)) {\n        if (isWEBP(src.id) || isAVIF(src.id)) {\n            // exclude alignment, focalPoint and crop from webp and avif transformation in order not to break webp or avif images before transformation was enabled\n            const { alignment, ...transformTarget } = target;\n            src.focalPoint = { x: undefined, y: undefined };\n            delete src?.crop;\n            transformObj = getTransform(fittingType, src, transformTarget, options);\n        }\n        else {\n            transformObj =\n                transformObj || getTransform(fittingType, src, target, options);\n        }\n        // set the uri property\n        return getImageURI(transformObj);\n    }\n    return src.id;\n}\nexport { getURI };\n//# sourceMappingURL=uri.js.map","import { alignTypes, fittingTypes } from './imageServiceConstants';\nimport { isPNG } from './imageServiceUtils';\nconst ALIGN_TYPE_TO_POSITION = {\n    [alignTypes.CENTER]: '50% 50%',\n    [alignTypes.TOP_LEFT]: '0% 0%',\n    [alignTypes.TOP_RIGHT]: '100% 0%',\n    [alignTypes.TOP]: '50% 0%',\n    [alignTypes.BOTTOM_LEFT]: '0% 100%',\n    [alignTypes.BOTTOM_RIGHT]: '100% 100%',\n    [alignTypes.BOTTOM]: '50% 100%',\n    [alignTypes.RIGHT]: '100% 50%',\n    [alignTypes.LEFT]: '0% 50%',\n};\nconst POSITION_TO_ALIGN_TYPE = Object.entries(ALIGN_TYPE_TO_POSITION).reduce((acc, [align, position]) =&gt; {\n    acc[position] = align;\n    return acc;\n}, {});\nconst TILE_FITTING_TYPES = [\n    fittingTypes.TILE,\n    fittingTypes.TILE_HORIZONTAL,\n    fittingTypes.TILE_VERTICAL,\n    fittingTypes.LEGACY_BG_FIT_AND_TILE,\n    fittingTypes.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,\n    fittingTypes.LEGACY_BG_FIT_AND_TILE_VERTICAL,\n];\nconst NON_SCALING_FITTING_TYPES = [\n    fittingTypes.LEGACY_ORIGINAL_SIZE,\n    fittingTypes.ORIGINAL_SIZE,\n    fittingTypes.LEGACY_BG_NORMAL,\n];\nfunction getIsFakeTile(fittingType, src, { width: targetWidth, height: targetHeight, }) {\n    return (fittingType === fittingTypes.TILE &amp;&amp;\n        src.width &gt; targetWidth &amp;&amp;\n        src.height &gt; targetHeight);\n}\n/**\n *\n * @param {FittingType}             fittingType      imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src              source image\n * @param {Dimensions}              target           target container dimensions\n * @param {boolean}                 [isSEOBot=false] whether it is a render for a bot request\n * @returns {Dimensions} scaled dimensions\n */\nfunction getScaledDimensions(fittingType, src, { width, height }, isSEOBot = false) {\n    if (isSEOBot) {\n        return { width, height };\n    }\n    const isScalable = !NON_SCALING_FITTING_TYPES.includes(fittingType);\n    const isFakeTile = getIsFakeTile(fittingType, src, { width, height });\n    const isTile = !isFakeTile &amp;&amp; TILE_FITTING_TYPES.includes(fittingType);\n    const _width = isTile ? src.width : width;\n    const _height = isTile ? src.height : height;\n    const scaleFactor = isScalable\n        ? getScaleFactorByWidth(_width, isPNG(src.id))\n        : 1;\n    return {\n        width: isFakeTile ? 1920 : _width * scaleFactor,\n        height: _height * scaleFactor,\n    };\n}\n/**\n *\n * @param {FittingType} fittingType  imageServicesTypes.fittingTypes\n * @param {boolean} isFakeTile\n * @returns {string} fittingType\n */\nfunction getConvertedFitting(fittingType, isFakeTile) {\n    const isTile = TILE_FITTING_TYPES.includes(fittingType) &amp;&amp; !isFakeTile;\n    const isFill = fittingType === fittingTypes.SCALE_TO_FILL;\n    return isFill || isTile ? fittingTypes.SCALE_TO_FIT : fittingType;\n}\n/**\n *\n * @param {ImageTransformSource}    src                 source image\n * @param {number || ''}            width\n * @param {number || ''}            height\n * @returns {Dimensions}    width, height\n */\nfunction validateTargetDimensions(src, { width, height }) {\n    if (!width || !height) {\n        const _width = width || Math.min(980, src.width);\n        const heightRatio = _width / src.width;\n        return {\n            width: _width,\n            height: height || src.height * heightRatio,\n        };\n    }\n    return { width, height };\n}\n/**\n *\n * @param {number} width\n * @param {boolean} isHighQuality\n * @return {number}\n */\nfunction getScaleFactorByWidth(width, isHighQuality) {\n    if (width &gt; 900) {\n        return isHighQuality ? 0.05 : 0.15;\n    }\n    else if (width &gt; 500) {\n        return isHighQuality ? 0.1 : 0.18;\n    }\n    else if (width &gt; 200) {\n        return 0.25;\n    }\n    return 1;\n}\n/**\n *\n * @param {number} width\n * @param {FittingType} fittingType imageServicesTypes.fittingTypes\n * @param {boolean} isSEOBot\n * @return {number}\n */\nfunction getBlurValue(width, fittingType, isSEOBot) {\n    if (isSEOBot) {\n        return 0;\n    }\n    if (TILE_FITTING_TYPES.includes(fittingType)) {\n        return 1;\n    }\n    if (width &gt; 200) {\n        return 2;\n    }\n    return 3;\n}\n/**\n *\n * @param {FittingType}                       fittingType\n * @param {ImageTransformSource}              src                  source image\n * @param {{width?: number; height?: number}} target               target element\n * @param {string}                            [alignment='center']\n * @returns {{img}, {container}}\n */\nfunction getCSSOverrides(fittingType, src, target, alignment = 'center') {\n    const returnValue = {\n        img: {},\n        container: {},\n    };\n    if (fittingType === fittingTypes.SCALE_TO_FILL) {\n        const alignTypeFromFocalPoint = src.focalPoint &amp;&amp; convertFocalPointToAlignType(src.focalPoint);\n        const alignType = alignTypeFromFocalPoint || alignment;\n        if (src.focalPoint &amp;&amp; !alignTypeFromFocalPoint) {\n            returnValue.img = {\n                objectPosition: convertFillFocalToPosition(src, target, src.focalPoint),\n            };\n        }\n        else {\n            returnValue.img = {\n                objectPosition: ALIGN_TYPE_TO_POSITION[alignType],\n            };\n        }\n    }\n    else if ([fittingTypes.LEGACY_ORIGINAL_SIZE, fittingTypes.ORIGINAL_SIZE].includes(fittingType)) {\n        returnValue.img = {\n            objectFit: 'none',\n            top: 'auto',\n            left: 'auto',\n            right: 'auto',\n            bottom: 'auto',\n        };\n    }\n    else if (TILE_FITTING_TYPES.includes(fittingType)) {\n        returnValue.container = {\n            backgroundSize: `${src.width}px ${src.height}px`,\n        };\n    }\n    return returnValue;\n}\n/**\n * Try to convert focal point value to 9 grid alignment value\n *\n * @param {Point}    focalPoint\n * @returns {AlignType} align type\n */\nfunction convertFocalPointToAlignType(focalPoint) {\n    const position = `${focalPoint.x}% ${focalPoint.y}%`;\n    return POSITION_TO_ALIGN_TYPE[position] || '';\n}\n/**\n *\n * @param {Dimensions} src source dimensions\n * @param {width?: number; height?: number} target target dimensions\n * @param {Point} focalPoint x/y as 0-100 percentages\n * @returns {string} in 'x% y%' format\n */\nfunction convertFillFocalToPosition(src, target, focalPoint) {\n    const { width: sW, height: sH } = src;\n    const { width: tW, height: tH } = target;\n    const { x: fpX, y: fpY } = focalPoint;\n    if (!tW || !tH) {\n        return `${fpX}% ${fpY}%`;\n    }\n    const fillScaleFactor = Math.max(tW / sW, tH / sH);\n    const imgScaledW = sW * fillScaleFactor;\n    const imgScaledH = sH * fillScaleFactor;\n    const x = Math.max(0, Math.min(imgScaledW - tW, imgScaledW * (fpX / 100) - tW / 2));\n    const y = Math.max(0, Math.min(imgScaledH - tH, imgScaledH * (fpY / 100) - tH / 2));\n    const posX = x &amp;&amp; Math.floor((x / (imgScaledW - tW)) * 100);\n    const posY = y &amp;&amp; Math.floor((y / (imgScaledH - tH)) * 100);\n    return `${posX}% ${posY}%`;\n}\nexport { getBlurValue, getConvertedFitting, getCSSOverrides, getIsFakeTile, getScaledDimensions, validateTargetDimensions, };\n//# sourceMappingURL=imagePlaceholderUtils.js.map","import { emptyData } from '../../helpers/imageServiceConstants';\nimport { isImageTransformApplicable, isValidRequest, } from '../../helpers/imageServiceUtils';\nimport { getAttributes } from '../../engines/attributes';\nimport { getTransform, getTarget } from '../transform';\nimport { getURI } from '../uri';\nimport { getSrcset } from '../srcset';\nimport { getScaledDimensions, getBlurValue, getCSSOverrides, validateTargetDimensions, getIsFakeTile, getConvertedFitting, } from '../../helpers/imagePlaceholderUtils';\nconst PLACEHOLDER_IMG_CSS_OVERRIDES = { width: '100%', height: '100%' };\n/**\n * returns image _placeholder_ transform uri and the\n * needed css for alignment and positioning\n *\n * @param {FittingType}             fittingType imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src         image\n * @param {ImagePlaceholderTransformTarget}    target      target dimensions\n * @param {ImageTransformOptions} [options]   environment / transformation  options\n *\n * @returns {ImageDataAttributes}\n */\nfunction getPlaceholder(fittingType, src, target, options = {}) {\n    const { autoEncode = true, isSEOBot, shouldLoadHQImage, hasAnimation, allowAnimatedTransform, encoding, } = options;\n    if (!isValidRequest(fittingType, src, target)) {\n        return emptyData;\n    }\n    const IS_IN_PLACEHOLDER_FLOW = typeof allowAnimatedTransform === 'undefined'\n        ? true\n        : allowAnimatedTransform;\n    const canTransformImage = isImageTransformApplicable(src.id, hasAnimation, IS_IN_PLACEHOLDER_FLOW);\n    if (!canTransformImage || shouldLoadHQImage) {\n        /* Either:\n         * 1. Transform isn't applicable so target is original size applied with fluid CSS\n         * 2. User asked for an HQ image, so they must have supplied target size (width/height)\n         */\n        return getData(fittingType, src, target, {\n            ...options,\n            autoEncode,\n            useSrcset: canTransformImage,\n        });\n    }\n    // If there aren't dimensions, we make them up\n    const newTarget = {\n        ...target,\n        ...validateTargetDimensions(src, target),\n    };\n    const { alignment, htmlTag } = newTarget;\n    const isFakeTile = getIsFakeTile(fittingType, src, newTarget);\n    const scaledDimensions = getScaledDimensions(fittingType, src, newTarget, isSEOBot);\n    const blur = getBlurValue(newTarget.width, fittingType, isSEOBot);\n    const convertedFittingType = getConvertedFitting(fittingType, isFakeTile);\n    const overrideCSS = getCSSOverrides(fittingType, src, target, alignment);\n    const { uri } = getData(convertedFittingType, src, {\n        ...scaledDimensions,\n        alignment,\n        htmlTag,\n    }, {\n        autoEncode,\n        filters: blur ? { blur } : {},\n        hasAnimation,\n        allowAnimatedTransform: IS_IN_PLACEHOLDER_FLOW,\n        encoding,\n    });\n    const { attr = {}, css } = getData(fittingType, src, {\n        ...newTarget,\n        alignment,\n        htmlTag,\n    }, {});\n    css.img = css.img || {};\n    css.container = css.container || {};\n    Object.assign(css.img, overrideCSS.img, PLACEHOLDER_IMG_CSS_OVERRIDES);\n    Object.assign(css.container, overrideCSS.container);\n    return { uri, css, attr, transformed: true };\n}\n/**\n * returns image transform uri and the\n * needed css for alignment and positioning\n *\n * @param {FittingType}             fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   [options]          transform options\n *\n * @returns {ImageDataAttributes}\n */\nfunction getData(fittingType, src, target, options) {\n    let data = {};\n    // check if valid request\n    if (isValidRequest(fittingType, src, target)) {\n        // handle site BG legacy fitting types if needed\n        const targetObj = getTarget(fittingType, src, target);\n        // parse request and create working OBJ\n        const transformObj = getTransform(fittingType, src, targetObj, options);\n        data.uri = getURI(fittingType, src, targetObj, options, transformObj);\n        if (options?.useSrcset) {\n            data.srcset = getSrcset(fittingType, src, targetObj, options, data);\n        }\n        // set the CSS or the SVG property\n        Object.assign(data, getAttributes(transformObj, targetObj), {\n            transformed: transformObj.transformed,\n        });\n    }\n    else {\n        // empty data\n        data = emptyData;\n    }\n    // return data to be used in html\n    return data;\n}\nexport { getData, getPlaceholder };\n//# sourceMappingURL=api.js.map","import { getURI } from './uri';\nfunction getSrcset(fittingType, src, target, options, data) {\n    const dpr = target.pixelAspectRatio || 1;\n    return {\n        dpr: [\n            `${dpr === 1\n                ? data.uri\n                : getURI(fittingType, src, {\n                    ...target,\n                    pixelAspectRatio: 1,\n                }, options)} 1x`,\n            `${dpr === 2\n                ? data.uri\n                : getURI(fittingType, src, {\n                    ...target,\n                    pixelAspectRatio: 2,\n                }, options)} 2x`,\n        ],\n    };\n}\nexport { getSrcset };\n//# sourceMappingURL=srcset.js.map","import { htmlTag } from '../helpers/imageServiceConstants';\nimport { get as backgroundAttributes } from './attributes/backgroundAttributes';\nimport { get as imgAttributes } from './attributes/imgAttributes';\nimport { get as SVGAttributes } from './attributes/SVGAttributes';\n/**\n * get CSS or SVG attributes to be used in the browser\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformTarget}    target\n *\n * @returns object\n */\nfunction getAttributes(transformsObj, target) {\n    let attributesGetter;\n    if (target.htmlTag === htmlTag.BG) {\n        attributesGetter = backgroundAttributes;\n    }\n    else if (target.htmlTag === htmlTag.SVG) {\n        attributesGetter = SVGAttributes;\n    }\n    else {\n        attributesGetter = imgAttributes;\n    }\n    return attributesGetter(transformsObj, target);\n}\nexport { getAttributes };\n//# sourceMappingURL=attributes.js.map","import { fittingTypes, alignTypes, htmlTag, upscaleMethods, } from '../../helpers/imageServiceConstants';\nimport { isValidRequest } from '../../helpers/imageServiceUtils';\nimport { populateGlobalFeatureSupport } from '../../helpers/populateFeatureSupport';\nimport { getTarget, getTransform } from '../transform';\nimport { getURI } from '../uri';\n/**\n * returns image transform uri\n *\n * @param {FittingType}             fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   [options]           transform options\n *\n * @returns {{uri: string}}\n */\nfunction getData(fittingType, src, target, options) {\n    // check if valid request\n    if (isValidRequest(fittingType, src, target)) {\n        // handle site BG legacy fitting types\n        const targetObj = getTarget(fittingType, src, target);\n        // parse request and create working OBJ\n        const transformObj = getTransform(fittingType, src, targetObj, options);\n        return {\n            uri: getURI(fittingType, src, targetObj, options || {}, transformObj),\n        };\n    }\n    return { uri: '' };\n}\nexport { populateGlobalFeatureSupport, getData, fittingTypes, alignTypes, htmlTag, upscaleMethods, };\n//# sourceMappingURL=index.js.map","import { getData, populateGlobalFeatureSupport } from '../api/uri/index';\nimport { fittingTypes, htmlTag, alignTypes, } from '../helpers/imageServiceConstants';\nconst wixStatic = 'https://static.wixstatic.com/';\nconst wixStaticWithMedia = 'https://static.wixstatic.com/media/';\nconst HAS_MEDIA_PREFIX_RE = /^media\\//i;\nconst devicePixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio : 1;\nconst getWixStaticURL = (uri) =&gt; HAS_MEDIA_PREFIX_RE.test(uri)\n    ? `${wixStatic}${uri}`\n    : `${wixStaticWithMedia}${uri}`;\nconst getURL = (uri, options) =&gt; {\n    const baseHostURL = options &amp;&amp; options.baseHostURL;\n    return baseHostURL ? `${baseHostURL}${uri}` : getWixStaticURL(uri);\n};\nfunction getScaleToFitImageURL(relativeUrl, sourceWidth, sourceHeight, targetWidth, targetHeight, options) {\n    const data = getData(fittingTypes.SCALE_TO_FIT, {\n        id: relativeUrl,\n        width: sourceWidth,\n        height: sourceHeight,\n        name: options &amp;&amp; options.name,\n    }, {\n        width: targetWidth,\n        height: targetHeight,\n        htmlTag: htmlTag.IMG,\n        alignment: alignTypes.CENTER,\n        pixelAspectRatio: options?.devicePixelRatio ?? devicePixelRatio,\n    }, options);\n    return getURL(data.uri, options);\n}\nfunction getScaleToFillImageURL(relativeUrl, sourceWidth, sourceHeight, targetWidth, targetHeight, options) {\n    const data = getData(fittingTypes.SCALE_TO_FILL, {\n        id: relativeUrl,\n        width: sourceWidth,\n        height: sourceHeight,\n        name: options &amp;&amp; options.name,\n        focalPoint: {\n            x: options &amp;&amp; options.focalPoint &amp;&amp; options.focalPoint.x,\n            y: options &amp;&amp; options.focalPoint &amp;&amp; options.focalPoint.y,\n        },\n    }, {\n        width: targetWidth,\n        height: targetHeight,\n        htmlTag: htmlTag.IMG,\n        alignment: alignTypes.CENTER,\n        pixelAspectRatio: options?.devicePixelRatio ?? devicePixelRatio,\n    }, options);\n    return getURL(data.uri, options);\n}\nfunction getCropImageURL(relativeUrl, sourceWidth, sourceHeight, cropX, cropY, cropWidth, cropHeight, targetWidth, targetHeight, options) {\n    const data = getData(fittingTypes.SCALE_TO_FILL, {\n        id: relativeUrl,\n        width: sourceWidth,\n        height: sourceHeight,\n        name: options &amp;&amp; options.name,\n        crop: {\n            x: cropX,\n            y: cropY,\n            width: cropWidth,\n            height: cropHeight,\n        },\n    }, {\n        width: targetWidth,\n        height: targetHeight,\n        htmlTag: htmlTag.IMG,\n        alignment: alignTypes.CENTER,\n        pixelAspectRatio: options?.devicePixelRatio ?? devicePixelRatio,\n    }, options);\n    return getURL(data.uri, options);\n}\nexport { populateGlobalFeatureSupport, getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStatic, wixStaticWithMedia, };\n//# sourceMappingURL=api.js.map","import { populateGlobalFeatureSupport, getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStatic, wixStaticWithMedia, } from './api';\npopulateGlobalFeatureSupport();\nexport { getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStatic, wixStaticWithMedia, };\n//# sourceMappingURL=index.js.map","import { getData, STATIC_MEDIA_URL } from '../api/max';\nconst alignTypes = {\n    CENTER: 'center',\n    TOP: 'top',\n    TOP_LEFT: 'top_left',\n    TOP_RIGHT: 'top_right',\n    BOTTOM: 'bottom',\n    BOTTOM_LEFT: 'bottom_left',\n    BOTTOM_RIGHT: 'bottom_right',\n    LEFT: 'left',\n    RIGHT: 'right',\n};\nconst getCropDataWithAlign = (targetAspectRatio, originalAspectRatio, originalHeight, originalWidth, targetHeight, lowerWidth, bpWidth, alignType = alignTypes.CENTER) =&gt; {\n    if (targetAspectRatio &gt; originalAspectRatio) {\n        // Image needs vertical cropping\n        const width = originalWidth;\n        const height = Math.round(originalWidth / (lowerWidth / targetHeight));\n        let y = Math.round(originalHeight / 2 - height / 2);\n        const x = 0;\n        if (alignType.includes('top')) {\n            y = 0;\n        }\n        else if (alignType.includes('bottom')) {\n            y = originalHeight - height;\n        }\n        return { width, height, x, y };\n    }\n    else {\n        // Image needs horizontal cropping\n        const width = Math.round(originalHeight / (targetHeight / bpWidth));\n        const height = originalHeight;\n        let x = Math.round(originalWidth / 2 - width / 2);\n        const y = 0;\n        if (alignType.includes('left')) {\n            x = 0;\n        }\n        else if (alignType.includes('right')) {\n            x = originalWidth - width;\n        }\n        return { width, height, x, y };\n    }\n};\nconst WIDTHS = [1920, 1536, 1366, 1280, 980];\nconst getSources = (widthProportion, originalWidth, originalHeight, targetHeight, targetWidth, uri, quality, name, alignType, hasAnimation, upscaleMethod, focalPoint, crop, encoding, siteMargin, displayMode) =&gt; {\n    const hasOriginalSizeDisplayMode = displayMode === 'original_size';\n    const originalAspectRatio = originalWidth / originalHeight;\n    return WIDTHS.map((width, index) =&gt; {\n        const isLowestBreakpoint = width === 980;\n        const getWidth = (w) =&gt; {\n            if (isLowestBreakpoint) {\n                return targetWidth;\n            }\n            return (w - 2 * (siteMargin || 0)) * (widthProportion / 100);\n        };\n        const lowerBpWidth = getWidth(WIDTHS[index + 1]);\n        const currentBpWidth = getWidth(width);\n        const targetAspectRatio = lowerBpWidth / targetHeight;\n        const useManualCrop = !(hasOriginalSizeDisplayMode || isLowestBreakpoint);\n        const manualCrop = useManualCrop &amp;&amp;\n            getCropDataWithAlign(targetAspectRatio, originalAspectRatio, originalHeight, originalWidth, targetHeight, lowerBpWidth, currentBpWidth, alignType);\n        const { srcset, fallbackSrc, css } = getResponsiveImageProps({\n            displayMode: hasOriginalSizeDisplayMode\n                ? 'original_size'\n                : isLowestBreakpoint\n                    ? 'fill'\n                    : 'fit',\n            uri,\n            width: originalWidth,\n            height: originalHeight,\n            crop: crop || manualCrop,\n            name,\n            focalPoint,\n            alignType,\n            quality,\n            upscaleMethod,\n            hasAnimation,\n            encoding,\n        }, currentBpWidth, targetHeight);\n        if (hasOriginalSizeDisplayMode &amp;&amp; css) {\n            css.img.objectFit = 'cover';\n        }\n        return {\n            srcset: srcset || '',\n            sizes: isLowestBreakpoint\n                ? `${widthProportion}vw`\n                : `${currentBpWidth}px`,\n            media: `(max-width: ${width}px)`,\n            fallbackSrc,\n            imgStyle: css?.img,\n        };\n    });\n};\nexport const getResponsiveImageProps = (imageProps, targetWidth, targetHeight) =&gt; {\n    const { displayMode, uri, width, height, name, crop, focalPoint, alignType, quality, upscaleMethod, hasAnimation, allowAnimatedTransform, encoding, siteMargin, widthProportion, } = imageProps;\n    if (!widthProportion) {\n        const { srcset, css, uri: src, } = getData(displayMode, { id: uri, width, height, name, crop, focalPoint }, {\n            width: targetWidth,\n            height: targetHeight,\n            alignment: alignType,\n        }, {\n            focalPoint,\n            name,\n            quality: quality?.quality,\n            upscaleMethod,\n            hasAnimation,\n            allowAnimatedTransform,\n            useSrcset: true,\n            encoding,\n        });\n        const srcsetWithPrefix = srcset?.dpr?.map((s) =&gt; /^[a-z]+:/.test(s) ? s : `${STATIC_MEDIA_URL}${s}`);\n        const fallbackSrc = `${STATIC_MEDIA_URL}${src}`;\n        const srcsetString = srcsetWithPrefix?.join(', ') || '';\n        return {\n            fallbackSrc,\n            srcset: srcsetString,\n            css,\n        };\n    }\n    else {\n        const sources = getSources(widthProportion, width, height, targetHeight, targetWidth, uri, quality, name, alignType, hasAnimation, upscaleMethod, focalPoint, crop, encoding, siteMargin, displayMode)\n            .filter(Boolean)\n            .reverse();\n        return {\n            fallbackSrc: sources[0].fallbackSrc,\n            sources,\n            css: sources[0].imgStyle,\n        };\n    }\n};\n//# sourceMappingURL=responsiveImageUtils.js.map","import { alignTypes, fittingTypes, htmlTag, upscaleMethods, fileType, } from '../../helpers/imageServiceConstants';\nimport { isWEBP, getFileExtension } from '../../helpers/imageServiceUtils';\nimport { populateGlobalFeatureSupport } from '../../helpers/populateFeatureSupport';\nimport { getData, getPlaceholder } from './api';\nimport { getScaleToFitImageURL, getScaleToFillImageURL, getCropImageURL, wixStaticWithMedia, } from '../../sdk';\nimport { getResponsiveImageProps } from '../../helpers/responsiveImageUtils';\npopulateGlobalFeatureSupport();\nconst sdk = {\n    getScaleToFitImageURL,\n    getScaleToFillImageURL,\n    getCropImageURL,\n};\nexport * from '../../types';\nconst STATIC_MEDIA_URL = wixStaticWithMedia;\nexport { STATIC_MEDIA_URL, alignTypes, fittingTypes, getData, getPlaceholder, htmlTag, populateGlobalFeatureSupport, sdk, upscaleMethods, isWEBP, getFileExtension, fileType, getResponsiveImageProps, };\n//# sourceMappingURL=index.js.map","import { initCustomElementsDropdownMenu } from '@wix/custom-elements'\n\ninitCustomElementsDropdownMenu()\n","// @ts-nocheck\nimport { initWixIframe, initWixVideo, initWixBgImage } from '@wix/custom-elements'\nimport { prefersReducedMotion } from '@wix/thunderbolt-environment'\n\nexport const initLazyCustomElements = (contextWindow?: any = window) =&gt; {\n\tconst { mediaServices, environmentConsts, requestUrl, staticVideoUrl } = contextWindow.customElementNamespace\n\n\tinitWixVideo(contextWindow, mediaServices, {\n\t\t...environmentConsts,\n\t\tprefersReducedMotion: prefersReducedMotion(window, requestUrl),\n\t\tstaticVideoUrl,\n\t})\n\n\tinitWixIframe(contextWindow)\n\tinitWixBgImage(contextWindow, mediaServices, environmentConsts)\n}\n","import { initLazyCustomElements } from './wixLazyCustomElementRegistry'\n\ninitLazyCustomElements()\n// since initCustomElements script is loaded before lazyCustomElementWrapper,\n// imageClientApi is already loaded at this point\nwindow.resolveExternalsRegistryModule('imageClientApi')\n","export const checkForFit = (heights: Array&lt;number&gt;, finalColHeight: number, numOfCols: number) =&gt; {\n\tlet col = 1\n\tlet colTotal = 0\n\n\tfor (let i = 0; i &lt; heights.length; i++) {\n\t\tconst currentItemHeight = heights[i]\n\t\tif (currentItemHeight &gt; finalColHeight) {\n\t\t\treturn false\n\t\t}\n\t\tcolTotal += currentItemHeight\n\t\tif (colTotal &gt; finalColHeight) {\n\t\t\tcol++\n\t\t\tcolTotal = currentItemHeight // start a new column filled with the currentItem\n\n\t\t\tif (col &gt; numOfCols) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true\n}\n\nexport const findMinHeight = (items: Array&lt;{ height: number }&gt;, rowGap: number, numOfCols: number) =&gt; {\n\tlet maxItemHeight = -Infinity\n\tconst heights = items.map((size) =&gt; {\n\t\tif (size.height + rowGap &gt; maxItemHeight) {\n\t\t\tmaxItemHeight = size.height + rowGap\n\t\t}\n\t\treturn size.height + rowGap\n\t})\n\tlet lower = maxItemHeight\n\tlet higher = maxItemHeight * items.length\n\tlet finalHeight = maxItemHeight\n\twhile (lower &lt; higher) {\n\t\tconst middle = Math.floor((lower + higher) / 2)\n\t\tif (checkForFit(heights, middle, numOfCols)) {\n\t\t\thigher = middle\n\t\t} else {\n\t\t\tlower = middle + 1\n\t\t}\n\t\tfinalHeight = lower\n\t}\n\treturn finalHeight - rowGap\n}\n","import fastdom from 'fastdom'\nimport { findMinHeight } from './utils'\n\nfunction multiColumnLayouterWrapper() {\n\tclass MultiColumnLayouter extends HTMLElement {\n\t\tcontainerWidthObserver?: ResizeObserver\n\t\tmutationObserver?: MutationObserver\n\t\tisActiveObserver?: ResizeObserver\n\t\tchildResizeObserver?: ResizeObserver\n\t\tcontainerWidth: number = 0\n\t\tisActive: boolean = false\n\t\tisDuringCalc: boolean = false\n\n\t\tsetContainerHeight(height: number) {\n\t\t\tthis.style.setProperty('--flex-columns-height', `${height}px`)\n\t\t}\n\t\tremoveContainerHeight() {\n\t\t\tthis.style.removeProperty('--flex-columns-height')\n\t\t}\n\n\t\t// TODO cache computed style to recalculate only when inactive -&gt; active\n\t\tgetColumnCount(computedStyle: CSSStyleDeclaration): number {\n\t\t\tconst val = computedStyle.getPropertyValue('--flex-column-count')\n\t\t\treturn parseInt(val, 10)\n\t\t}\n\n\t\tgetRowGap(computedStyle: CSSStyleDeclaration): number {\n\t\t\tconst val = computedStyle.getPropertyValue('row-gap')\n\t\t\treturn parseInt(val || '0', 10)\n\t\t}\n\n\t\tactivate() {\n\t\t\tthis.isActive = true\n\t\t\tthis.attachObservers()\n\t\t\tthis.recalcHeight()\n\t\t}\n\n\t\tdeactivate() {\n\t\t\tthis.isActive = false\n\t\t\tthis.detachHeightCalcObservers()\n\t\t\tthis.removeContainerHeight()\n\t\t}\n\n\t\tcalcActive(): boolean {\n\t\t\tconst cs = getComputedStyle(this)\n\t\t\treturn cs.getPropertyValue('--container-layout-type') === 'multi-column-layout'\n\t\t}\n\n\t\tattachObservers = () =&gt; {\n\t\t\tthis.mutationObserver?.observe(this, { childList: true, subtree: true })\n\t\t\tthis.containerWidthObserver?.observe(this)\n\t\t\tArray.from(this.children).forEach((child) =&gt; {\n\t\t\t\tthis.handleItemAdded(child)\n\t\t\t})\n\t\t}\n\n\t\tdetachHeightCalcObservers = () =&gt; {\n\t\t\tthis.mutationObserver?.disconnect()\n\t\t\tthis.containerWidthObserver?.disconnect()\n\t\t\tthis.childResizeObserver?.disconnect()\n\t\t}\n\n\t\tget itemsHeights(): Array&lt;{ height: number }&gt; {\n\t\t\treturn Array.from(this.children).map((child) =&gt; {\n\t\t\t\tconst computedStyle = getComputedStyle(child)\n\t\t\t\tlet height = parseFloat(computedStyle.height || '0')\n\t\t\t\theight += parseFloat(computedStyle.marginTop || '0')\n\t\t\t\theight += parseFloat(computedStyle.marginBottom || '0')\n\t\t\t\treturn { height }\n\t\t\t})\n\t\t}\n\n\t\trecalcHeight = () =&gt; {\n\t\t\tif (!this.isActive) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tfastdom.measure(() =&gt; {\n\t\t\t\tif (!this.isActive || this.isDuringCalc) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.isDuringCalc = true\n\n\t\t\t\tconst cs = getComputedStyle(this)\n\t\t\t\tconst bestHeight = findMinHeight(this.itemsHeights, this.getRowGap(cs), this.getColumnCount(cs))\n\t\t\t\tthis.isDuringCalc = false\n\t\t\t\tfastdom.mutate(() =&gt; {\n\t\t\t\t\tthis.setContainerHeight(bestHeight)\n\t\t\t\t\tthis.style.setProperty('visibility', null)\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\tsetIsActive() {\n\t\t\tconst shouldBeActive = this.calcActive()\n\t\t\tif (this.isActive !== shouldBeActive) {\n\t\t\t\tif (shouldBeActive) {\n\t\t\t\t\tthis.activate()\n\t\t\t\t} else {\n\t\t\t\t\tthis.deactivate()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconnectedCallback() {\n\t\t\tthis.cleanUp()\n\t\t\tthis.createObservers()\n\t\t\tthis.setIsActive()\n\t\t\tif (window.document.body) {\n\t\t\t\tthis.isActiveObserver?.observe(window.document.body)\n\t\t\t}\n\t\t}\n\n\t\tcleanUp = () =&gt; {\n\t\t\tthis.detachHeightCalcObservers()\n\t\t\tthis.removeContainerHeight()\n\t\t\tthis.isActiveObserver?.disconnect()\n\t\t}\n\n\t\thandleItemAdded = (node: Node) =&gt; {\n\t\t\tif (node instanceof window.HTMLElement) {\n\t\t\t\tthis.childResizeObserver?.observe(node)\n\t\t\t}\n\t\t}\n\t\thandleItemRemoved = (node: Node) =&gt; {\n\t\t\tif (node instanceof window.HTMLElement) {\n\t\t\t\tthis.childResizeObserver?.unobserve(node)\n\t\t\t}\n\t\t}\n\n\t\tcreateObservers = () =&gt; {\n\t\t\tthis.containerWidthObserver = new ResizeObserver((entries) =&gt; {\n\t\t\t\tconst container = entries[0]\n\t\t\t\tif (container.contentRect.width !== this.containerWidth) {\n\t\t\t\t\tif (this.containerWidth === 0) {\n\t\t\t\t\t\tthis.containerWidth = container.contentRect.width\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tthis.containerWidth = container.contentRect.width\n\t\t\t\t\tthis.recalcHeight()\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tthis.mutationObserver = new MutationObserver((entries) =&gt; {\n\t\t\t\tentries.forEach((mutation) =&gt; {\n\t\t\t\t\tArray.from(mutation.removedNodes).forEach(this.handleItemRemoved)\n\t\t\t\t\tArray.from(mutation.addedNodes).forEach(this.handleItemAdded)\n\t\t\t\t})\n\t\t\t\tthis.recalcHeight()\n\t\t\t})\n\n\t\t\tthis.childResizeObserver = new ResizeObserver(() =&gt; {\n\t\t\t\tthis.recalcHeight()\n\t\t\t})\n\n\t\t\tthis.isActiveObserver = new ResizeObserver(() =&gt; {\n\t\t\t\tthis.setIsActive()\n\t\t\t})\n\t\t}\n\t\tdisconnectedCallback() {\n\t\t\tthis.cleanUp()\n\t\t}\n\t}\n\treturn MultiColumnLayouter\n}\n\nexport { multiColumnLayouterWrapper }\n","import { defineCustomElement } from '../commons'\nimport { multiColumnLayouterWrapper } from './multiColumnLayouter'\n\nexport const multiColumnLayouterElementName = 'multi-column-layouter'\n\nexport const initMultiColumnLayouter = (contextWindow = globalThis.window) =&gt; {\n\tif (!contextWindow) {\n\t\treturn\n\t}\n\tif (contextWindow.customElements.get(multiColumnLayouterElementName) === undefined) {\n\t\tconst MultiColRepeater = multiColumnLayouterWrapper()\n\t\tdefineCustomElement(contextWindow, multiColumnLayouterElementName, MultiColRepeater)\n\t}\n}\n","// @ts-nocheck\n\nexport const initResizeService = () =&gt; {\n\tconst resizeService = {\n\t\tobservedElementToRelayoutTarget: new Map(),\n\t\tgetLayoutTargets(elements) {\n\t\t\tconst elementsNeedRelayout = new Set()\n\t\t\telements.forEach((e) =&gt; elementsNeedRelayout.add(resizeService.observedElementToRelayoutTarget.get(e)))\n\n\t\t\treturn elementsNeedRelayout\n\t\t},\n\t\tobserve: (element) =&gt; {\n\t\t\tresizeService.observedElementToRelayoutTarget.set(element, element)\n\t\t\tresizeObserver.observe(element)\n\t\t},\n\t\tunobserve: (element) =&gt; {\n\t\t\tresizeService.observedElementToRelayoutTarget.delete(element)\n\t\t\tresizeObserver.unobserve(element)\n\t\t},\n\t\tobserveChild: (childElement, rootElement) =&gt; {\n\t\t\tresizeService.observedElementToRelayoutTarget.set(childElement, rootElement)\n\t\t\tresizeObserver.observe(childElement)\n\t\t},\n\t\tunobserveChild: (childElement) =&gt; {\n\t\t\tresizeService.observedElementToRelayoutTarget.delete(childElement)\n\t\t\tresizeObserver.unobserve(childElement)\n\t\t},\n\t}\n\n\tconst resizeObserver = new window.ResizeObserver((entries) =&gt; {\n\t\tconst rootElements = resizeService.getLayoutTargets(entries.map((entry) =&gt; entry.target))\n\n\t\trootElements.forEach((e) =&gt; e.reLayout())\n\t})\n\n\treturn resizeService\n}\n","// @ts-nocheck\n\nconst get = (obj, props, defVal) =&gt; {\n\tconst path = Array.isArray(props) ? props : props.split('.')\n\tconst val = path.reduce((subObj, prop) =&gt; (subObj &amp;&amp; subObj[prop] !== undefined ? subObj[prop] : null), obj)\n\treturn val !== null ? val : defVal\n}\n\nconst pick = (obj, props) =&gt; {\n\tconst propsArr = Array.isArray(props) ? props : [props]\n\treturn propsArr.reduce((subObj, prop) =&gt; {\n\t\tconst val = get(obj, prop)\n\t\treturn val !== undefined ? Object.assign(subObj, { [prop]: val }) : subObj\n\t}, {})\n}\n\nconst findKey = (obj, predicate) =&gt; Object.keys(obj).find((key) =&gt; predicate(obj[key], key))\n\n/**\n * Return a unique Array from the input `arr` keeping the last item for each key\n * returned by `predicate(item)`\n *\n * @param {Array} arr\n * @param {function} predicate\n * @returns {Array}\n */\nconst unique = (arr, predicate) =&gt; {\n\tconst result = arr.reduce((acc, item) =&gt; {\n\t\tacc[predicate(item)] = item\n\t\treturn acc\n\t}, {})\n\n\treturn Object.values(result)\n}\n\nconst cssStringToObject = (styleStr) =&gt; {\n\tif (!styleStr || !styleStr.split) {\n\t\treturn {}\n\t}\n\n\treturn styleStr.split(';').reduce(function (ruleMap, ruleString) {\n\t\tconst rulePair = ruleString.split(':')\n\t\tif (rulePair[0] &amp;&amp; rulePair[1]) {\n\t\t\truleMap[rulePair[0].trim()] = rulePair[1].trim()\n\t\t}\n\n\t\treturn ruleMap\n\t}, {})\n}\n\n/**\n * @param {Function} callback\n * @returns {Function}\n */\nconst throttleToAnimationFrame = (callback, contextWindow = window) =&gt; {\n\tlet throttled = false\n\n\treturn (...args) =&gt; {\n\t\tif (!throttled) {\n\t\t\tthrottled = true\n\n\t\t\tcontextWindow.requestAnimationFrame(() =&gt; {\n\t\t\t\tthrottled = false\n\t\t\t\tcallback(...args)\n\t\t\t})\n\t\t}\n\t}\n}\n\n/**\n * Join strings to a valid URL.\n *\n * {@see santa-core/santa-core-utils/src/coreUtils/core/urlUtils.js}\n * @param {...string[]} args\n * @return {string}\n */\nfunction joinURL(...args) {\n\tlet url = args[0]\n\n\tfor (let i = 1; i &lt; args.length; ++i) {\n\t\turl = `${url.replace(/\\/$/, '')}/${args[i].replace(/^\\//, '')}`\n\t}\n\n\treturn url\n}\n\nexport { get, pick, findKey, unique, cssStringToObject, throttleToAnimationFrame, joinURL }\n","// @ts-nocheck\n\nimport { fittingTypes, alignTypes, getData } from '@wix/image-kit'\n\nconst getImageComputedProperties = (imageInfo, envConsts, htmlTag) =&gt; {\n\tconst { targetWidth, targetHeight, imageData, filters, displayMode = fittingTypes.SCALE_TO_FILL } = imageInfo\n\n\t// todo: CLNT-5323 , wixapp sildergallery proxy is generating image data without uri\n\tif (!targetWidth || !targetHeight || !imageData.uri) {\n\t\treturn { uri: '', css: {} }\n\t}\n\n\tconst {\n\t\twidth,\n\t\theight,\n\t\tcrop,\n\t\tname,\n\t\tfocalPoint,\n\t\tupscaleMethod,\n\t\tquality,\n\t\tdevicePixelRatio = envConsts.devicePixelRatio,\n\t} = imageData\n\tconst imageOptions = {\n\t\tfilters,\n\t\tupscaleMethod,\n\t\t...quality,\n\t\thasAnimation: imageInfo?.hasAnimation || imageData?.hasAnimation,\n\t}\n\n\tconst pixelAspectRatio = getDevicePixelRatio(devicePixelRatio)\n\n\tconst src = {\n\t\tid: imageData.uri,\n\t\twidth,\n\t\theight,\n\t\t...(crop &amp;&amp; { crop }),\n\t\t...(focalPoint &amp;&amp; { focalPoint }),\n\t\t...(name &amp;&amp; { name }),\n\t}\n\n\tconst target = {\n\t\twidth: targetWidth,\n\t\theight: targetHeight,\n\t\thtmlTag: htmlTag || 'img',\n\t\tpixelAspectRatio,\n\t\talignment: imageInfo.alignType || alignTypes.CENTER,\n\t}\n\n\tconst imageComputedProperties = getData(displayMode, src, target, imageOptions)\n\timageComputedProperties.uri = getMediaUrlByContext(\n\t\timageComputedProperties.uri,\n\t\tenvConsts.staticMediaUrl,\n\t\tenvConsts.mediaRootUrl\n\t)\n\treturn imageComputedProperties\n}\n\nconst getMediaUrlByContext = (imageUri, staticMediaUrl, mediaRootUrl) =&gt; {\n\tconst isExternalUrl = /(^https?)|(^data)|(^blob)|(^\\/\\/)/.test(imageUri)\n\tif (isExternalUrl) {\n\t\treturn imageUri\n\t}\n\tlet path = `${staticMediaUrl}/`\n\tif (imageUri) {\n\t\tif (/^micons\\//.test(imageUri)) {\n\t\t\tpath = mediaRootUrl\n\t\t} else if (/[^.]+$/.exec(imageUri)[0] === 'ico') {\n\t\t\t// if the image is an icon then it's taken from a slightly different place\n\t\t\tpath = path.replace('media', 'ficons')\n\t\t}\n\t}\n\treturn path + imageUri\n}\n\nconst getDevicePixelRatio = (devicePixelRatio) =&gt; {\n\t// we should be able to force devicePixelRatio from url by using the query param -\n\tconst queryParams = window.location.search.split('&amp;').map((query) =&gt; query.split('='))\n\tconst devicePixelRatioQueryParam = queryParams.find((query) =&gt; query[0].toLowerCase().includes('devicepixelratio'))\n\tconst devicePixelRatioValueForceFromUrl = devicePixelRatioQueryParam ? Number(devicePixelRatioQueryParam[1]) : null\n\treturn devicePixelRatioValueForceFromUrl || devicePixelRatio || 1\n}\n\nconst getImageSrc = (imageNode, isSvgImage) =&gt; imageNode.getAttribute(isSvgImage ? 'xlink:href' : 'src')\n\nfunction getMaskBBox(svgNode) {\n\tif (svgNode) {\n\t\tconst { type } = svgNode.dataset\n\n\t\tif (type &amp;&amp; type !== 'ugc') {\n\t\t\tconst dataBBox = svgNode.dataset.bbox\n\n\t\t\tif (!dataBBox) {\n\t\t\t\tconst { x, y, width, height } = svgNode.getBBox()\n\n\t\t\t\treturn `${x} ${y} ${width} ${height}`\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null\n}\n\n// todo: temp experiments for measuring purposes, should be removed after test results\nfunction shouldStopImageLoad(services) {\n\treturn (\n\t\tservices.isExperimentOpen('specs.thunderbolt.tb_stop_client_images') ||\n\t\tservices.isExperimentOpen('specs.thunderbolt.final_force_webp') ||\n\t\tservices.isExperimentOpen('specs.thunderbolt.final_force_no_webp')\n\t)\n}\n\nexport { shouldStopImageLoad, getImageComputedProperties, getImageSrc, getMaskBBox }\n","// @ts-nocheck\n\nconst CSS_NUMERIC_VALUES = { columnCount: 1, columns: 1, fontWeight: 1, lineHeight: 1, opacity: 1, zIndex: 1, zoom: 1 }\n\nconst addDefaultUnitIfNeeded = (prop, value) =&gt;\n\ttypeof value === 'number' &amp;&amp; !CSS_NUMERIC_VALUES[prop] ? `${value}px` : value\n\nconst setAttributes = (node, attributes) =&gt;\n\tnode &amp;&amp; attributes &amp;&amp; Object.keys(attributes).forEach((attr) =&gt; node.setAttribute(attr, attributes[attr]))\n\nconst setStyle = (node, styleProperties) =&gt;\n\tnode &amp;&amp;\n\tstyleProperties &amp;&amp;\n\tObject.keys(styleProperties).forEach((prop) =&gt; {\n\t\tconst propValue = styleProperties[prop]\n\t\tif (propValue !== undefined) {\n\t\t\tnode.style[prop] = addDefaultUnitIfNeeded(prop, propValue)\n\t\t} else {\n\t\t\tnode.style.removeProperty(prop)\n\t\t}\n\t})\n\nconst setCssVars = (node, cssVars) =&gt;\n\tnode &amp;&amp;\n\tcssVars &amp;&amp;\n\tObject.keys(cssVars).forEach((prop) =&gt; {\n\t\tnode.style.setProperty(prop, cssVars[prop])\n\t})\n\n// 'true'  =&gt; true\n// 'false' =&gt; false\n// 'null'  =&gt; null\n// '42'    =&gt; 42\n// '42.5'  =&gt; 42.5\n// '08'    =&gt; '08'\n// String  =&gt; self\nconst deserializeValue = (value) =&gt; {\n\tif (!value) {\n\t\treturn value\n\t}\n\n\tif (value === 'true') {\n\t\treturn true\n\t}\n\n\tif (value === 'false') {\n\t\treturn false\n\t}\n\n\tif (value === 'null') {\n\t\treturn null\n\t}\n\n\tif (`${+value}` === value) {\n\t\treturn +value\n\t}\n\n\treturn value\n}\n\nconst getData = (node, key, shouldDeserializeVal = true) =&gt;\n\tnode &amp;&amp; shouldDeserializeVal ? deserializeValue(node.dataset[key]) : node.dataset[key]\n\nconst setData = (node, datasetOverrides) =&gt; node &amp;&amp; datasetOverrides &amp;&amp; Object.assign(node.dataset, datasetOverrides)\n\nconst getScreenHeight = (getterOverride?: number) =&gt; {\n\treturn getterOverride || document.documentElement.clientHeight || window.innerHeight || 0\n}\n\nconst getDocumentScrollPosition = () =&gt; (window ? window.pageYOffset || document.documentElement.scrollTop : 0)\n\nconst fittingTypeToObjectFit = {\n\tfit: 'contain',\n\tfill: 'cover',\n}\n\nexport {\n\tsetAttributes,\n\tsetStyle,\n\tsetCssVars,\n\tgetData,\n\tsetData,\n\tgetScreenHeight,\n\tgetDocumentScrollPosition,\n\tfittingTypeToObjectFit,\n}\n","// @ts-nocheck\n\nimport { getImageComputedProperties, setStyle, getScreenHeight } from '../utils/customElementsCommonUtils'\n\nfunction didImageChange(currentImageUrlCss = '', newUrl) {\n\treturn !currentImageUrlCss.includes(newUrl) || !!currentImageUrlCss !== !!newUrl\n}\n\nconst init = (contextWindow = window) =&gt; {\n\tfunction setBackground(domNode, imageTransformData) {\n\t\tconst elementStyleAndUrl = {\n\t\t\tbackgroundImage: `url(\"${imageTransformData.uri}\")`,\n\t\t\t...imageTransformData.css.container,\n\t\t}\n\t\tconst image = new contextWindow.Image()\n\n\t\timage.onload = setStyle.bind(null, domNode, elementStyleAndUrl)\n\t\timage.src = imageTransformData.uri\n\t}\n\n\tfunction measure(id, measures, domNodes, { containerId, bgEffectName }, services) {\n\t\tconst bgImage = domNodes[id]\n\t\tconst container = domNodes[containerId]\n\t\tconst { width, height } = services.getMediaDimensionsByEffect(\n\t\t\tbgEffectName,\n\t\t\tcontainer.offsetWidth,\n\t\t\tcontainer.offsetHeight,\n\t\t\tgetScreenHeight(services.getScreenHeightOverride?.())\n\t\t)\n\n\t\tmeasures.width = width\n\t\tmeasures.height = height\n\t\tmeasures.currentSrc = bgImage.style.backgroundImage\n\t\tmeasures.bgEffectName = bgImage.dataset.bgEffectName\n\t}\n\n\tfunction patch(id, measures, domNodes, imageInfo, envConsts) {\n\t\tconst bgImage = domNodes[id]\n\t\timageInfo.targetWidth = measures.width\n\t\timageInfo.targetHeight = measures.height\n\n\t\tconst imageTransformData = getImageComputedProperties(imageInfo, envConsts, 'bg')\n\n\t\tif (didImageChange(measures.currentSrc, imageTransformData.uri)) {\n\t\t\tsetBackground(bgImage, imageTransformData)\n\t\t} else {\n\t\t\tsetStyle(bgImage, imageTransformData.css.container)\n\t\t}\n\t}\n\n\treturn {\n\t\tmeasure,\n\t\tpatch,\n\t}\n}\n\nexport { init }\n","// @ts-nocheck\nexport const defineCustomElement = (contextWindow, elementName, elementClass) =&gt; {\n\tif (contextWindow.customElements.get(elementName) === undefined) {\n\t\tcontextWindow.customElements.define(elementName, elementClass)\n\t}\n}\n","// @ts-nocheck\n\nfunction wixElementWrapper(services, contextWindow = window): any {\n\tclass WixElement extends contextWindow.HTMLElement {\n\t\tconstructor() {\n\t\t\tsuper()\n\t\t}\n\n\t\treLayout() {\n\t\t\t// should be implemented inside child element\n\t\t}\n\n\t\tconnectedCallback() {\n\t\t\tthis.observeResize()\n\t\t\tthis.reLayout()\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.unobserveResize()\n\t\t\tthis.unobserveChildren()\n\t\t}\n\n\t\tobserveResize() {\n\t\t\tservices.resizeService.observe(this)\n\t\t}\n\n\t\tunobserveResize() {\n\t\t\tservices.resizeService.unobserve(this)\n\t\t}\n\n\t\t/** 01\n\t\t * Observe DOM mutations to wait for addition of missing children\n\t\t *\n\t\t * @param {HTMLElement} el\n\t\t */\n\t\tobserveChildren(el) {\n\t\t\tif (!this.childListObserver) {\n\t\t\t\tthis.childListObserver = new contextWindow.MutationObserver(() =&gt; this.reLayout())\n\t\t\t}\n\n\t\t\tthis.childListObserver.observe(el, { childList: true })\n\t\t}\n\n\t\tobserveChildAttributes(el, attributes = []) {\n\t\t\tif (!this.childrenAttributesObservers) {\n\t\t\t\tthis.childrenAttributesObservers = []\n\t\t\t}\n\t\t\tconst attributesObserver = new contextWindow.MutationObserver(() =&gt; this.reLayout())\n\t\t\tattributesObserver.observe(el, { attributeFilter: attributes })\n\t\t\tthis.childrenAttributesObservers.push(attributesObserver)\n\t\t}\n\n\t\tobserveChildResize(child) {\n\t\t\tif (!this.childrenResizeObservers) {\n\t\t\t\tthis.childrenResizeObservers = []\n\t\t\t}\n\t\t\tservices.resizeService.observeChild(child, this)\n\t\t\tthis.childrenResizeObservers.push(child)\n\t\t}\n\n\t\tunobserveChildrenResize() {\n\t\t\tif (this.childrenResizeObservers) {\n\t\t\t\tthis.childrenResizeObservers.forEach((child) =&gt; {\n\t\t\t\t\tservices.resizeService.unobserveChild(child)\n\t\t\t\t})\n\t\t\t\tthis.childrenResizeObservers = null\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Remove DOM MutationObserver if one was created\n\t\t */\n\t\tunobserveChildren() {\n\t\t\tif (this.childListObserver) {\n\t\t\t\tthis.childListObserver.disconnect()\n\t\t\t\tthis.childListObserver = null\n\t\t\t}\n\t\t\tif (this.childrenAttributesObservers) {\n\t\t\t\tfor (let observer of this.childrenAttributesObservers) {\n\t\t\t\t\tobserver.disconnect()\n\t\t\t\t\tobserver = null\n\t\t\t\t}\n\t\t\t\tthis.childrenAttributesObservers = null\n\t\t\t}\n\n\t\t\tthis.unobserveChildrenResize()\n\t\t}\n\t}\n\n\treturn WixElement\n}\n\nexport { wixElementWrapper }\n","// @ts-nocheck\n\nimport { initResizeService } from '../utils/initResizeService'\nimport { wixElementWrapper } from './wixElement'\n\nconst initWixElement = (contextWindow) =&gt; {\n\tif (!contextWindow.customElementNamespace) {\n\t\tcontextWindow.customElementNamespace = {}\n\t}\n\tif (contextWindow.customElementNamespace.WixElement === undefined) {\n\t\tconst resizeService = initResizeService()\n\t\tconst WixElement = wixElementWrapper({ resizeService }, contextWindow)\n\t\tcontextWindow.customElementNamespace.WixElement = WixElement\n\t\treturn WixElement\n\t}\n\treturn contextWindow.customElementNamespace.WixElement\n}\n\nexport { initWixElement }\n","import { wixBgImageWrapper } from './wixBgImage'\nimport { defineCustomElement } from '../commons'\nimport { initWixElement } from '../wixElements'\n\nexport const wixBgImageElementName = 'wix-bg-image'\n\nexport const initWixBgImage = (\n\tcontextWindow = globalThis.window,\n\texternalServices = {},\n\tenvironmentConsts = {\n\t\texperiments: {},\n\t}\n) =&gt; {\n\tif (!contextWindow) {\n\t\treturn\n\t}\n\tif (contextWindow.customElements.get(wixBgImageElementName) === undefined) {\n\t\tconst WixElement = initWixElement(contextWindow)\n\t\tconst WixBgImage = wixBgImageWrapper(WixElement, externalServices, environmentConsts, contextWindow)\n\t\tdefineCustomElement(contextWindow, wixBgImageElementName, WixBgImage)\n\t}\n}\n","// @ts-nocheck\n\nimport { init as initBgImageLayout } from './bgImageLayout'\nimport { shouldStopImageLoad } from '../utils/customElementsCommonUtils'\n\nfunction wixBgImageWrapper(WixElement, services, environmentConsts, contextWindow = window): any {\n\tconst bgImageLayout = initBgImageLayout(contextWindow)\n\n\tclass WixBgImage extends WixElement {\n\t\tconstructor() {\n\t\t\tsuper()\n\t\t}\n\n\t\treLayout() {\n\t\t\t// todo: temp experiment for measuring purposes, should be removed after test results\n\t\t\tif (shouldStopImageLoad(services)) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst domNodes = {}\n\t\t\tconst measures = {}\n\n\t\t\tconst imageId = this.getAttribute('id')\n\t\t\tconst imageInfo = JSON.parse(this.dataset.tiledImageInfo)\n\t\t\tconst { bgEffectName } = this.dataset\n\t\t\tconst { containerId } = imageInfo\n\t\t\tconst container = contextWindow.document.getElementById(containerId)\n\n\t\t\tdomNodes[imageId] = this\n\t\t\tdomNodes[containerId] = container\n\t\t\timageInfo.displayMode = imageInfo.imageData.displayMode\n\n\t\t\tservices.mutationService.measure(() =&gt; {\n\t\t\t\tbgImageLayout.measure(imageId, measures, domNodes, { containerId, bgEffectName }, services)\n\t\t\t})\n\n\t\t\tservices.mutationService.mutate(() =&gt; {\n\t\t\t\tbgImageLayout.patch(imageId, measures, domNodes, imageInfo, environmentConsts, services)\n\t\t\t})\n\t\t}\n\n\t\tattributeChangedCallback(name, oldValue) {\n\t\t\tif (oldValue) {\n\t\t\t\tthis.reLayout()\n\t\t\t}\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tsuper.disconnectedCallback()\n\t\t}\n\n\t\tstatic get observedAttributes() {\n\t\t\treturn ['data-tiled-image-info']\n\t\t}\n\t}\n\n\treturn WixBgImage\n}\n\nexport { wixBgImageWrapper }\n","// @ts-nocheck\n\nimport { setStyle, getScreenHeight, setCssVars } from '../utils/customElementsCommonUtils'\n\nfunction wixBgMediaWrapper(WixElement, services, contextWindow = window): any {\n\tconst stylesToClear = {\n\t\twidth: undefined,\n\t\theight: undefined,\n\t\tleft: undefined,\n\t\t// top: undefined // TODO: for responsive bg scrub\n\t}\n\tclass WixBgMedia extends WixElement {\n\t\tconstructor() {\n\t\t\tsuper()\n\t\t}\n\n\t\treLayout() {\n\t\t\tconst { containerId, pageId, useCssVars, bgEffectName } = this.dataset\n\t\t\t// Find the container that rendered the bgMedia\n\t\t\tconst container: HTMLElement =\n\t\t\t\tthis.closest(`#${containerId}`) || contextWindow.document.getElementById(`${containerId}`)\n\n\t\t\t// Find the page element (if it exists of the component)\n\t\t\tconst page: HTMLElement | undefined =\n\t\t\t\tthis.closest(`#${pageId}`) || contextWindow.document.getElementById(`${pageId}`)\n\t\t\tconst measures = {}\n\n\t\t\tservices.mutationService.measure(() =&gt; {\n\t\t\t\t// !! note isFixedStyle in edit mode is false although hasParallax is true\n\t\t\t\t// todo: remove window.getComputedStyle and use data-is-full-height (TB backlog)\n\t\t\t\tconst isFixedStyle = contextWindow.getComputedStyle(this).position === 'fixed'\n\t\t\t\tconst screenHeight = getScreenHeight(services.getScreenHeightOverride?.())\n\t\t\t\tconst containerRect = container.getBoundingClientRect()\n\t\t\t\tconst dimensionsByEffect = services.getMediaDimensionsByEffect(\n\t\t\t\t\tbgEffectName,\n\t\t\t\t\tcontainerRect.width,\n\t\t\t\t\tcontainerRect.height,\n\t\t\t\t\tscreenHeight\n\t\t\t\t)\n\t\t\t\tconst { hasParallax } = dimensionsByEffect\n\t\t\t\tconst hasPageTransition =\n\t\t\t\t\tpage &amp;&amp; (contextWindow.getComputedStyle(page).transition || '').includes('transform')\n\t\t\t\tconst { width: calculatedWith, height: calculatedHeight } = dimensionsByEffect\n\t\t\t\tconst width = `${calculatedWith}px`\n\t\t\t\tconst height = `${calculatedHeight}px`\n\n\t\t\t\tlet left = `${(containerRect.width - calculatedWith) / 2}px`\n\n\t\t\t\tif (isFixedStyle) {\n\t\t\t\t\tconst pageLeftPosition = contextWindow.document.documentElement.clientLeft\n\t\t\t\t\tleft = hasPageTransition\n\t\t\t\t\t\t? `${container.offsetLeft - pageLeftPosition}px`\n\t\t\t\t\t\t: `${containerRect.left - pageLeftPosition}px`\n\t\t\t\t}\n\n\t\t\t\tconst top = isFixedStyle || hasParallax ? 0 : `${(containerRect.height - calculatedHeight) / 2}px` // will be 0 if no effect\n\n\t\t\t\tconst dimensions = !useCssVars\n\t\t\t\t\t? { width, height, left, top }\n\t\t\t\t\t: {\n\t\t\t\t\t\t'--containerW': width,\n\t\t\t\t\t\t'--containerH': height,\n\t\t\t\t\t\t'--containerL': left,\n\t\t\t\t\t\t// '--containerT': top, // TODO: for responsive bg scrub\n\t\t\t\t\t\t'--screenH_val': `${screenHeight}`,\n\t\t\t\t\t}\n\t\t\t\tObject.assign(measures, dimensions)\n\t\t\t})\n\n\t\t\tservices.mutationService.mutate(() =&gt; {\n\t\t\t\tif (useCssVars) {\n\t\t\t\t\tsetStyle(this, stylesToClear)\n\t\t\t\t\tsetCssVars(this, measures)\n\t\t\t\t} else {\n\t\t\t\t\tsetStyle(this, measures)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tconnectedCallback() {\n\t\t\tsuper.connectedCallback()\n\n\t\t\tservices.windowResizeService.observe(this)\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tsuper.disconnectedCallback()\n\n\t\t\tservices.windowResizeService.unobserve(this)\n\t\t}\n\n\t\tattributeChangedCallback(name, oldValue) {\n\t\t\tif (oldValue) {\n\t\t\t\tthis.reLayout()\n\t\t\t}\n\t\t}\n\n\t\tstatic get observedAttributes() {\n\t\t\treturn ['data-is-full-height', 'data-container-size']\n\t\t}\n\t}\n\n\treturn WixBgMedia\n}\n\nexport { wixBgMediaWrapper }\n","import { defineCustomElement } from '../commons'\nimport { initWixElement } from '../wixElements'\nimport { wixBgMediaWrapper } from './wixBgMedia'\n\nexport const wixBgMediaElementName = 'wix-bg-media'\n\nexport const initWixBgMedia = (contextWindow = globalThis.window, externalServices = {}) =&gt; {\n\tif (!contextWindow) {\n\t\treturn\n\t}\n\tif (contextWindow.customElements.get(wixBgMediaElementName) === undefined) {\n\t\tconst WixElement = initWixElement(contextWindow)\n\t\tconst WixBgMedia = wixBgMediaWrapper(WixElement, externalServices, contextWindow)\n\t\tdefineCustomElement(contextWindow, wixBgMediaElementName, WixBgMedia)\n\t}\n}\n","// @ts-nocheck\n\nimport { getData, setData } from '../utils/domUtils'\nimport { setStyle, setAttributes } from '../utils/customElementsCommonUtils'\nimport { findKey } from '../utils/utils'\n\nconst MORE_BUTTON_SUFFIX = '__more__'\nconst MORE_CONTAINER_PREFIX = 'moreContainer'\n\nconst init = (contextWindow = window) =&gt; {\n\tconst getDropDownWidthIfOk = (\n\t\tmenuWidth,\n\t\tsameWidth,\n\t\tstretch,\n\t\twidths,\n\t\tmenuWidthToReduce,\n\t\tmaxWidth,\n\t\tremoveMarginFromAllChildren,\n\t\textraPixels\n\t) =&gt; {\n\t\tmenuWidth -= menuWidthToReduce * (removeMarginFromAllChildren ? widths.length : widths.length - 1)\n\t\tmenuWidth -= extraPixels.left + extraPixels.right\n\t\tif (sameWidth) {\n\t\t\t// width same width, all widths should be as the max width (calculated for the whole items in the calling method)\n\t\t\twidths = widths.map(() =&gt; maxWidth)\n\t\t}\n\n\t\t// not first measure - want sizes without 0\n\t\tif (widths.some((v) =&gt; v === 0)) {\n\t\t\treturn null\n\t\t}\n\t\tlet totalMenuItemsWidths = 0\n\t\tconst total = widths.reduce((a, b) =&gt; a + b, 0)\n\t\tif (total &gt; menuWidth) {\n\t\t\t// drop down should have less items\n\t\t\treturn null\n\t\t}\n\n\t\t// calculate the width of the items\n\t\tif (sameWidth) {\n\t\t\tif (stretch) {\n\t\t\t\tconst width = Math.floor(menuWidth / widths.length)\n\t\t\t\tconst stretchedAndSameItemWidths = widths.map(() =&gt; width)\n\t\t\t\ttotalMenuItemsWidths = width * widths.length\n\t\t\t\tif (totalMenuItemsWidths &lt; menuWidth) {\n\t\t\t\t\tconst totalRemnant = Math.floor(menuWidth - totalMenuItemsWidths)\n\t\t\t\t\twidths.forEach((wdth, index) =&gt; {\n\t\t\t\t\t\tif (index &lt;= totalRemnant - 1) {\n\t\t\t\t\t\t\tstretchedAndSameItemWidths[index]++\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn stretchedAndSameItemWidths\n\t\t\t}\n\t\t\treturn widths\n\t\t}\n\n\t\t// not same width\n\t\tif (stretch) {\n\t\t\tconst toAdd = Math.floor((menuWidth - total) / widths.length)\n\t\t\ttotalMenuItemsWidths = 0\n\t\t\tconst stretchItemsWidths = widths.map((itemWidth) =&gt; {\n\t\t\t\ttotalMenuItemsWidths += itemWidth + toAdd\n\t\t\t\treturn itemWidth + toAdd\n\t\t\t})\n\t\t\tif (totalMenuItemsWidths &lt; menuWidth) {\n\t\t\t\tconst remnant = Math.floor(menuWidth - totalMenuItemsWidths)\n\t\t\t\twidths.forEach((wdth, index) =&gt; {\n\t\t\t\t\tif (index &lt;= remnant - 1) {\n\t\t\t\t\t\tstretchItemsWidths[index]++\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn stretchItemsWidths\n\t\t}\n\n\t\treturn widths\n\t}\n\n\tconst getMaxWidth = (widths) =&gt; widths.reduce((a, b) =&gt; (a &gt; b ? a : b), -Infinity)\n\n\tconst checkForMarginMenu = (itemsContainer) =&gt; {\n\t\tconst menuItem = itemsContainer.lastChild\n\t\tconst itemCss = contextWindow.getComputedStyle(menuItem)\n\t\tconst marginLeft = parseInt(itemCss.marginLeft, 10) || 0\n\t\tconst marginRight = parseInt(itemCss.marginRight, 10) || 0\n\n\t\treturn marginLeft + marginRight\n\t}\n\n\tconst roundScaleMeasurement = (value) =&gt; Math.round(value)\n\n\tconst checkValidNumber = (num) =&gt; {\n\t\tconst number = parseFloat(num)\n\t\treturn isFinite(number) ? number : 0\n\t}\n\n\tconst getDivExtraPixels = (itemsContainer, includeMargin) =&gt; {\n\t\tconst itemsContainerCss = contextWindow.getComputedStyle(itemsContainer)\n\n\t\tlet top = checkValidNumber(itemsContainerCss.borderTopWidth) + checkValidNumber(itemsContainerCss.paddingTop)\n\t\tlet bottom =\n\t\t\tcheckValidNumber(itemsContainerCss.borderBottomWidth) + checkValidNumber(itemsContainerCss.paddingBottom)\n\t\tlet left = checkValidNumber(itemsContainerCss.borderLeftWidth) + checkValidNumber(itemsContainerCss.paddingLeft)\n\t\tlet right =\n\t\t\tcheckValidNumber(itemsContainerCss.borderRightWidth) + checkValidNumber(itemsContainerCss.paddingRight)\n\t\tif (includeMargin) {\n\t\t\ttop += checkValidNumber(itemsContainerCss.marginTop)\n\t\t\tbottom += checkValidNumber(itemsContainerCss.marginBottom)\n\t\t\tleft += checkValidNumber(itemsContainerCss.marginLeft)\n\t\t\tright += checkValidNumber(itemsContainerCss.marginRight)\n\t\t}\n\t\treturn { top, bottom, left, right, height: top + bottom, width: left + right }\n\t}\n\n\tconst getViewportHeight = () =&gt; contextWindow.innerHeight\n\n\tconst needToOpenDropDownUp = (menuCompDom) =&gt; {\n\t\tconst menuClientRect = menuCompDom.getBoundingClientRect()\n\t\tconst topRelativeToWindow = menuClientRect.top\n\t\treturn topRelativeToWindow &gt; getViewportHeight() / 2\n\t}\n\n\tconst getLabelWidth = (labelNode, siteScale) =&gt;\n\t\troundScaleMeasurement(labelNode.getBoundingClientRect().width / siteScale)\n\n\tconst calculateLineHeight = (menuHeight, measures) =&gt; {\n\t\tconst lineHeight =\n\t\t\tmenuHeight -\n\t\t\tmeasures.menuBorderY -\n\t\t\tmeasures.labelPad -\n\t\t\tmeasures.ribbonEls -\n\t\t\tmeasures.menuButtonBorder -\n\t\t\tmeasures.ribbonExtra\n\n\t\treturn `${lineHeight}px`\n\t}\n\n\tconst getMenuItemsToPresent = (id, measures, menuProperties, domNodes, menuItemsIdsWithMore) =&gt; {\n\t\tconst menuWidth = measures.width\n\n\t\tmeasures.hasOriginalGapData = {}\n\t\tmeasures.originalGapBetweenTextAndBtn = {}\n\t\tconst widths = menuItemsIdsWithMore.map((itemId) =&gt; {\n\t\t\tconst menuItem = domNodes[id + itemId]\n\t\t\tlet gapBetweenTextAndBtn\n\t\t\tconst originalGap = getData(menuItem, 'originalGapBetweenTextAndBtn')\n\t\t\tif (originalGap === undefined) {\n\t\t\t\tmeasures.hasOriginalGapData[itemId] = false\n\t\t\t\tgapBetweenTextAndBtn =\n\t\t\t\t\tmeasures.children[id + itemId].boundingClientRectWidth - measures.labelWidths[`${id + itemId}label`]\n\t\t\t\tmeasures.originalGapBetweenTextAndBtn[id + itemId] = gapBetweenTextAndBtn\n\t\t\t} else {\n\t\t\t\tmeasures.hasOriginalGapData[itemId] = true\n\t\t\t\tgapBetweenTextAndBtn = parseFloat(originalGap)\n\t\t\t}\n\t\t\tif (measures.children[id + itemId].width &gt; 0) {\n\t\t\t\treturn Math.floor(measures.labelWidths[`${id + itemId}label`] + gapBetweenTextAndBtn)\n\t\t\t}\n\t\t\treturn 0\n\t\t})\n\t\tconst moreWidth = widths.pop()\n\t\tconst sameWidth = menuProperties.sameWidthButtons\n\t\tconst stretch = menuProperties.stretchButtonsToMenuWidth\n\t\tlet moreShown = false\n\t\tconst menuWidthToReduce = measures.menuItemContainerMargins\n\t\tconst removeMarginFromAllChildren = measures.menuItemMarginForAllChildren\n\t\tconst extraPixels = measures.menuItemContainerExtraPixels\n\t\t// check if it the menu can fit without \"more\"\n\t\tconst maxWidth = getMaxWidth(widths)\n\t\tlet realWidths = getDropDownWidthIfOk(\n\t\t\tmenuWidth,\n\t\t\tsameWidth,\n\t\t\tstretch,\n\t\t\twidths,\n\t\t\tmenuWidthToReduce,\n\t\t\tmaxWidth,\n\t\t\tremoveMarginFromAllChildren,\n\t\t\textraPixels\n\t\t)\n\t\tif (!realWidths) {\n\t\t\t// find the menu with most items that work\n\t\t\tfor (let i = 1; i &lt;= widths.length; i++) {\n\t\t\t\trealWidths = getDropDownWidthIfOk(\n\t\t\t\t\tmenuWidth,\n\t\t\t\t\tsameWidth,\n\t\t\t\t\tstretch,\n\t\t\t\t\twidths.slice(0, -1 * i).concat(moreWidth),\n\t\t\t\t\tmenuWidthToReduce,\n\t\t\t\t\tmaxWidth,\n\t\t\t\t\tremoveMarginFromAllChildren,\n\t\t\t\t\textraPixels\n\t\t\t\t)\n\t\t\t\tif (realWidths) {\n\t\t\t\t\tmoreShown = true\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!realWidths) {\n\t\t\t\t// found a case where the menu text was bigger then menu - more get the menu width\n\t\t\t\tmoreShown = true\n\t\t\t\trealWidths = [moreWidth]\n\t\t\t}\n\t\t}\n\t\tif (moreShown) {\n\t\t\tconst widthMore = realWidths[realWidths.length - 1]\n\t\t\trealWidths = realWidths.slice(0, -1)\n\t\t\twhile (realWidths.length &lt; menuItemsIdsWithMore.length) {\n\t\t\t\trealWidths.push(0)\n\t\t\t}\n\t\t\trealWidths[realWidths.length - 1] = widthMore\n\t\t}\n\t\treturn {\n\t\t\trealWidths,\n\t\t\tmoreShown,\n\t\t}\n\t}\n\n\tconst measureChildrenDimensions = (id, domNodes, childrenIdsToMeasure, siteScale) =&gt; {\n\t\tconst childrenMeasures = {}\n\n\t\tchildrenIdsToMeasure.forEach((childId) =&gt; {\n\t\t\tconst nodeId = `${id}${childId}`\n\t\t\tconst domNode = domNodes[nodeId]\n\t\t\tif (domNode) {\n\t\t\t\tchildrenMeasures[nodeId] = {\n\t\t\t\t\twidth: domNode.offsetWidth,\n\t\t\t\t\tboundingClientRectWidth: roundScaleMeasurement(domNode.getBoundingClientRect().width / siteScale),\n\t\t\t\t\theight: domNode.offsetHeight,\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\treturn childrenMeasures\n\t}\n\n\tconst getDataIDs = (rootNode) =&gt; {\n\t\tconst numItems = +getData(rootNode, 'numItems')\n\t\tif (numItems &lt;= 0 || numItems &gt; Number.MAX_SAFE_INTEGER) {\n\t\t\treturn []\n\t\t}\n\n\t\treturn new Array(numItems).fill(0).map((num, i) =&gt; String(i))\n\t}\n\n\tconst getChildrenIdsToMeasure = (menuItemIds) =&gt;\n\t\t['moreContainer', 'itemsContainer', 'dropWrapper'].concat(menuItemIds, [MORE_BUTTON_SUFFIX])\n\n\tconst measure = (id: string, menuElement: HTMLElement) =&gt; {\n\t\tconst measures = {}\n\t\tconst domNodes = {}\n\t\tdomNodes[id] = menuElement\n\n\t\tlet siteScale = 1\n\t\tconst siteRootElement = menuElement.getRootNode().querySelector&lt;HTMLDivElement&gt;('[id^=site-root]')\n\t\tif (siteRootElement) {\n\t\t\tsiteScale = siteRootElement.getBoundingClientRect().width / siteRootElement.offsetWidth\n\t\t}\n\n\t\tconst menuItemIds = getDataIDs(domNodes[id])\n\t\tconst childrenIdsToMeasure = getChildrenIdsToMeasure(menuItemIds)\n\t\tchildrenIdsToMeasure.forEach((childId) =&gt; {\n\t\t\tconst domNodeId = `${id}${childId}`\n\t\t\tdomNodes[domNodeId] = menuElement.getRootNode().getElementById(`${domNodeId}`)\n\t\t})\n\t\tmeasures.children = measureChildrenDimensions(id, domNodes, childrenIdsToMeasure, siteScale)\n\t\tconst menuRoot = domNodes[id]\n\t\tconst itemsContainer = domNodes[`${id}itemsContainer`]\n\t\tconst menuItems = itemsContainer.childNodes\n\t\tconst moreContainer = domNodes[`${id}moreContainer`]\n\t\tconst moreChildNodes = moreContainer.childNodes\n\n\t\tconst stretchButtonsToMenuWidth = getData(menuRoot, 'stretchButtonsToMenuWidth')\n\t\tconst sameWidthButtons = getData(menuRoot, 'sameWidthButtons')\n\n\t\t/* add skin params to measure map */\n\n\t\tconst boundingClientRect = menuRoot.getBoundingClientRect()\n\t\tmeasures.absoluteLeft = boundingClientRect.left\n\t\tmeasures.bodyClientWidth = contextWindow.document.body.clientWidth\n\n\t\tmeasures.alignButtons = getData(menuRoot, 'dropalign')\n\t\tmeasures.hoverListPosition = getData(menuRoot, 'drophposition')\n\t\tmeasures.menuBorderY = parseInt(getData(menuRoot, 'menuborderY'), 10)\n\t\tmeasures.ribbonExtra = parseInt(getData(menuRoot, 'ribbonExtra'), 10)\n\t\tmeasures.ribbonEls = parseInt(getData(menuRoot, 'ribbonEls'), 10)\n\t\tmeasures.labelPad = parseInt(getData(menuRoot, 'labelPad'), 10)\n\t\tmeasures.menuButtonBorder = parseInt(getData(menuRoot, 'menubtnBorder'), 10)\n\t\tmeasures.menuItemContainerMargins = checkForMarginMenu(itemsContainer)\n\t\tmeasures.menuItemContainerExtraPixels = getDivExtraPixels(itemsContainer, true)\n\t\tmeasures.needToOpenMenuUp = needToOpenDropDownUp(menuRoot)\n\t\tmeasures.menuItemMarginForAllChildren =\n\t\t\t!stretchButtonsToMenuWidth || itemsContainer.getAttribute('data-marginAllChildren') !== 'false'\n\t\tmeasures.moreSubItem = []\n\t\tmeasures.labelWidths = {}\n\t\tmeasures.linkIds = {}\n\t\tmeasures.parentId = {}\n\t\tmeasures.menuItems = {}\n\t\tmeasures.labels = {}\n\n\t\tmoreChildNodes.forEach((moreChild, i) =&gt; {\n\t\t\tmeasures.parentId[moreChild.id] = getData(moreChild, 'parentId')\n\t\t\tconst dataId = getData(moreChild, 'dataId')\n\n\t\t\tmeasures.menuItems[dataId] = {\n\t\t\t\tdataId,\n\t\t\t\tparentId: getData(moreChild, 'parentId'),\n\t\t\t\tmoreDOMid: moreChild.id,\n\t\t\t\tmoreIndex: i,\n\t\t\t}\n\n\t\t\tdomNodes[moreChild.id] = moreChild\n\t\t\tconst labelNode = moreChild.querySelector('p')\n\t\t\tdomNodes[labelNode.id] = labelNode\n\t\t\tmeasures.labels[labelNode.id] = {\n\t\t\t\twidth: labelNode.offsetWidth,\n\t\t\t\theight: labelNode.offsetHeight,\n\t\t\t\tleft: labelNode.offsetLeft,\n\t\t\t\tlineHeight: parseInt(contextWindow.getComputedStyle(labelNode).fontSize, 10),\n\t\t\t}\n\t\t\tmeasures.moreSubItem.push(moreChild.id)\n\t\t})\n\n\t\t/* add menu items left to measure map + add the labels to nodes map */\n\t\tmenuItems.forEach((menuItem, i) =&gt; {\n\t\t\tconst dataId = getData(menuItem, 'dataId')\n\n\t\t\tmeasures.menuItems[dataId] = measures.menuItems[dataId] || {}\n\t\t\tmeasures.menuItems[dataId].menuIndex = i\n\t\t\tmeasures.menuItems[dataId].menuDOMid = menuItem.id\n\t\t\tmeasures.children[menuItem.id].left = menuItem.offsetLeft\n\n\t\t\tconst labelNode = menuItem.querySelector('p')\n\t\t\tdomNodes[labelNode.id] = labelNode\n\t\t\tmeasures.labelWidths[labelNode.id] = getLabelWidth(labelNode, siteScale)\n\t\t\tconst linkElementNode = menuItem.querySelector('p')\n\t\t\tdomNodes[linkElementNode.id] = linkElementNode\n\t\t\tmeasures.linkIds[menuItem.id] = linkElementNode.id\n\t\t})\n\n\t\tconst menuHeight = menuRoot.offsetHeight\n\t\tmeasures.height = menuHeight\n\t\tmeasures.width = menuRoot.offsetWidth\n\t\tmeasures.lineHeight = calculateLineHeight(menuHeight, measures)\n\n\t\tconst arrayWidths = getMenuItemsToPresent(\n\t\t\tid,\n\t\t\tmeasures,\n\t\t\t{\n\t\t\t\tsameWidthButtons,\n\t\t\t\tstretchButtonsToMenuWidth,\n\t\t\t},\n\t\t\tdomNodes,\n\t\t\tmenuItemIds.concat(MORE_BUTTON_SUFFIX)\n\t\t)\n\n\t\tmeasures.realWidths = arrayWidths.realWidths\n\t\tmeasures.isMoreShown = arrayWidths.moreShown\n\t\tmeasures.menuItemIds = menuItemIds\n\t\tmeasures.hoverState = getData(moreContainer, 'hover', false)\n\n\t\treturn { measures, domNodes }\n\t}\n\n\tconst setDropModeData = (node, isUp) =&gt; setData(node, { dropmode: isUp ? 'dropUp' : 'dropDown' })\n\n\tconst getLabelLineHeight = (moreItemLineHeight, measures) =&gt;\n\t\tmoreItemLineHeight + 15 + measures.menuBorderY + measures.labelPad + measures.menuButtonBorder\n\n\tconst getMenuPosition = (\n\t\tmenuExtraPixels,\n\t\talignButtons,\n\t\tmoreContainerWidth,\n\t\tmenuWidth,\n\t\thoveredListPosition,\n\t\thoveredItem,\n\t\tmenuLeft,\n\t\tmenuRight,\n\t\tclientWidth,\n\t\tdropWrapperWidth\n\t) =&gt; {\n\t\tlet moreContainerLeft = '0px'\n\t\tlet moreContainerRight = 'auto'\n\t\tconst hoveredNodeLeftOffset = hoveredItem.left\n\t\tconst hoveredNodeWidthOffset = hoveredItem.width\n\t\tif (alignButtons === 'left') {\n\t\t\tif (hoveredListPosition === 'left') {\n\t\t\t\tmoreContainerLeft = 0\n\t\t\t} else {\n\t\t\t\tmoreContainerLeft = `${hoveredNodeLeftOffset + menuExtraPixels.left}px`\n\t\t\t}\n\t\t} else if (alignButtons === 'right') {\n\t\t\tif (hoveredListPosition === 'right') {\n\t\t\t\tmoreContainerRight = 0\n\t\t\t} else {\n\t\t\t\tmoreContainerRight = `${\n\t\t\t\t\tmenuWidth - hoveredNodeLeftOffset - hoveredNodeWidthOffset - menuExtraPixels.right\n\t\t\t\t}px`\n\t\t\t}\n\t\t\tmoreContainerLeft = 'auto'\n\t\t} else if (hoveredListPosition === 'left') {\n\t\t\t// center\n\t\t\tmoreContainerLeft = `${\n\t\t\t\thoveredNodeLeftOffset + (hoveredNodeWidthOffset + menuExtraPixels.left - moreContainerWidth) / 2\n\t\t\t}px`\n\t\t} else if (hoveredListPosition === 'right') {\n\t\t\tmoreContainerLeft = 'auto'\n\t\t\tmoreContainerRight = `${\n\t\t\t\t(hoveredNodeWidthOffset + menuExtraPixels.right - (moreContainerWidth + menuExtraPixels.width)) / 2\n\t\t\t}px`\n\t\t} else {\n\t\t\tmoreContainerLeft = `${\n\t\t\t\tmenuExtraPixels.left +\n\t\t\t\thoveredNodeLeftOffset +\n\t\t\t\t(hoveredNodeWidthOffset - (moreContainerWidth + menuExtraPixels.width)) / 2\n\t\t\t}px`\n\t\t}\n\n\t\tif (moreContainerLeft !== 'auto') {\n\t\t\tconst subMenuLeft = menuLeft + parseInt(moreContainerLeft, 10)\n\t\t\tconst isMoreContainerExceedClientWidth = subMenuLeft + dropWrapperWidth &gt; clientWidth\n\n\t\t\tif (isMoreContainerExceedClientWidth) {\n\t\t\t\tmoreContainerLeft = 'auto'\n\t\t\t\tmoreContainerRight = 0\n\t\t\t} else {\n\t\t\t\tmoreContainerLeft = subMenuLeft &lt; 0 ? 0 : moreContainerLeft\n\t\t\t}\n\t\t}\n\n\t\tif (moreContainerRight !== 'auto') {\n\t\t\tconst subMenuRight = menuRight - parseInt(moreContainerRight, 10)\n\t\t\tmoreContainerRight = subMenuRight &gt; clientWidth ? 0 : moreContainerRight\n\t\t}\n\n\t\treturn { moreContainerLeft, moreContainerRight }\n\t}\n\n\tconst decideOnMenuPosition = (id, measures, hoveredItem, moreContainerWidth, dropWrapperWidth) =&gt; {\n\t\tconst { width, height, alignButtons, hoverListPosition, menuItemContainerExtraPixels } = measures\n\t\tconst menuLeft = measures.absoluteLeft\n\t\tconst menuRight = menuLeft + width\n\t\tconst menuPosition = getMenuPosition(\n\t\t\tmenuItemContainerExtraPixels,\n\t\t\talignButtons,\n\t\t\tmoreContainerWidth,\n\t\t\twidth,\n\t\t\thoverListPosition,\n\t\t\thoveredItem,\n\t\t\tmenuLeft,\n\t\t\tmenuRight,\n\t\t\tmeasures.bodyClientWidth,\n\t\t\tdropWrapperWidth\n\t\t)\n\n\t\treturn {\n\t\t\tleft: menuPosition.moreContainerLeft,\n\t\t\tright: menuPosition.moreContainerRight,\n\t\t\ttop: measures.needToOpenMenuUp ? 'auto' : `${height}px`,\n\t\t\tbottom: measures.needToOpenMenuUp ? `${height}px` : 'auto',\n\t\t}\n\t}\n\n\tconst isNumber = (n) =&gt; !isNaN(parseFloat(n)) &amp;&amp; isFinite(n)\n\n\tconst updateDropDownContainerLocation = (id, measures, domNodes, maxLabelWidth) =&gt; {\n\t\tconst { hoverState } = measures\n\t\tif (hoverState !== '-1') {\n\t\t\tconst { menuItemIds } = measures\n\t\t\tconst subItemsIndex = menuItemIds.indexOf(hoverState)\n\t\t\tif (isNumber(measures.hoverState) || hoverState === MORE_BUTTON_SUFFIX) {\n\t\t\t\tconst measureMapRealWidths = measures.realWidths\n\t\t\t\tif (!measureMapRealWidths) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tconst moreContainerWidth = Math.max(\n\t\t\t\t\tmaxLabelWidth,\n\t\t\t\t\tmeasures.children[subItemsIndex !== -1 ? id + subItemsIndex : id + MORE_BUTTON_SUFFIX].width\n\t\t\t\t) // more container width is the max between text width and the more btn width\n\t\t\t\tconst dropWrapperWidth = Math.max(maxLabelWidth, measures.children[`${id}dropWrapper`].width)\n\t\t\t\tconst moreItemLineHeight =\n\t\t\t\t\tmeasures.moreSubItem.length !== 0\n\t\t\t\t\t\t? measures.labels[`${measures.moreSubItem[0]}label`].lineHeight\n\t\t\t\t\t\t: 0\n\t\t\t\tconst newSubItemsLineHeight = getLabelLineHeight(moreItemLineHeight, measures)\n\n\t\t\t\t/* set css for every menu item in the more container */\n\t\t\t\tmeasures.moreSubItem.forEach((subId) =&gt; {\n\t\t\t\t\tsetStyle(domNodes[subId], { minWidth: `${moreContainerWidth}px` })\n\t\t\t\t\tsetStyle(domNodes[`${subId}label`], { minWidth: '0px', lineHeight: `${newSubItemsLineHeight}px` })\n\t\t\t\t})\n\n\t\t\t\t/* set container position and decide if it's open up.down */\n\t\t\t\tconst hoveredInd = isNumber(measures.hoverState) ? measures.hoverState : '__more__'\n\t\t\t\tconst hoveredItem = {\n\t\t\t\t\twidth: measures.children[id + hoveredInd].width,\n\t\t\t\t\tleft: measures.children[id + hoveredInd].left,\n\t\t\t\t}\n\n\t\t\t\tconst menuPosition = decideOnMenuPosition(\n\t\t\t\t\tid,\n\t\t\t\t\tmeasures,\n\t\t\t\t\thoveredItem,\n\t\t\t\t\tmoreContainerWidth,\n\t\t\t\t\tdropWrapperWidth\n\t\t\t\t)\n\t\t\t\tsetStyle(domNodes[`${id}${MORE_CONTAINER_PREFIX}`], {\n\t\t\t\t\tleft: menuPosition.left,\n\t\t\t\t\tright: menuPosition.right,\n\t\t\t\t})\n\t\t\t\tsetStyle(domNodes[`${id}dropWrapper`], {\n\t\t\t\t\tleft: menuPosition.left,\n\t\t\t\t\tright: menuPosition.right,\n\t\t\t\t\ttop: menuPosition.top,\n\t\t\t\t\tbottom: menuPosition.bottom,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tconst patchDropDownMenuItems = (id, domNodes, measures, menuItemsIdsWithMore) =&gt; {\n\t\tconst { realWidths, height: menuHeight, menuItemContainerExtraPixels: extraPixels } = measures\n\t\t// go over all the items (not the more)\n\t\tlet totalVisible = 0\n\t\tlet lastVisibleMenuId = null\n\t\tlet innerLinkElementId = null\n\t\tconst menuLineHeight = measures.lineHeight\n\t\tconst menuItemHeight = menuHeight - extraPixels.height\n\t\tfor (let i = 0; i &lt; menuItemsIdsWithMore.length; i++) {\n\t\t\tconst activeWidth = realWidths[i]\n\t\t\tconst isVisible = activeWidth &gt; 0\n\t\t\tconst menuIndexOrMoreBecauseOfLegacyImplementation = menuItemsIdsWithMore[i]\n\t\t\tconst menuId = id + menuIndexOrMoreBecauseOfLegacyImplementation\n\t\t\tinnerLinkElementId = measures.linkIds[menuId]\n\t\t\tif (isVisible) {\n\t\t\t\ttotalVisible++\n\t\t\t\tlastVisibleMenuId = menuId\n\t\t\t\tsetStyle(domNodes[menuId], {\n\t\t\t\t\twidth: `${activeWidth}px`,\n\t\t\t\t\theight: `${menuItemHeight}px`,\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t'box-sizing': 'border-box',\n\t\t\t\t\toverflow: 'visible',\n\t\t\t\t\tvisibility: 'inherit',\n\t\t\t\t})\n\t\t\t\tsetStyle(domNodes[`${menuId}label`], {\n\t\t\t\t\t'line-height': menuLineHeight,\n\t\t\t\t})\n\t\t\t\tsetAttributes(domNodes[menuId], {\n\t\t\t\t\t'aria-hidden': false,\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tsetStyle(domNodes[menuId], {\n\t\t\t\t\theight: '0px',\n\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\tvisibility: 'hidden',\n\t\t\t\t})\n\t\t\t\tsetAttributes(domNodes[menuId], {\n\t\t\t\t\t'aria-hidden': true,\n\t\t\t\t})\n\t\t\t\tsetAttributes(domNodes[innerLinkElementId], {\n\t\t\t\t\ttabIndex: -1,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t\tif (totalVisible === 1) {\n\t\t\tsetData(domNodes[`${id}moreContainer`], {\n\t\t\t\tlistposition: 'lonely',\n\t\t\t})\n\t\t\tsetData(domNodes[lastVisibleMenuId], {\n\t\t\t\tlistposition: 'lonely',\n\t\t\t})\n\t\t}\n\t}\n\n\tconst patch = (id, measures, domNodes) =&gt; {\n\t\tconst menuRoot = domNodes[id]\n\n\t\tsetStyle(menuRoot, { overflowX: 'visible' })\n\t\t// measure widths to find out if there should be \"more\" and what would be the real widths\n\t\t// based on the comp properties\n\t\tconst { menuItemIds, needToOpenMenuUp } = measures\n\t\tconst menuItemsIdsWithMore = menuItemIds.concat(MORE_BUTTON_SUFFIX)\n\t\tsetDropModeData(menuRoot, needToOpenMenuUp)\n\t\tlet maxLabelWidth = 0\n\n\t\tif (measures.hoverState === MORE_BUTTON_SUFFIX) {\n\t\t\t// when hover more button - we render all item and hide the ones that already appear on the menu\n\t\t\tconst firstIndexThatIsHidden = measures.realWidths.indexOf(0)\n\t\t\tconst firstItemShownInMore =\n\t\t\t\tmeasures.menuItems[findKey(measures.menuItems, (value) =&gt; value.menuIndex === firstIndexThatIsHidden)]\n\t\t\tconst indexOfFirstItemShownInMore = firstItemShownInMore.moreIndex\n\n\t\t\tconst hasOneItem = indexOfFirstItemShownInMore === menuItemIds.length - 1\n\t\t\tif (firstItemShownInMore.moreDOMid) {\n\t\t\t\tsetAttributes(domNodes[firstItemShownInMore.moreDOMid], {\n\t\t\t\t\t'data-listposition': hasOneItem ? 'dropLonely' : 'top',\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tObject.values(measures.menuItems)\n\t\t\t\t.filter((menuItem) =&gt; !!menuItem.moreDOMid)\n\t\t\t\t.forEach((item) =&gt; {\n\t\t\t\t\tif (item.moreIndex &lt; indexOfFirstItemShownInMore) {\n\t\t\t\t\t\tsetStyle(domNodes[item.moreDOMid], { display: 'none' })\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst moreItemLabelId = `${item.moreDOMid}label`\n\t\t\t\t\t\tmaxLabelWidth = Math.max(measures.labels[moreItemLabelId].width, maxLabelWidth)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t} else if (measures.hoverState) {\n\t\t\tmeasures.moreSubItem.forEach((v, i) =&gt; {\n\t\t\t\tconst subItemLabelId = `${id + MORE_CONTAINER_PREFIX + i}label`\n\t\t\t\tmaxLabelWidth = Math.max(measures.labels[subItemLabelId].width, maxLabelWidth)\n\t\t\t})\n\t\t}\n\t\tupdateDropDownContainerLocation(id, measures, domNodes, maxLabelWidth)\n\n\t\tif (measures.originalGapBetweenTextAndBtn) {\n\t\t\tmenuItemsIdsWithMore.forEach((item) =&gt; {\n\t\t\t\tif (!measures.hasOriginalGapData[item]) {\n\t\t\t\t\tsetData(domNodes[`${id}${item}`], {\n\t\t\t\t\t\toriginalGapBetweenTextAndBtn: measures.originalGapBetweenTextAndBtn[`${id}${item}`],\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t\tpatchDropDownMenuItems(id, domNodes, measures, menuItemsIdsWithMore)\n\t}\n\n\treturn {\n\t\tmeasure,\n\t\tpatch,\n\t}\n}\n\nexport { init }\n","import fastdom from 'fastdom'\nimport { wixDropdownMenuWrapper } from './wixDropdownMenu'\nimport { initResizeService } from '../utils/initResizeService'\nimport { initWixElement } from '../wixElements'\n\nexport const wixDropdownMenuElementName = 'wix-dropdown-menu'\n\nexport const initCustomElementsDropdownMenu = (contextWindow = globalThis.window) =&gt; {\n\tif (!contextWindow) {\n\t\treturn\n\t}\n\tif (contextWindow.customElements.get(wixDropdownMenuElementName) === undefined) {\n\t\tconst resizeService = initResizeService()\n\t\tconst WixElement = initWixElement(contextWindow)\n\n\t\tconst WixDropdownMenu = wixDropdownMenuWrapper(\n\t\t\tWixElement,\n\t\t\t{ resizeService, mutationService: fastdom },\n\t\t\tcontextWindow\n\t\t)\n\t\tcontextWindow.customElements.define(wixDropdownMenuElementName, WixDropdownMenu)\n\t}\n}\n","// @ts-nocheck\n\nimport { init as initDropdownMenuLayout } from './dropdownMenuLayout'\n\nfunction wixDropdownMenuWrapper(WixElement, services, contextWindow = window): any {\n\tconst dropdownMenuLayout = initDropdownMenuLayout(contextWindow)\n\n\tclass WixDropdownMenu extends WixElement {\n\t\tstatic get observedAttributes() {\n\t\t\treturn ['data-hovered-item']\n\t\t}\n\t\t_visible = false\n\t\t_mutationIds = {\n\t\t\tread: null,\n\t\t\twrite: null,\n\t\t}\n\t\t_itemsContainer = null\n\t\t_dropContainer = null\n\t\t_labelItems = []\n\n\t\tattributeChangedCallback() {\n\t\t\tif (this._isVisible()) {\n\t\t\t\tthis.reLayout()\n\t\t\t}\n\t\t}\n\n\t\tconnectedCallback() {\n\t\t\tthis._id = this.getAttribute('id')\n\t\t\tthis._hideElement()\n\t\t\tthis._waitForDomLoad().then(() =&gt; {\n\t\t\t\tsuper.observeResize()\n\t\t\t\tthis._observeChildrenResize()\n\t\t\t\tthis.reLayout()\n\t\t\t})\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tservices.mutationService.clear(this._mutationIds.read)\n\t\t\tservices.mutationService.clear(this._mutationIds.write)\n\n\t\t\tsuper.disconnectedCallback()\n\t\t}\n\n\t\t_waitForDomLoad() {\n\t\t\tlet onReady\n\t\t\tconst loadPromise = new Promise((res) =&gt; {\n\t\t\t\tonReady = res\n\t\t\t})\n\n\t\t\tif (this._isDomReady()) {\n\t\t\t\tonReady()\n\t\t\t} else {\n\t\t\t\tthis._waitForDomReadyObserver = new contextWindow.MutationObserver(() =&gt; this._onRootMutate(onReady))\n\t\t\t\tthis._waitForDomReadyObserver.observe(this, { childList: true, subtree: true })\n\t\t\t}\n\n\t\t\treturn loadPromise\n\t\t}\n\n\t\t_isDomReady() {\n\t\t\tthis._itemsContainer = this.getRootNode().getElementById(`${this._id}itemsContainer`)\n\t\t\tthis._dropContainer = this.getRootNode().getElementById(`${this._id}dropWrapper`)\n\n\t\t\treturn this._itemsContainer &amp;&amp; this._dropContainer\n\t\t}\n\n\t\t_onRootMutate(onReady) {\n\t\t\tif (this._isDomReady()) {\n\t\t\t\tthis._waitForDomReadyObserver.disconnect()\n\t\t\t\tonReady()\n\t\t\t}\n\t\t}\n\n\t\t_observeChildrenResize() {\n\t\t\tconst menuItems = Array.from(this._itemsContainer.childNodes)\n\t\t\tthis._labelItems = menuItems.map((item) =&gt;\n\t\t\t\tthis.getRootNode().getElementById(`${item.getAttribute('id')}label`)\n\t\t\t)\n\n\t\t\tthis._labelItems.forEach((item) =&gt; super.observeChildResize(item))\n\t\t}\n\n\t\t_setVisibility(visible) {\n\t\t\tthis._visible = visible\n\t\t\tthis.style.visibility = visible ? 'inherit' : 'hidden'\n\t\t}\n\n\t\t_isVisible() {\n\t\t\treturn this._visible\n\t\t}\n\n\t\t_hideElement() {\n\t\t\tthis._setVisibility(false)\n\t\t}\n\n\t\t_showElement() {\n\t\t\tthis._setVisibility(true)\n\t\t}\n\n\t\treLayout() {\n\t\t\tlet measures, domNodes\n\n\t\t\tservices.mutationService.clear(this._mutationIds.read)\n\t\t\tservices.mutationService.clear(this._mutationIds.write)\n\n\t\t\tthis._mutationIds.read = services.mutationService.measure(() =&gt; {\n\t\t\t\tconst measureResult = dropdownMenuLayout.measure(this._id, this)\n\t\t\t\tmeasures = measureResult.measures\n\t\t\t\tdomNodes = measureResult.domNodes\n\t\t\t})\n\n\t\t\tthis._mutationIds.write = services.mutationService.mutate(() =&gt; {\n\t\t\t\tdropdownMenuLayout.patch(this._id, measures, domNodes)\n\t\t\t\tthis._showElement()\n\t\t\t})\n\t\t}\n\t}\n\n\treturn WixDropdownMenu\n}\n\nexport { wixDropdownMenuWrapper }\n","import { wixIframeWrapper } from './wixIframe'\nimport { defineCustomElement } from '../commons'\nimport { initWixElement } from '../wixElements'\n\nexport const wixIframeElementName = 'wix-iframe'\n\nexport const initWixIframe = (contextWindow = globalThis.window) =&gt; {\n\tif (!contextWindow) {\n\t\treturn\n\t}\n\tif (contextWindow.customElements.get(wixIframeElementName) === undefined) {\n\t\tconst WixElement = initWixElement(contextWindow)\n\t\tconst WixIframe = wixIframeWrapper(WixElement)\n\t\tdefineCustomElement(contextWindow, wixIframeElementName, WixIframe)\n\t}\n}\n","// @ts-nocheck\nfunction wixIframeWrapper(WixElement): any {\n\tclass WixIframe extends WixElement {\n\t\tconstructor() {\n\t\t\tsuper()\n\t\t}\n\n\t\treLayout() {\n\t\t\t// TODO - add lazy loading if bv_lazyTPAs experiment is merged\n\t\t\t// TODO - handle instance templating from clientSpecMap once we implement static html loading\n\t\t\tconst iframe = this.querySelector('iframe')\n\t\t\tif (iframe) {\n\t\t\t\tconst dataSrc = iframe.dataset.src\n\t\t\t\tif (dataSrc &amp;&amp; iframe.src !== dataSrc) {\n\t\t\t\t\tiframe.src = dataSrc\n\t\t\t\t\tiframe.dataset.src = ''\n\t\t\t\t\tthis.dataset.src = ''\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tattributeChangedCallback(name, oldValue, newValue) {\n\t\t\tif (newValue) {\n\t\t\t\tthis.reLayout()\n\t\t\t}\n\t\t}\n\n\t\tstatic get observedAttributes() {\n\t\t\treturn ['data-src']\n\t\t}\n\t}\n\n\treturn WixIframe\n}\n\nexport { wixIframeWrapper }\n","// @ts-nocheck\n\nimport { joinURL, unique } from '../utils/utils'\nimport { fittingTypeToObjectFit } from '../utils/domUtils'\nimport { setStyle } from '../utils/customElementsCommonUtils'\nimport { fittingTypes } from '@wix/image-kit'\n\nexport default {\n\t/**\n\t * @param {HTMLVideoElement} videoNode\n\t * @param {HTMLDivElement} container\n\t * @param {boolean} hasBgScrollEffect\n\t * @param {number} videoWidth\n\t * @param {number} videoHeight\n\t * @param {string} fittingType\n\t * @param {string} alignType\n\t * @param {Object[]} qualities\n\t * @param {string} staticVideoUrl\n\t * @param {string} videoId\n\t * @param {string} videoFormat\n\t * @param {{x: number, y:number}} focalPoint\n\t * @return {{currentSrc: string, videoStyle: {top: number, left: number, width: number, height: number}, videoSourceUrl: string}}\n\t */\n\tmeasure(\n\t\tvideoNode,\n\t\tcontainer,\n\t\t{\n\t\t\thasBgScrollEffect,\n\t\t\tvideoWidth,\n\t\t\tvideoHeight,\n\t\t\tfittingType,\n\t\t\talignType = 'center',\n\t\t\tqualities,\n\t\t\tstaticVideoUrl,\n\t\t\tvideoId,\n\t\t\tvideoFormat,\n\t\t\tfocalPoint,\n\t\t}\n\t) {\n\t\t// if background has a full-height scroll effect we use the parent width,\n\t\t// the element position is fixed and without explicit width it will take\n\t\t// the viewport's width or the width of an ancestor with a transform (i.e. page in transition)\n\t\tconst width = hasBgScrollEffect ? container.offsetWidth : videoNode.parentElement.offsetWidth\n\t\tconst height = videoNode.parentElement.offsetHeight\n\t\tconst vidWidth = parseInt(videoWidth, 10)\n\t\tconst vidHeight = parseInt(videoHeight, 10)\n\t\tconst scaleFactor = getScaleFactor(width, height, vidWidth, vidHeight)\n\t\tconst videoScaledDimensions = getVideoDimension(fittingType, scaleFactor, vidWidth, vidHeight)\n\t\tconst targetQuality = getVideoQualityBySize(qualities, videoScaledDimensions)\n\n\t\tconst videoSourceUrl = getMP4Url(targetQuality, staticVideoUrl, videoId, videoFormat)\n\t\tconst needsSrcUpdate = shouldUpdateSrc(videoNode, videoSourceUrl)\n\t\tconst objectFit = fittingTypeToObjectFit[fittingType] || 'cover'\n\t\tconst focalPosition = focalPoint\n\t\t\t? convertFillFocalToPosition(videoScaledDimensions, { width, height }, focalPoint)\n\t\t\t: ''\n\t\tconst alignTypeString = alignType.replace('_', ' ')\n\t\treturn {\n\t\t\tvideoSourceUrl,\n\t\t\tneedsSrcUpdate,\n\t\t\tvideoStyle: {\n\t\t\t\theight: '100%',\n\t\t\t\twidth: '100%',\n\t\t\t\tobjectFit,\n\t\t\t\tobjectPosition: focalPosition ? focalPosition : alignTypeString,\n\t\t\t},\n\t\t}\n\t},\n\t/**\n\t * @param {HTMLDivElement} poster\n\t * @param {HTMLCanvasElement|null} canvas\n\t * @param {HTMLVideoElement} videoNode\n\t * @param {Object} videoStyle\n\t * @param {boolean} autoPlay\n\t * @param {string} videoSourceUrl\n\t * @param {boolean} needsSrcUpdate\n\t * @param {string} animatePoster\n\t * @param {string} videoFormat\n\t * @param {number} playbackRate\n\t * @param {boolean} isEditorMode\n\t */\n\tmutate(\n\t\tposter,\n\t\tcanvas,\n\t\tvideoNode,\n\t\tvideoStyle,\n\t\tautoPlay,\n\t\tvideoSourceUrl,\n\t\tneedsSrcUpdate,\n\t\tanimatePoster,\n\t\tvideoFormat,\n\t\tplaybackRate,\n\t\tisEditorMode\n\t) {\n\t\tif (autoPlay) {\n\t\t\tvideoNode.setAttribute('autoplay', '')\n\t\t} else {\n\t\t\tvideoNode.removeAttribute('autoplay')\n\t\t}\n\t\tif (canvas) {\n\t\t\t// currently returns width/height as 100% which canvas already has in component style\n\t\t\tconst { width: _, height: __, ...styleWithoutDims } = videoStyle\n\t\t\tsetStyle(canvas, styleWithoutDims)\n\t\t} else {\n\t\t\thandlePosterVisibility(needsSrcUpdate, videoNode, poster, animatePoster, autoPlay, isEditorMode)\n\t\t\tsetStyle(videoNode, videoStyle)\n\t\t}\n\n\t\tpatchVideoSource(needsSrcUpdate, videoNode, videoSourceUrl)\n\t\tvideoNode.playbackRate = playbackRate\n\t},\n}\n\n/**\n *\n * @param videoNode\n * @param newSrcUrl\n * @returns {*|boolean}\n */\nfunction shouldUpdateSrc(videoNode, newSrcUrl) {\n\tconst hasError = videoNode.networkState === videoNode.NETWORK_NO_SOURCE\n\tconst hasDiff = !videoNode.currentSrc.endsWith(newSrcUrl)\n\treturn newSrcUrl &amp;&amp; (hasDiff || hasError)\n}\n\n/**\n * Calculate width and height of video's\n * visible rect according to provided `fittingType`.\n *\n * @param {string} fittingType\n * @param {{wScale: number, hScale: number}} videoScale\n * @param {number} videoWidth\n * @param {number} videoHeight\n * @return {{width: number, height: number}}\n */\nfunction getVideoDimension(fittingType, videoScale, videoWidth, videoHeight) {\n\tlet scale\n\n\tif (fittingType === fittingTypes.SCALE_TO_FIT) {\n\t\tscale = Math.min(videoScale.wScale, videoScale.hScale)\n\t} else {\n\t\t// default: fittingTypes.SCALE_TO_FILL\n\t\tscale = Math.max(videoScale.wScale, videoScale.hScale)\n\t}\n\n\treturn {\n\t\twidth: Math.round(videoWidth * scale),\n\t\theight: Math.round(videoHeight * scale),\n\t}\n}\n\n/**\n * Calculate ratio between video's width and height, and its container's.\n *\n * @param {number} containerWidth\n * @param {number} containerHeight\n * @param {number} videoWidth\n * @param {number} videoHeight\n * @return {{wScale: number, hScale: number}}\n */\nfunction getScaleFactor(containerWidth, containerHeight, videoWidth, videoHeight) {\n\treturn {\n\t\twScale: containerWidth / videoWidth,\n\t\thScale: containerHeight / videoHeight,\n\t}\n}\n\n/**\n * Pick the desired video quality from a list of given qualities\n * according to visible rect dimensions.\n *\n * @param {Object[]} qualities\n * @param {{width: number, height: number}} videoScaledDimensions\n * @return {Object} the quality to use\n */\nfunction getVideoQualityBySize(qualities, { width, height }) {\n\tconst uniqueQualities = unique(qualities, (item) =&gt; item.size)\n\tconst targetQuality = uniqueQualities.find((value) =&gt; value.size &gt; width * height)\n\n\treturn targetQuality || qualities[qualities.length - 1]\n}\n\n/**\n * Get a full URL for the video if playing MP4 format, or empty string otherwise.\n *\n * @param {Object} targetQuality\n * @param {string} staticVideoUrl\n * @param {string} videoId\n * @param {string} videoFormat\n * @returns {string}\n */\nfunction getMP4Url(targetQuality, staticVideoUrl, videoId, videoFormat) {\n\tif (videoFormat === 'mp4') {\n\t\t// prefer video URL from new design data structure\n\t\tif (targetQuality.url) {\n\t\t\treturn joinURL(staticVideoUrl, targetQuality.url)\n\t\t}\n\t\t// build URL from videoId\n\t\treturn joinURL(staticVideoUrl, videoId, targetQuality.quality, videoFormat, 'file.mp4')\n\t}\n\n\treturn ''\n}\n\n/**\n *\n * @param {boolean} needsEventUpdate\n * @param {HTMLVideoElement} videoNode\n * @param {HTMLDivElement} posterNode\n * @param {string} animatePoster\n * @param {boolean} autoplay\n * @param {boolean} isEditorMode\n */\nfunction handlePosterVisibility(needsEventUpdate, videoNode, posterNode, animatePoster, autoplay, isEditorMode) {\n\t// todo: (preview -&gt; Editor case) move to editor layout hooks\n\t// bring back the poster (preview -&gt; Editor case)\n\tif (isEditorMode &amp;&amp; videoNode.paused) {\n\t\tposterNode.style.opacity = '1'\n\t\tvideoNode.style.opacity = '0'\n\t}\n\t// todo: (preview -&gt; Editor case) move to editor layout hooks\n\t// register to events when updating src or when in Editor(preview -&gt; Editor case)\n\tconst isPausedOrEmpty = videoNode.paused || videoNode.currentSrc === ''\n\tconst needsEventUpdateWithEditor = needsEventUpdate || isEditorMode\n\tif (needsEventUpdateWithEditor &amp;&amp; isPausedOrEmpty) {\n\t\tvideoNode.ontimeupdate = null\n\t\tvideoNode.onseeked = null\n\t\tvideoNode.onplay = null\n\t\tif (!isEditorMode &amp;&amp; autoplay) {\n\t\t\tconst muteState = videoNode.muted\n\t\t\tvideoNode.muted = true\n\t\t\t// sync the poster removal with video first frame\n\t\t\tvideoNode.ontimeupdate = () =&gt; {\n\t\t\t\tif (videoNode.currentTime &gt; 0) {\n\t\t\t\t\tvideoNode.ontimeupdate = null\n\t\t\t\t\tvideoNode.onseeked = () =&gt; {\n\t\t\t\t\t\tvideoNode.onseeked = null\n\t\t\t\t\t\tvideoNode.muted = muteState\n\t\t\t\t\t\tremovePoster(videoNode, posterNode, animatePoster)\n\t\t\t\t\t}\n\t\t\t\t\tvideoNode.currentTime = 0\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tvideoNode.onplay = () =&gt; {\n\t\t\t\tif (!isEditorMode) {\n\t\t\t\t\tvideoNode.onplay = null\n\t\t\t\t}\n\t\t\t\tremovePoster(videoNode, posterNode, animatePoster)\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Load the video if needed.\n *\n * @param {boolean} needsSrcUpdate\n * @param {HTMLVideoElement} videoNode\n * @param {string} newSrc\n */\nfunction patchVideoSource(needsSrcUpdate, videoNode, newSrc) {\n\tif (needsSrcUpdate) {\n\t\tvideoNode.src = newSrc\n\t\tvideoNode.load()\n\t}\n}\n\n/**\n * Show video , hide poster\n *\n * @param videoNode\n * @param posterNode\n * @param animatePoster\n */\nfunction removePoster(videoNode, posterNode, animatePoster) {\n\tif (animatePoster === 'fade') {\n\t\tposterNode.style.transition = 'opacity 1.6s ease-out'\n\t}\n\tposterNode.style.opacity = '0'\n\tvideoNode.style.opacity = '1'\n}\n\n/**\n *\n * @param {{width: number, height: number}} src source dimensions\n * @param {{width: number, height: number}} target target dimensions\n * @param {{x: number, y: number}} focalPoint x/y as 0-100 percentages\n * @returns {string} in 'x% y%' format\n */\nfunction convertFillFocalToPosition(src, target, focalPoint) {\n\tconst { width: sW, height: sH } = src\n\tconst { width: tW, height: tH } = target\n\tconst { x: fpX, y: fpY } = focalPoint\n\n\tif (!tW || !tH) {\n\t\treturn `${fpX}% ${fpY}%`\n\t}\n\n\tconst fillScaleFactor = Math.max(tW / sW, tH / sH)\n\n\tconst imgScaledW = sW * fillScaleFactor\n\tconst imgScaledH = sH * fillScaleFactor\n\n\tconst x = Math.max(0, Math.min(imgScaledW - tW, imgScaledW * (fpX / 100) - tW / 2))\n\tconst y = Math.max(0, Math.min(imgScaledH - tH, imgScaledH * (fpY / 100) - tH / 2))\n\n\tconst posX = x &amp;&amp; Math.floor((x / (imgScaledW - tW)) * 100)\n\tconst posY = y &amp;&amp; Math.floor((y / (imgScaledH - tH)) * 100)\n\n\treturn `${posX}% ${posY}%`\n}\n","import { wixVideoWrapper } from './wixVideo'\nimport { defineCustomElement } from '../commons'\nimport { initWixElement } from '../wixElements'\n\nexport const wixVideoElementName = 'wix-video'\n\nexport type CustomElementServices = {\n\tisExperimentOpen: (experimentName: string) =&gt; boolean\n\tmutationService?: any\n}\n\nexport const initWixVideo = (\n\tcontextWindow = globalThis.window,\n\texternalServices: CustomElementServices,\n\tenvironmentConsts = {\n\t\texperiments: {},\n\t}\n) =&gt; {\n\tif (!contextWindow) {\n\t\treturn\n\t}\n\tif (contextWindow.customElements.get(wixVideoElementName) === undefined) {\n\t\tconst WixElement = initWixElement(contextWindow)\n\t\tconst intersectionObserver = new IntersectionObserver(\n\t\t\t(entries: Array&lt;IntersectionObserverEntry&gt;) =&gt;\n\t\t\t\tentries.map((entry) =&gt; {\n\t\t\t\t\tif (entry.isIntersecting) {\n\t\t\t\t\t\tconst target = entry.target as any\n\t\t\t\t\t\ttarget.unobserveIntersect()\n\t\t\t\t\t\t// resize Observe will invoke relayout imidiatly.\n\t\t\t\t\t\t// \"Observation will fire when observation starts if Element is being rendered, and Element's size is not 0,0,\"\n\t\t\t\t\t\t// https://drafts.csswg.org/resize-observer/#dom-resizeobserver-observe\n\t\t\t\t\t\ttarget.observeResize()\n\t\t\t\t\t}\n\t\t\t\t\treturn entry\n\t\t\t\t}),\n\t\t\t{\n\t\t\t\trootMargin: '50% 100%',\n\t\t\t}\n\t\t)\n\t\tconst WixVideo = wixVideoWrapper(WixElement, { ...externalServices, intersectionObserver }, environmentConsts)\n\t\tdefineCustomElement(contextWindow, wixVideoElementName, WixVideo)\n\t}\n}\n","// @ts-nocheck\n\nimport videoLayout from './videoLayout'\n\nfunction wixVideoWrapper(WixElement, services, environmentConsts): any {\n\tclass wixVideo extends WixElement {\n\t\tconstructor() {\n\t\t\tsuper()\n\t\t}\n\n\t\tconnectedCallback() {\n\t\t\tif (environmentConsts.disableImagesLazyLoading) {\n\t\t\t\tthis.reLayout()\n\t\t\t} else {\n\t\t\t\tservices.intersectionObserver.observe(this)\n\t\t\t}\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.unobserveResize()\n\t\t\tthis.unobserveIntersect()\n\t\t\tthis.unobserveChildren()\n\t\t}\n\n\t\tunobserveIntersect() {\n\t\t\tservices.intersectionObserver?.unobserve(this)\n\t\t}\n\n\t\treLayout() {\n\t\t\tconst {\n\t\t\t\tisVideoDataExists,\n\t\t\t\tvideoWidth,\n\t\t\t\tvideoHeight,\n\t\t\t\tqualities,\n\t\t\t\tvideoId,\n\t\t\t\tvideoFormat,\n\t\t\t\talignType,\n\t\t\t\tfittingType,\n\t\t\t\tfocalPoint,\n\t\t\t\thasBgScrollEffect,\n\t\t\t\tautoPlay,\n\t\t\t\tanimatePoster,\n\t\t\t\tcontainerId,\n\t\t\t\tisEditorMode,\n\t\t\t\tplaybackRate,\n\t\t\t\thasAlpha,\n\t\t\t} = JSON.parse(this.dataset.videoInfo)\n\t\t\tif (!isVideoDataExists) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst autoPlayAllowed = !environmentConsts.prefersReducedMotion &amp;&amp; autoPlay\n\n\t\t\tconst videoNode = this.querySelector(`video[id^=\"${containerId}\"]`)\n\t\t\tconst poster = this.querySelector(`.bgVideoposter[id^=\"${containerId}\"]`)\n\n\t\t\t// if observed for missing video/poster, first cleanup, otherwise it's a noop\n\t\t\tthis.unobserveChildren()\n\n\t\t\tif (!(videoNode &amp;&amp; poster)) {\n\t\t\t\tthis.observeChildren(this)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst container = this.getRootNode().getElementById(`${containerId}`)\n\t\t\tconst canvas = container.querySelector(`.webglcanvas[id^=\"${containerId}\"]`)\n\t\t\tconst hasThunderBoltCanvas = hasAlpha || container.dataset.hasAlpha === 'true'\n\n\t\t\tif (hasThunderBoltCanvas &amp;&amp; !canvas) {\n\t\t\t\trequestAnimationFrame(() =&gt; this.reLayout())\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tservices.mutationService.measure(() =&gt; {\n\t\t\t\tconst measures = videoLayout.measure(videoNode, container, {\n\t\t\t\t\thasBgScrollEffect,\n\t\t\t\t\tvideoWidth,\n\t\t\t\t\tvideoHeight,\n\t\t\t\t\tfittingType,\n\t\t\t\t\talignType,\n\t\t\t\t\tqualities,\n\t\t\t\t\tstaticVideoUrl: environmentConsts.staticVideoUrl,\n\t\t\t\t\tvideoId,\n\t\t\t\t\tvideoFormat,\n\t\t\t\t\tfocalPoint,\n\t\t\t\t})\n\n\t\t\t\tconst { videoSourceUrl, needsSrcUpdate, videoStyle } = measures\n\t\t\t\tservices.mutationService.mutate(() =&gt; {\n\t\t\t\t\tvideoLayout.mutate(\n\t\t\t\t\t\tposter,\n\t\t\t\t\t\tcanvas,\n\t\t\t\t\t\tvideoNode,\n\t\t\t\t\t\tvideoStyle,\n\t\t\t\t\t\tautoPlayAllowed,\n\t\t\t\t\t\tvideoSourceUrl,\n\t\t\t\t\t\tneedsSrcUpdate,\n\t\t\t\t\t\tanimatePoster,\n\t\t\t\t\t\tvideoFormat,\n\t\t\t\t\t\tplaybackRate,\n\t\t\t\t\t\tisEditorMode\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\tattributeChangedCallback(name, oldValue) {\n\t\t\tif (oldValue) {\n\t\t\t\tthis.reLayout()\n\t\t\t}\n\t\t}\n\n\t\tstatic get observedAttributes() {\n\t\t\treturn ['data-video-info']\n\t\t}\n\t}\n\n\treturn wixVideo\n}\n\nexport { wixVideoWrapper }\n","// @ts-nocheck\n\nimport {\n\tthrottleToAnimationFrame,\n\twixBgMediaWrapper,\n\twixElementWrapper,\n\tmultiColumnLayouterWrapper,\n\tmultiColumnLayouterElementName,\n\tinitResizeService,\n} from '@wix/custom-elements'\nimport nativeShim from './shims/native-shim'\n\nfunction init(services, contextWindow = window) {\n\tnativeShim(contextWindow)\n\n\tconst windowResizeService = {\n\t\tregistry: new Set(),\n\t\tobserve(element) {\n\t\t\twindowResizeService.registry.add(element)\n\t\t},\n\t\tunobserve(element) {\n\t\t\twindowResizeService.registry.delete(element)\n\t\t},\n\t}\n\n\tservices.windowResizeService.init(\n\t\tthrottleToAnimationFrame(() =&gt; windowResizeService.registry.forEach((element) =&gt; element.reLayout())),\n\t\tcontextWindow\n\t)\n\n\tconst resizeService = initResizeService()\n\n\tconst defineCustomElement = (elementName, elementClass) =&gt; {\n\t\tif (contextWindow.customElements.get(elementName) === undefined) {\n\t\t\tcontextWindow.customElements.define(elementName, elementClass)\n\t\t}\n\t}\n\n\tconst WixElement = wixElementWrapper({ resizeService }, contextWindow)\n\tcontextWindow.customElementNamespace = { WixElement }\n\tdefineCustomElement('wix-element', WixElement)\n\n\tconst defineWixBgMedia = (externalServices) =&gt; {\n\t\tconst WixBgMedia = wixBgMediaWrapper(WixElement, { windowResizeService, ...externalServices }, contextWindow)\n\t\tdefineCustomElement('wix-bg-media', WixBgMedia)\n\t}\n\tconst defineMultiColumnRepeaterElement = () =&gt; {\n\t\tconst MultiColRepeater = multiColumnLayouterWrapper()\n\t\tdefineCustomElement(multiColumnLayouterElementName, MultiColRepeater)\n\t}\n\n\treturn {\n\t\tcontextWindow,\n\t\tdefineWixBgMedia,\n\t\tdefineMultiColumnRepeaterElement,\n\t}\n}\n\nexport default {\n\tinit,\n}\n","// @ts-nocheck\nimport * as imageKit from '@wix/image-kit'\nimport wixCustomElementsRegistry from './wixCustomElementsRegistry'\n\nexport default {\n\timageClientApi: imageKit,\n\t...wixCustomElementsRegistry,\n}\n","// @ts-nocheck\n\n/**\n * @license\n * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * This shim allows elements written in, or compiled to, ES5 to work on native\n * implementations of Custom Elements v1. It sets new.target to the value of\n * this.constructor so that the native HTMLElement constructor can access the\n * current under-construction element's definition.\n */\n\n/* eslint strict:0 */\nexport default function (contextWindow) {\n\tif (\n\t\t// No Reflect, no classes, no need for shim because native custom elements\n\t\t// require ES2015 classes or Reflect.\n\t\tcontextWindow.Reflect === undefined ||\n\t\tcontextWindow.customElements === undefined ||\n\t\t// The webcomponentsjs custom elements polyfill doesn't require\n\t\t// ES2015-compatible construction (`super()` or `Reflect.construct`).\n\t\tcontextWindow.customElements.hasOwnProperty('polyfillWrapFlushCallback')\n\t) {\n\t\treturn\n\t}\n\tconst BuiltInHTMLElement = contextWindow.HTMLElement\n\tcontextWindow.HTMLElement = /** @this {!Object} */ function HTMLElement() {\n\t\treturn contextWindow.Reflect.construct(BuiltInHTMLElement, [], /** @type {!Function} */ this.constructor)\n\t}\n\tcontextWindow.HTMLElement.prototype = BuiltInHTMLElement.prototype\n\tcontextWindow.HTMLElement.prototype.constructor = contextWindow.HTMLElement\n\tcontextWindow.Object.setPrototypeOf(contextWindow.HTMLElement, BuiltInHTMLElement)\n\tcontextWindow.Object.defineProperty(contextWindow.HTMLElement, 'name', {\n\t\tvalue: BuiltInHTMLElement.name,\n\t})\n}\n","import fastdom from 'fastdom'\nimport type { ViewerModel } from '@wix/thunderbolt-symbols'\nimport { mediaResizeMap } from '@wix/animations-kit'\nimport wixCustomElementsRegistry from '@wix/custom-elements-registry'\nimport { initCustomElement as initWowImageCustomElement } from '@wix/image'\n\ntype CustomElementsMediaData = Pick&lt;ViewerModel, 'experiments' | 'media' | 'requestUrl'&gt;\ntype MediaServicesOverride = {\n\tgetScreenHeightOverride: () =&gt; number\n}\ntype EnvironmentOverrides = {\n\tdisableImagesLazyLoading: boolean\n}\n\nconst getSiteService = () =&gt; ({\n\tgetSiteScale: () =&gt; {\n\t\t// We can replace later with better logic\n\t\tconst siteRootElement = document.querySelector&lt;HTMLDivElement&gt;('#site-root')\n\t\tif (siteRootElement) {\n\t\t\treturn siteRootElement.getBoundingClientRect().width / siteRootElement.offsetWidth\n\t\t}\n\t\treturn 1\n\t},\n})\n\nconst initWixCustomElementsRegistry = () =&gt; {\n\tconst resizeService = {\n\t\tinit: (callback: any) =&gt; new ResizeObserver(callback),\n\t}\n\n\tconst windowResizeService = {\n\t\tinit: (callback: any) =&gt; window.addEventListener('resize', callback),\n\t}\n\n\tconst siteService = getSiteService()\n\n\treturn wixCustomElementsRegistry.init({ resizeService, windowResizeService, siteService })\n}\n\nconst getMediaDimensionsByEffect = (bgEffectName: string, width: number, height: number, screenHeight: number) =&gt; {\n\tconst { getMediaDimensions, ...rest } = mediaResizeMap[bgEffectName as keyof typeof mediaResizeMap] || {}\n\treturn getMediaDimensions\n\t\t? { ...getMediaDimensions(width, height, screenHeight), ...rest }\n\t\t: { width, height, ...rest }\n}\n\nconst buildCustomElementsMediaParams = (\n\tpartialViewerModel: CustomElementsMediaData,\n\twixCustomElements?: any,\n\tmediaOverrideParam?: MediaServicesOverride,\n\tenvironmentOverrides?: EnvironmentOverrides\n) =&gt; {\n\tconst getDevicePixelRatio = () =&gt; {\n\t\tconst isMSMobileDevice = /iemobile/i.test(navigator.userAgent)\n\t\tif (isMSMobileDevice) {\n\t\t\treturn Math.round(\n\t\t\t\twindow.screen.availWidth / (window.screen.width || window.document.documentElement.clientWidth)\n\t\t\t)\n\t\t}\n\t\treturn window.devicePixelRatio\n\t}\n\n\tconst isExperimentOpen = (experiment: string) =&gt; Boolean(partialViewerModel.experiments[experiment])\n\n\tconst environmentConsts = {\n\t\tstaticMediaUrl: partialViewerModel.media.staticMediaUrl,\n\t\tmediaRootUrl: partialViewerModel.media.mediaRootUrl,\n\t\texperiments: {},\n\t\tisViewerMode: true,\n\t\tdevicePixelRatio: getDevicePixelRatio(),\n\t\t...environmentOverrides,\n\t}\n\n\tconst services = {\n\t\tmutationService: fastdom,\n\t\tisExperimentOpen,\n\t\tsiteService: getSiteService(),\n\t}\n\tconst mediaServices = { getMediaDimensionsByEffect, ...services, ...mediaOverrideParam }\n\n\treturn {\n\t\t...partialViewerModel,\n\t\twixCustomElements: wixCustomElements || initWixCustomElementsRegistry(),\n\t\tservices,\n\t\tenvironmentConsts,\n\t\tmediaServices,\n\t}\n}\n\nexport const initCustomElements = (\n\tpartialViewerModelParam: CustomElementsMediaData,\n\twixCustomElementsParam?: any,\n\tmediaOverrideParam?: MediaServicesOverride,\n\tenvironmentOverrides?: EnvironmentOverrides\n) =&gt; {\n\tconst { environmentConsts, wixCustomElements, media, requestUrl, mediaServices } = buildCustomElementsMediaParams(\n\t\tpartialViewerModelParam,\n\t\twixCustomElementsParam,\n\t\tmediaOverrideParam,\n\t\tenvironmentOverrides\n\t)\n\tconst contextWindow = wixCustomElements?.contextWindow || window\n\tcontextWindow.wixCustomElements = wixCustomElements\n\tObject.assign(contextWindow.customElementNamespace, {\n\t\tmediaServices,\n\t\tenvironmentConsts,\n\t\trequestUrl,\n\t\tstaticVideoUrl: media.staticVideoUrl,\n\t})\n\n\tinitWowImageCustomElement({ ...mediaServices }, wixCustomElements.contextWindow, environmentConsts)\n\n\twixCustomElements.defineWixBgMedia(mediaServices)\n\twixCustomElements.defineMultiColumnRepeaterElement()\n\n\twindow.__imageClientApi__ = wixCustomElementsRegistry.imageClientApi\n}\n","import { initCustomElements } from '@wix/thunderbolt-custom-elements'\n\nconst { experiments, media, requestUrl } = window.viewerModel\ninitCustomElements({ experiments, media, requestUrl })\n"],"names":["API_VERSION","MAX_DEVICE_PIXEL_RATIO","DSKTP_MAX_BG_SITE_LEGACY_WIDTH","DSKTP_MAX_BG_SITE_LEGACY_HEIGHT","MOBILE_MAX_BG_SITE_LEGACY_WIDTH","MOBILE_MAX_BG_SITE_LEGACY_HEIGHT","fittingTypes","SCALE_TO_FILL","SCALE_TO_FIT","STRETCH","ORIGINAL_SIZE","TILE","TILE_HORIZONTAL","TILE_VERTICAL","FIT_AND_TILE","LEGACY_STRIP_TILE","LEGACY_STRIP_TILE_HORIZONTAL","LEGACY_STRIP_TILE_VERTICAL","LEGACY_STRIP_SCALE_TO_FILL","LEGACY_STRIP_SCALE_TO_FIT","LEGACY_STRIP_FIT_AND_TILE","LEGACY_STRIP_ORIGINAL_SIZE","LEGACY_ORIGINAL_SIZE","LEGACY_FIT_WIDTH","LEGACY_FIT_HEIGHT","LEGACY_FULL","LEGACY_BG_FIT_AND_TILE","LEGACY_BG_FIT_AND_TILE_HORIZONTAL","LEGACY_BG_FIT_AND_TILE_VERTICAL","LEGACY_BG_NORMAL","transformTypes","FIT","FILL","FILL_FOCAL","CROP","LEGACY_CROP","LEGACY_FILL","alignTypes","CENTER","TOP","TOP_LEFT","TOP_RIGHT","BOTTOM","BOTTOM_LEFT","BOTTOM_RIGHT","LEFT","RIGHT","ALIGN_TYPE_TO_FOCAL_POINT","x","y","alignTypesMap","center","top","top_left","top_right","bottom","bottom_left","bottom_right","left","right","htmlTag","BG","IMG","SVG","upscaleMethods","AUTO","CLASSIC","SUPER","upscaleMethodsValues","classic","super","defaultUSM","radius","amount","threshold","emptyData","uri","css","img","container","attr","transformed","SAFE_TRANSFORMED_AREA","MAX_TRANSFORMED_IMAGE_WIDTH","SUPER_UPSCALE_MODELS","imageScaleDefaults","HIGH","size","quality","maxUpscale","MEDIUM","LOW","TINY","imageQuality","imageFilters","CONTRAST","BRIGHTNESS","SATURATION","HUE","BLUR","fileType","JPG","JPEG","JPE","PNG","WEBP","WIX_ICO_MP","WIX_MP","GIF","AVIF","UNRECOGNIZED","encodingTypes","PAVIF","template","strings","keys","values","dict","length","result","forEach","key","i","value","Number","isInteger","push","join","last","array","SUPPORTED_IMAGE_EXTENSIONS","JPG_EXTENSIONS","isValidRequest","fittingType","src","target","url","id","trim","toLowerCase","Object","includes","isImageTransformApplicable","hasAnimation","allowAnimatedTransform","isWEBP","isAVIF","canTransformIfAnimatedImage","getFileExtension","isImageTypeSupported","isGIF","isTransformableGIF","test","isPNG","ILLEGAL_CHARS","map","encodeURIComponent","URL_SAFE_ILLEGAL_CHARS","ILLEGAL_CHARS_REPLACEMENT","getFileType","isJPG","exec","getScaleFactor","sWidth","sHeight","dWidth","dHeight","transformType","scaleFactor","Math","max","getFillScaleFactor","min","getFitScaleFactor","getTransformData","dpr","upscaleMethod","width","height","dimensionScaleFactor","sqrt","getSafeTransformData","tWidth","tHeight","optimizedScaleFactor","upscaleMethodValue","forceUSM","imageKey","getImageQualityKey","getAutoScaleData","getSuperScaleData","getClassicScaleData","getOptimizedScaleData","cssUpscaleNeeded","getOptimizedTransformData","getAlignedRect","sRect","dRect","sFP","alignment","fp","getFocalPoint","getFocalPointFrom9GridAlignment","getAlignment","focalPoint","isNaN","roundToFixed","imageWidth","imageHeight","precision","truncatePrecision","pow","toFixed","getUpscaleString","options","toUpperCase","imageIsAnimated","isAvifWebpFormat","globalFeaturesSupportObj","isMobile","getFeature","feature","setFeature","populateGlobalFeatureSupport","window","navigator","isSmallScreen","matchMedia","matches","isMobileAgent","userAgent","getCSS","transformsObj","attributes","backgroundSize","backgroundRepeat","backgroundPosition","alignTypeToPositionStr","aligmentDefaults","position","alignType","parts","objectFit","objectPosition","verticalMiddle","round","horizontalMiddle","assign","alignTypeToPosition","getSvgAttr","sourceWidth","sourceHeight","imageScale","preserveAspectRatio","transform","getDimension","middle","viewBox","setTransformParts","rect","crop","getOverlappingRect","isCropped","getCropPart","getFitPart","transformedData","devicePixelRatio","focalPointX","focalPointY","upscale","getFillPart","clonedTarget","getStretchPart","getLegacyCropPart","getLegacyFitPart","getLegacyFillPart","setTransformOptions","isQualitySupported","transformData","defaultQuality","getQuality","progressive","getProgressive","watermark","getWatermark","autoEncode","encoding","unsharpMask","usm","isUSMValid","transformPart","isUSMNeeded","getUnsharpMask","filters","filterOptions","isValidImageFilter","getFilters","filterValue","minValue","maxValue","getTransform","_isSEOBot","isSEOBot","fileName","name","fileExtensionRegexp","illegalCharsRegex","RegExp","concat","extension","match","replace","trimmed","getFileName","pixelAspectRatio","getDevicePixelRatio","fileExtension","preferredExtension","canTransformImage","isAnimated","getTarget","targetObj","_isMobile","maxBGSiteLegacyWidth","maxBGSiteLegacyHeight","fitTemplate","fillTemplate","fillFocalTemplate","cropTemplate","legacyCropTemplate","legacyFillTemplate","upscaleTemplate","qualityTemplate","qualityAutoTemplate","unSharpMaskTemplate","nonProgressiveTemplate","watermarkTemplate","filterTemplatesMap","autoEncodeTemplate","AVIFEncodeTemplate","pAVIFEncodeTemplate","animatedTransformTemplate","getURI","transformObj","transformTarget","undefined","transformsObjStrArr","legacyFillStr","fitStr","fillStr","fillFocalStr","transformsStr","filterName","getImageURI","ALIGN_TYPE_TO_POSITION","POSITION_TO_ALIGN_TYPE","entries","reduce","acc","align","TILE_FITTING_TYPES","NON_SCALING_FITTING_TYPES","getIsFakeTile","targetWidth","targetHeight","validateTargetDimensions","_width","heightRatio","getCSSOverrides","returnValue","alignTypeFromFocalPoint","convertFocalPointToAlignType","convertFillFocalToPosition","sW","sH","tW","tH","fpX","fpY","fillScaleFactor","imgScaledW","imgScaledH","floor","PLACEHOLDER_IMG_CSS_OVERRIDES","getPlaceholder","shouldLoadHQImage","IS_IN_PLACEHOLDER_FLOW","getData","useSrcset","newTarget","isFakeTile","scaledDimensions","isScalable","isTile","_height","isHighQuality","getScaleFactorByWidth","getScaledDimensions","blur","getBlurValue","convertedFittingType","getConvertedFitting","overrideCSS","data","srcset","getSrcset","attributesGetter","getAttributes","wixStaticWithMedia","HAS_MEDIA_PREFIX_RE","getURL","baseHostURL","getWixStaticURL","WIDTHS","getSources","widthProportion","originalWidth","originalHeight","siteMargin","displayMode","hasOriginalSizeDisplayMode","originalAspectRatio","index","isLowestBreakpoint","getWidth","w","lowerBpWidth","currentBpWidth","manualCrop","targetAspectRatio","lowerWidth","bpWidth","getCropDataWithAlign","fallbackSrc","getResponsiveImageProps","sizes","media","imgStyle","imageProps","sources","filter","Boolean","reverse","srcsetWithPrefix","s","STATIC_MEDIA_URL","sdk","getScaleToFitImageURL","relativeUrl","getScaleToFillImageURL","getCropImageURL","cropX","cropY","cropWidth","cropHeight","contextWindow","mediaServices","environmentConsts","requestUrl","staticVideoUrl","customElementNamespace","prefersReducedMotion","initLazyCustomElements","resolveExternalsRegistryModule","checkForFit","heights","finalColHeight","numOfCols","col","colTotal","currentItemHeight","findMinHeight","items","rowGap","maxItemHeight","Infinity","lower","higher","finalHeight","MultiColumnLayouter","HTMLElement","containerWidth","isActive","isDuringCalc","attachObservers","this","mutationObserver","observe","childList","subtree","containerWidthObserver","Array","from","children","child","handleItemAdded","detachHeightCalcObservers","disconnect","childResizeObserver","recalcHeight","cs","getComputedStyle","bestHeight","itemsHeights","getRowGap","getColumnCount","setContainerHeight","style","setProperty","cleanUp","removeContainerHeight","isActiveObserver","node","handleItemRemoved","unobserve","createObservers","ResizeObserver","contentRect","MutationObserver","mutation","removedNodes","addedNodes","setIsActive","removeProperty","computedStyle","val","getPropertyValue","parseInt","activate","deactivate","calcActive","parseFloat","marginTop","marginBottom","shouldBeActive","connectedCallback","document","body","disconnectedCallback","multiColumnLayouterElementName","initResizeService","resizeService","observedElementToRelayoutTarget","Map","getLayoutTargets","elements","elementsNeedRelayout","Set","e","add","get","element","set","resizeObserver","delete","observeChild","childElement","rootElement","unobserveChild","entry","reLayout","throttleToAnimationFrame","callback","throttled","args","requestAnimationFrame","joinURL","getMediaUrlByContext","imageUri","staticMediaUrl","mediaRootUrl","path","devicePixelRatioQueryParam","location","search","split","query","find","CSS_NUMERIC_VALUES","columnCount","columns","fontWeight","lineHeight","opacity","zIndex","zoom","setAttributes","setAttribute","setStyle","styleProperties","prop","propValue","addDefaultUnitIfNeeded","setCssVars","cssVars","shouldDeserializeVal","dataset","setData","datasetOverrides","getScreenHeight","getterOverride","documentElement","clientHeight","innerHeight","fittingTypeToObjectFit","fit","fill","init","measure","measures","domNodes","containerId","bgEffectName","services","bgImage","getMediaDimensionsByEffect","offsetWidth","offsetHeight","getScreenHeightOverride","currentSrc","backgroundImage","patch","imageInfo","envConsts","imageTransformData","imageData","imageOptions","imageComputedProperties","getImageComputedProperties","currentImageUrlCss","newUrl","didImageChange","domNode","elementStyleAndUrl","image","Image","onload","bind","setBackground","elementName","elementClass","customElements","define","wixElementWrapper","WixElement","constructor","observeResize","unobserveResize","unobserveChildren","observeChildren","el","childListObserver","observeChildAttributes","childrenAttributesObservers","attributesObserver","attributeFilter","observeChildResize","childrenResizeObservers","unobserveChildrenResize","observer","wixBgImageElementName","initWixBgImage","globalThis","externalServices","experiments","WixBgImage","bgImageLayout","isExperimentOpen","shouldStopImageLoad","imageId","getAttribute","JSON","parse","tiledImageInfo","getElementById","mutationService","mutate","attributeChangedCallback","oldValue","observedAttributes","wixBgImageWrapper","stylesToClear","pageId","useCssVars","closest","page","isFixedStyle","screenHeight","containerRect","getBoundingClientRect","dimensionsByEffect","hasParallax","hasPageTransition","transition","calculatedWith","calculatedHeight","pageLeftPosition","clientLeft","offsetLeft","dimensions","windowResizeService","MORE_BUTTON_SUFFIX","MORE_CONTAINER_PREFIX","getDropDownWidthIfOk","menuWidth","sameWidth","stretch","widths","menuWidthToReduce","maxWidth","removeMarginFromAllChildren","extraPixels","some","v","totalMenuItemsWidths","total","a","b","stretchedAndSameItemWidths","totalRemnant","wdth","toAdd","stretchItemsWidths","itemWidth","remnant","roundScaleMeasurement","checkValidNumber","num","number","isFinite","needToOpenDropDownUp","menuCompDom","decideOnMenuPosition","hoveredItem","moreContainerWidth","dropWrapperWidth","alignButtons","hoverListPosition","menuItemContainerExtraPixels","menuLeft","absoluteLeft","menuPosition","menuExtraPixels","hoveredListPosition","menuRight","clientWidth","moreContainerLeft","moreContainerRight","hoveredNodeLeftOffset","hoveredNodeWidthOffset","subMenuLeft","getMenuPosition","bodyClientWidth","needToOpenMenuUp","isNumber","n","menuElement","siteScale","siteRootElement","getRootNode","querySelector","menuItemIds","rootNode","numItems","MAX_SAFE_INTEGER","String","getDataIDs","childrenIdsToMeasure","getChildrenIdsToMeasure","childId","domNodeId","childrenMeasures","nodeId","boundingClientRectWidth","measureChildrenDimensions","menuRoot","itemsContainer","menuItems","childNodes","moreContainer","moreChildNodes","stretchButtonsToMenuWidth","sameWidthButtons","boundingClientRect","menuBorderY","ribbonExtra","ribbonEls","labelPad","menuButtonBorder","menuItemContainerMargins","menuItem","lastChild","itemCss","marginLeft","marginRight","checkForMarginMenu","includeMargin","itemsContainerCss","borderTopWidth","paddingTop","borderBottomWidth","paddingBottom","borderLeftWidth","paddingLeft","borderRightWidth","paddingRight","getDivExtraPixels","menuItemMarginForAllChildren","moreSubItem","labelWidths","linkIds","parentId","labels","moreChild","dataId","moreDOMid","moreIndex","labelNode","fontSize","menuIndex","menuDOMid","getLabelWidth","linkElementNode","menuHeight","calculateLineHeight","arrayWidths","menuProperties","menuItemsIdsWithMore","hasOriginalGapData","originalGapBetweenTextAndBtn","itemId","gapBetweenTextAndBtn","originalGap","moreWidth","pop","moreShown","getMaxWidth","realWidths","slice","widthMore","getMenuItemsToPresent","isMoreShown","hoverState","overflowX","dropmode","maxLabelWidth","firstIndexThatIsHidden","indexOf","firstItemShownInMore","obj","predicate","indexOfFirstItemShownInMore","hasOneItem","item","display","moreItemLabelId","subItemLabelId","subItemsIndex","newSubItemsLineHeight","moreItemLineHeight","getLabelLineHeight","subId","minWidth","hoveredInd","updateDropDownContainerLocation","totalVisible","lastVisibleMenuId","innerLinkElementId","menuLineHeight","menuItemHeight","activeWidth","isVisible","menuId","overflow","visibility","tabIndex","listposition","patchDropDownMenuItems","wixDropdownMenuElementName","initCustomElementsDropdownMenu","WixDropdownMenu","dropdownMenuLayout","_visible","_mutationIds","read","write","_itemsContainer","_dropContainer","_labelItems","_isVisible","_id","_hideElement","_waitForDomLoad","then","_observeChildrenResize","clear","onReady","loadPromise","Promise","res","_isDomReady","_waitForDomReadyObserver","_onRootMutate","_setVisibility","visible","_showElement","measureResult","wixDropdownMenuWrapper","wixIframeElementName","initWixIframe","WixIframe","iframe","dataSrc","newValue","wixIframeWrapper","videoNode","hasBgScrollEffect","videoWidth","videoHeight","qualities","videoId","videoFormat","parentElement","vidWidth","vidHeight","containerHeight","wScale","hScale","videoScaledDimensions","videoScale","scale","getVideoDimension","targetQuality","uniqueQualities","arr","unique","getVideoQualityBySize","videoSourceUrl","getMP4Url","needsSrcUpdate","newSrcUrl","hasError","networkState","NETWORK_NO_SOURCE","hasDiff","endsWith","shouldUpdateSrc","focalPosition","posX","posY","alignTypeString","videoStyle","poster","canvas","autoPlay","animatePoster","playbackRate","isEditorMode","removeAttribute","_","__","styleWithoutDims","needsEventUpdate","posterNode","autoplay","paused","isPausedOrEmpty","needsEventUpdateWithEditor","ontimeupdate","onseeked","onplay","muteState","muted","currentTime","removePoster","handlePosterVisibility","newSrc","load","patchVideoSource","wixVideoElementName","initWixVideo","WixVideo","disableImagesLazyLoading","intersectionObserver","unobserveIntersect","isVideoDataExists","hasAlpha","videoInfo","autoPlayAllowed","videoLayout","wixVideoWrapper","IntersectionObserver","isIntersecting","rootMargin","imageClientApi","Reflect","hasOwnProperty","BuiltInHTMLElement","construct","prototype","setPrototypeOf","defineProperty","registry","defineCustomElement","defineWixBgMedia","WixBgMedia","defineMultiColumnRepeaterElement","MultiColRepeater","getSiteService","getSiteScale","initWixCustomElementsRegistry","addEventListener","siteService","getMediaDimensions","rest","mediaResizeMap","viewerModel","partialViewerModelParam","wixCustomElementsParam","mediaOverrideParam","environmentOverrides","wixCustomElements","partialViewerModel","isViewerMode","screen","availWidth","experiment","buildCustomElementsMediaParams","__imageClientApi__","initCustomElements"],"sourceRoot":""}</pre><div class="json-formatter-container"></div></body></html>